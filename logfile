2022-07-14 16:58:27.479 IST [9388] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 16:58:27.490 IST [9388] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 16:58:27.496 IST [9388] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 16:58:27.553 IST [24048] LOG:  database system was interrupted; last known up at 2022-07-14 16:45:36 IST
2022-07-14 16:58:28.014 IST [24048] LOG:  database system was not properly shut down; automatic recovery in progress
2022-07-14 16:58:28.020 IST [24048] LOG:  redo starts at 0/2AC21710
2022-07-14 16:58:28.021 IST [24048] LOG:  invalid record length at 0/2AC217F8: wanted 24, got 0
2022-07-14 16:58:28.021 IST [24048] LOG:  redo done at 0/2AC217C0 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-07-14 16:58:28.213 IST [9388] LOG:  database system is ready to accept connections
2022-07-14 16:58:32.627 IST [27072] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-14.2-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-07-14 16:58:32.627 IST [27072] STATEMENT:  
	select * from double_close(20)
2022-07-14 16:58:35.908 IST [27072] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-14.2-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-07-14 16:58:35.908 IST [27072] STATEMENT:  
	select * from double_close(20)
2022-07-14 16:58:42.214 IST [9388] LOG:  received fast shutdown request
2022-07-14 16:58:42.219 IST [9388] LOG:  aborting any active transactions
2022-07-14 16:58:42.220 IST [27072] FATAL:  terminating connection due to administrator command
2022-07-14 16:58:42.238 IST [9388] LOG:  background worker "logical replication launcher" (PID 16168) exited with exit code 1
2022-07-14 16:58:42.241 IST [20248] LOG:  shutting down
2022-07-14 16:58:42.335 IST [9388] LOG:  database system is shut down
2022-07-14 16:58:42.851 IST [15908] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 16:58:42.862 IST [15908] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 16:58:42.868 IST [15908] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 16:58:42.925 IST [18172] LOG:  database system was shut down at 2022-07-14 16:58:42 IST
2022-07-14 16:58:42.998 IST [15908] LOG:  database system is ready to accept connections
2022-07-14 16:58:47.878 IST [172] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-14.2-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-07-14 16:58:47.878 IST [172] STATEMENT:  select * from double_close(20)
2022-07-14 16:58:52.809 IST [172] ERROR:  function "double_close" already exists with same argument types
2022-07-14 16:58:52.809 IST [172] STATEMENT:  
	CREATE FUNCTION double_close (close numeric)
	  RETURNS numeric
	AS $$
	return 2 * close
	$$ LANGUAGE plpython3u
	
2022-07-14 16:58:58.189 IST [172] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-14.2-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-07-14 16:58:58.189 IST [172] STATEMENT:  
	select * from double_close(20)
2022-07-14 17:00:50.098 IST [26452] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 17:00:50.110 IST [26452] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 17:00:50.115 IST [26452] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 17:00:50.173 IST [23820] LOG:  database system was interrupted; last known up at 2022-07-14 16:58:42 IST
2022-07-14 17:00:50.541 IST [23820] LOG:  database system was not properly shut down; automatic recovery in progress
2022-07-14 17:00:50.546 IST [23820] LOG:  redo starts at 0/2AC218E8
2022-07-14 17:00:50.546 IST [23820] LOG:  invalid record length at 0/2AC21920: wanted 24, got 0
2022-07-14 17:00:50.546 IST [23820] LOG:  redo done at 0/2AC218E8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-07-14 17:00:50.573 IST [2208] FATAL:  the database system is starting up
2022-07-14 17:00:50.681 IST [26452] LOG:  database system is ready to accept connections
2022-07-14 17:01:01.283 IST [23336] ERROR:  extension "plpython3u" already exists
2022-07-14 17:01:01.283 IST [23336] STATEMENT:  
	create extension plpython3u
2022-07-14 17:01:06.394 IST [23336] ERROR:  function "double_close" already exists with same argument types
2022-07-14 17:01:06.394 IST [23336] STATEMENT:  CREATE FUNCTION double_close (close numeric)
	  RETURNS numeric
	AS $$
	return 2 * close
	$$ LANGUAGE plpython3u
2022-07-14 17:08:23.723 IST [23336] ERROR:  AttributeError: 'Figure' object has no attribute 'buffer'
2022-07-14 17:08:23.723 IST [23336] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_test", line 13, in <module>
	    return fig.buffer()
	PL/Python function "matplotlib_test"
2022-07-14 17:08:23.723 IST [23336] STATEMENT:  
	select matplotlib_test(1)
2022-07-14 17:08:29.650 IST [23336] ERROR:  AttributeError: 'Figure' object has no attribute 'buffer'
2022-07-14 17:08:29.650 IST [23336] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_test", line 13, in <module>
	    return fig.buffer()
	PL/Python function "matplotlib_test"
2022-07-14 17:08:29.650 IST [23336] STATEMENT:  select * from matplotlib_test(1)
	
2022-07-14 17:08:46.941 IST [23336] ERROR:  AttributeError: 'Figure' object has no attribute 'getbuffer'
2022-07-14 17:08:46.941 IST [23336] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_test", line 13, in <module>
	    return fig.getbuffer()
	PL/Python function "matplotlib_test"
2022-07-14 17:08:46.941 IST [23336] STATEMENT:  
	
	select * from matplotlib_test(1)
	
2022-07-14 17:09:07.926 IST [23336] ERROR:  syntax error at or near "," at character 34
2022-07-14 17:09:07.926 IST [23336] STATEMENT:  
	drop FUNCTION matplotlib_test (, numeric)
2022-07-14 17:09:18.497 IST [23336] ERROR:  AttributeError: 'Figure' object has no attribute 'getbuffer'
2022-07-14 17:09:18.497 IST [23336] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_test", line 13, in <module>
	    return fig.getbuffer()
	PL/Python function "matplotlib_test"
2022-07-14 17:09:18.497 IST [23336] STATEMENT:  
	
	select * from matplotlib_test(1)
	
2022-07-14 17:09:36.646 IST [23336] ERROR:  function matplotlib_test(numeric) does not exist
2022-07-14 17:09:36.646 IST [23336] STATEMENT:  
	drop FUNCTION matplotlib_test ( numeric)
2022-07-14 17:09:43.159 IST [23336] ERROR:  function matplotlib_test(numeric) does not exist
2022-07-14 17:09:43.159 IST [23336] STATEMENT:  drop FUNCTION matplotlib_test ( numeric)
2022-07-14 17:11:16.159 IST [17644] ERROR:  canceling statement due to user request
2022-07-14 17:11:16.160 IST [26452] LOG:  received fast shutdown request
2022-07-14 17:11:16.163 IST [26452] LOG:  aborting any active transactions
2022-07-14 17:11:16.164 IST [23336] FATAL:  terminating connection due to administrator command
2022-07-14 17:11:16.178 IST [26452] LOG:  background worker "logical replication launcher" (PID 17644) exited with exit code 1
2022-07-14 17:11:16.197 IST [15108] LOG:  shutting down
2022-07-14 17:11:16.263 IST [26452] LOG:  database system is shut down
2022-11-10 22:32:09.455 IST [24332] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-10 22:32:09.466 IST [24332] LOG:  listening on IPv6 address "::1", port 5432
2022-11-10 22:32:09.472 IST [24332] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-10 22:32:09.581 IST [25556] LOG:  database system was shut down at 2022-11-10 12:01:09 IST
2022-11-10 22:32:09.649 IST [24332] LOG:  database system is ready to accept connections
2022-11-10 22:32:40.652 IST [19544] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:32:52.417 IST [14408] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:33:08.718 IST [19076] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:33:11.246 IST [3736] ERROR:  relation "bse" does not exist at character 153
2022-11-10 22:33:11.246 IST [3736] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over( order by trade_date desc rows between 199 preceding  and current Row) as sma200 from BSE) select * from test limit 100
2022-11-10 22:33:24.796 IST [3736] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:37:09.569 IST [18732] LOG:  checkpoint starting: time
2022-11-10 22:37:09.588 IST [18732] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.004 s, total=0.020 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-10 22:40:46.082 IST [6072] ERROR:  relation "bse" does not exist at character 153
2022-11-10 22:40:46.082 IST [6072] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over( order by trade_date desc rows between 199 preceding  and current Row) as sma200 from BSE) select * from test limit 100
2022-11-10 22:42:50.785 IST [6072] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-10 22:42:50.785 IST [6072] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over( order by trade_date desc rows between 199 preceding  and current Row) as sma200 from BSE) select * from test limit 100
2022-11-10 22:42:57.876 IST [6072] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:43:24.376 IST [9612] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:43:24.376 IST [9612] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 22:47:09.604 IST [18732] LOG:  checkpoint starting: time
2022-11-10 22:48:36.886 IST [18732] LOG:  checkpoint complete: wrote 802 buffers (4.9%); 1 WAL file(s) added, 0 removed, 0 recycled; write=87.139 s, sync=0.062 s, total=87.282 s; sync files=27, longest=0.010 s, average=0.003 s; distance=7494 kB, estimate=7494 kB
2022-11-10 22:53:23.952 IST [19148] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:53:23.952 IST [19148] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 22:54:48.037 IST [1936] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:54:48.037 IST [1936] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 22:56:39.572 IST [5304] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:56:39.572 IST [5304] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 22:56:53.485 IST [19132] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:58:26.754 IST [26472] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:58:26.754 IST [26472] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 22:59:19.947 IST [12156] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:59:19.947 IST [12156] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 22:59:25.673 IST [21304] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 22:59:28.359 IST [20220] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:00:27.627 IST [11784] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:00:27.627 IST [11784] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:00:36.607 IST [15604] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:00:36.607 IST [15604] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:01:57.549 IST [16892] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:02:07.425 IST [23688] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:02:07.425 IST [23688] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:04:24.644 IST [25492] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:09:25.064 IST [23676] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:09:25.064 IST [23676] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:09:40.073 IST [3368] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:09:48.859 IST [6860] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:10:08.110 IST [24780] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:10:08.110 IST [24780] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:10:31.454 IST [18060] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:10:31.454 IST [18060] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:11:21.317 IST [20000] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:11:21.317 IST [20000] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:11:24.152 IST [25508] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:12:40.745 IST [24848] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:12:40.745 IST [24848] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:12:54.727 IST [14952] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:12:54.727 IST [14952] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:21:47.860 IST [14112] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:21:47.860 IST [14112] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:23:39.657 IST [17868] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:23:39.657 IST [17868] LOG:  unexpected EOF on client connection with an open transaction
2022-11-10 23:23:56.574 IST [23716] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 23:23:56.574 IST [23716] LOG:  unexpected EOF on client connection with an open transaction
2022-11-11 11:10:51.943 IST [2324] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-11 11:10:51.955 IST [2324] LOG:  listening on IPv6 address "::1", port 5432
2022-11-11 11:10:51.961 IST [2324] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-11 11:10:52.159 IST [15008] LOG:  database system was interrupted; last known up at 2022-11-10 22:48:36 IST
2022-11-11 11:10:52.740 IST [15008] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-11 11:10:52.750 IST [15008] LOG:  redo starts at 0/1DD7920
2022-11-11 11:10:52.751 IST [15008] LOG:  invalid record length at 0/1DD7A08: wanted 24, got 0
2022-11-11 11:10:52.751 IST [15008] LOG:  redo done at 0/1DD79D0 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-11 11:10:52.759 IST [1908] LOG:  checkpoint starting: end-of-recovery immediate wait
2022-11-11 11:10:52.780 IST [1908] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.004 s, sync=0.004 s, total=0.024 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-11 11:10:52.827 IST [2324] LOG:  database system is ready to accept connections
2022-11-11 11:11:06.439 IST [2324] LOG:  received fast shutdown request
2022-11-11 11:11:06.439 IST [15912] ERROR:  canceling statement due to user request
2022-11-11 11:11:06.440 IST [15836] ERROR:  canceling statement due to user request
2022-11-11 11:11:06.443 IST [2324] LOG:  aborting any active transactions
2022-11-11 11:11:06.444 IST [9208] FATAL:  terminating connection due to administrator command
2022-11-11 11:11:06.444 IST [23704] FATAL:  terminating connection due to administrator command
2022-11-11 11:11:06.464 IST [2324] LOG:  background worker "logical replication launcher" (PID 15912) exited with exit code 1
2022-11-11 11:11:06.478 IST [1908] LOG:  shutting down
2022-11-11 11:11:06.480 IST [1908] LOG:  checkpoint starting: shutdown immediate
2022-11-11 11:11:06.496 IST [1908] LOG:  checkpoint complete: wrote 0 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.019 s; sync files=0, longest=0.000 s, average=0.000 s; distance=0 kB, estimate=0 kB
2022-11-11 11:11:06.526 IST [2324] LOG:  database system is shut down
2022-11-11 11:11:09.281 IST [12344] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-11 11:11:09.293 IST [12344] LOG:  listening on IPv6 address "::1", port 5432
2022-11-11 11:11:09.299 IST [12344] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-11 11:11:09.385 IST [26500] LOG:  database system was shut down at 2022-11-11 11:11:06 IST
2022-11-11 11:11:09.425 IST [12344] LOG:  database system is ready to accept connections
2022-11-11 11:11:47.453 IST [23136] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:11:53.272 IST [22148] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:13:03.778 IST [20532] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:13:03.779 IST [20532] LOG:  unexpected EOF on client connection with an open transaction
2022-11-11 11:13:25.134 IST [25592] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:13:25.134 IST [25592] LOG:  unexpected EOF on client connection with an open transaction
2022-11-11 11:14:37.733 IST [20392] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:15:31.417 IST [25576] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:16:09.385 IST [22152] LOG:  checkpoint starting: time
2022-11-11 11:16:09.423 IST [22152] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.006 s, sync=0.005 s, total=0.038 s; sync files=2, longest=0.003 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-11 11:16:10.146 IST [4280] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:16:43.794 IST [9812] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:16:54.703 IST [10060] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:18:03.285 IST [18996] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:18:03.286 IST [18996] LOG:  unexpected EOF on client connection with an open transaction
2022-11-11 11:44:52.766 IST [21880] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:47:14.909 IST [17976] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:48:51.944 IST [19900] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:49:04.996 IST [19916] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:49:18.495 IST [4820] ERROR:  trailing junk after numeric literal at or near "1000a" at character 39
2022-11-11 11:49:18.495 IST [4820] STATEMENT:  with test as( select  case when close<1000andclose>500 then  from BSE) select * from test limit 10
2022-11-11 11:49:28.716 IST [4820] ERROR:  trailing junk after numeric literal at or near "1000a" at character 39
2022-11-11 11:49:28.716 IST [4820] STATEMENT:  with test as( select  case when close<1000andclose>500 then value from BSE) select * from test limit 10
2022-11-11 11:50:55.734 IST [4820] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:51:01.460 IST [15560] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:51:43.162 IST [9532] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:51:54.258 IST [20312] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:53:11.155 IST [19688] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:53:13.258 IST [13096] ERROR:  syntax error at or near "from" at character 74
2022-11-11 11:53:13.258 IST [13096] STATEMENT:  with test as( select  case when  close < 1000 or close > 2000  then true from BSE) select * from test limit 10
2022-11-11 11:54:10.636 IST [13096] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:54:26.198 IST [18716] ERROR:  syntax error at or near "endclose_lt_1000" at character 74
2022-11-11 11:54:26.198 IST [18716] STATEMENT:  with test as( select  case when  close < 1000 or close > 2000  then true endclose_lt_1000 from BSE) select * from test limit 10
2022-11-11 11:54:42.078 IST [18716] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:56:35.847 IST [32] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:56:35.847 IST [32] LOG:  unexpected EOF on client connection with an open transaction
2022-11-11 11:56:38.126 IST [20284] ERROR:  syntax error at or near "rowspartition" at character 93
2022-11-11 11:56:38.126 IST [20284] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over( order by trade_date desc rowspartition by between 199 preceding  and current Row) as sma200,case when  close < 1000 or close > 2000  then true end close_lt_1000 from BSE) select * from test limit 10
2022-11-11 11:57:07.433 IST [20284] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:57:46.052 IST [25548] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 11:58:03.063 IST [2476] ERROR:  syntax error at or near "by" at character 108
2022-11-11 11:58:03.063 IST [2476] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over( order by trade_date desc rows partition by code between 199 preceding  and current Row) as sma200,case when  close < 1000 or close > 2000  then true end close_lt_1000 from BSE) select * from test limit 10
2022-11-11 12:00:32.941 IST [2476] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:01:07.449 IST [18588] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:01:11.260 IST [14768] ERROR:  syntax error at or near "partition" at character 93
2022-11-11 12:01:11.260 IST [14768] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over( order by trade_date desc partition by coderows  between 199 preceding  and current Row) as sma200,case when  close < 1000 or close > 2000  then true end close_lt_1000 from BSE) select * from test limit 10
2022-11-11 12:01:59.586 IST [14768] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:02:09.530 IST [4380] ERROR:  syntax error at or near "partition" at character 93
2022-11-11 12:02:09.530 IST [4380] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over( order by trade_date desc partition by coderows  between 199 preceding  and current Row) as sma200,case when  close < 1000 or close > 2000  then true end close_lt_1000 from BSE) select * from test limit 10
2022-11-11 12:02:18.824 IST [4380] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:02:20.566 IST [18216] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:02:22.406 IST [15440] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:03:00.121 IST [25100] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:03:24.355 IST [9132] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:03:26.024 IST [25188] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:05:45.718 IST [15316] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:05:45.718 IST [15316] LOG:  unexpected EOF on client connection with an open transaction
2022-11-11 12:05:48.694 IST [14700] ERROR:  syntax error at or near "=" at character 248
2022-11-11 12:05:48.694 IST [14700] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over(partition by code order by trade_date desc rows  between 199 preceding  and current Row) as sma200,case when  close < 1000 or close > 2000  then true end close_lt_1000 from BSEcode = 500002  order by trade_date desc ) select * from test limit 10
2022-11-11 12:06:24.458 IST [14700] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:06:26.328 IST [15996] ERROR:  syntax error at or near "=" at character 254
2022-11-11 12:06:26.328 IST [15996] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over(partition by code order by trade_date desc rows  between 199 preceding  and current Row) as sma200,case when  close < 1000 or close > 2000  then true end close_lt_1000 from BSEcode where = where 500002 where   order by trade_date desc ) select * from test limit 10
2022-11-11 12:07:02.257 IST [15996] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:07:05.217 IST [7824] ERROR:  syntax error at or near "=" at character 254
2022-11-11 12:07:05.217 IST [7824] STATEMENT:  with test as( select  trade_date,code,close,name, AVG(close) over(partition by code order by trade_date desc rows  between 199 preceding  and current Row) as sma200,case when  close < 1000 or close > 2000  then true end close_lt_1000 from BSEcode where = where 500002 where   order by trade_date desc ) select * from test limit 10
2022-11-11 12:07:16.208 IST [7824] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:07:54.021 IST [9828] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:08:06.053 IST [12800] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:08:31.401 IST [17972] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:21:04.983 IST [23084] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:21:10.603 IST [15728] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:21:14.314 IST [4732] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:26:44.777 IST [11116] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:28:11.883 IST [6632] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:28:48.790 IST [20676] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:29:15.324 IST [17980] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:30:19.698 IST [12496] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:32:36.221 IST [26432] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:32:37.901 IST [12092] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:34:12.034 IST [20312] ERROR:  syntax error at or near "lt" at character 48
2022-11-11 12:34:12.034 IST [20312] STATEMENT:  WITH test AS( SELECT  code FROM BSE WHERE code lt 55000 and code gt 60000 ORDER BY trade_date desc ,name desc ,code desc ) select * from test limit 10
2022-11-11 12:35:22.953 IST [20312] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:35:38.624 IST [11832] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:35:47.402 IST [19340] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:36:18.020 IST [18064] ERROR:  syntax error at or near "ORDER" at character 44
2022-11-11 12:36:18.020 IST [18064] STATEMENT:  WITH test AS( SELECT  code FROM BSE WHERE  ORDER BY) select * from test limit 10
2022-11-11 12:36:43.597 IST [18064] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 12:40:40.661 IST [17404] ERROR:  canceling statement due to user request
2022-11-11 12:40:40.662 IST [12344] LOG:  received fast shutdown request
2022-11-11 12:40:40.674 IST [12344] LOG:  aborting any active transactions
2022-11-11 12:40:40.674 IST [19324] FATAL:  terminating connection due to administrator command
2022-11-11 12:40:40.675 IST [5504] FATAL:  terminating connection due to administrator command
2022-11-11 12:40:40.675 IST [12344] LOG:  background worker "logical replication launcher" (PID 17404) exited with exit code 1
2022-11-11 12:40:40.706 IST [22152] LOG:  shutting down
2022-11-11 12:40:40.709 IST [22152] LOG:  checkpoint starting: shutdown immediate
2022-11-11 12:40:40.722 IST [22152] LOG:  checkpoint complete: wrote 0 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.016 s; sync files=0, longest=0.000 s, average=0.000 s; distance=0 kB, estimate=0 kB
2022-11-11 12:40:40.753 IST [12344] LOG:  database system is shut down
2022-11-11 20:57:29.980 IST [17476] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-11 20:57:29.993 IST [17476] LOG:  listening on IPv6 address "::1", port 5432
2022-11-11 20:57:29.999 IST [17476] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-11 20:57:30.110 IST [26216] LOG:  database system was shut down at 2022-11-11 12:40:40 IST
2022-11-11 20:57:30.210 IST [17476] LOG:  database system is ready to accept connections
2022-11-11 20:59:55.371 IST [9200] ERROR:  syntax error at or near "BYcode" at character 77
2022-11-11 20:59:55.371 IST [9200] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name, AVG(close) OVER(PARTITION BYcode ORDER BY trade_date desc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM BSE ORDER BY trade_date desc ) select * from test limit 10
2022-11-11 21:00:29.627 IST [9200] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-11 21:02:30.104 IST [24460] LOG:  checkpoint starting: time
2022-11-11 21:02:30.469 IST [24460] LOG:  checkpoint complete: wrote 6 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.328 s, sync=0.006 s, total=0.367 s; sync files=3, longest=0.003 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-11 21:22:30.045 IST [24460] LOG:  checkpoint starting: time
2022-11-11 21:27:00.221 IST [24460] LOG:  checkpoint complete: wrote 14279 buffers (87.2%); 0 WAL file(s) added, 0 removed, 9 recycled; write=270.040 s, sync=0.039 s, total=270.176 s; sync files=11, longest=0.010 s, average=0.004 s; distance=137141 kB, estimate=137141 kB
2022-11-11 22:43:36.983 IST [2812] ERROR:  OVER specified, but round is not a window function nor an aggregate function at character 72
2022-11-11 22:43:36.983 IST [2812] STATEMENT:        
	with test as(
	select
		trade_date,
		code,
		close,
		name,
		round(avg(close)) over(partition by code
	order by
		trade_date rows between 199 preceding and current Row) as sma200 FROM BSE ORDER BY trade_date desc ) 
	select * from test where code = 532540
2022-11-12 00:40:54.227 IST [6520] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 00:40:54.227 IST [6520] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 00:41:57.693 IST [17708] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 00:42:05.499 IST [15460] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 00:42:07.604 IST [15560] ERROR:  LIMIT #,# syntax is not supported at character 110
2022-11-12 00:42:07.604 IST [15560] HINT:  Use separate LIMIT and OFFSET clauses.
2022-11-12 00:42:07.604 IST [15560] STATEMENT:  WITH test AS( SELECT  trade_date FROM BSE WHERE  code > 500000 ORDER BY trade_date desc ) select * from test limit 200,0
2022-11-12 00:43:25.012 IST [15560] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 00:44:07.825 IST [488] ERROR:  LIMIT #,# syntax is not supported at character 104
2022-11-12 00:44:07.825 IST [488] HINT:  Use separate LIMIT and OFFSET clauses.
2022-11-12 00:44:07.825 IST [488] STATEMENT:  WITH test AS( SELECT  code FROM BSE WHERE  code > 500000 ORDER BY trade_date desc ) select * from test limit 200,0
2022-11-12 00:45:05.179 IST [488] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 01:58:36.586 IST [2812] ERROR:  column "test.trade_date" must appear in the GROUP BY clause or be used in an aggregate function at character 227
2022-11-12 01:58:36.586 IST [2812] STATEMENT:  with test as(
	select
		trade_date,
		code,
		close,
		name,
		avg(round(close)) over(partition by code
	order by
		trade_date rows between 199 preceding and current Row) as sma200 FROM BSE ORDER BY trade_date desc ) 
	select *,array_agg(sma200) from test where code = 532540
	
	
2022-11-12 02:01:46.095 IST [2812] ERROR:  schema "matplotlib" does not exist
2022-11-12 02:01:46.095 IST [2812] STATEMENT:  CREATE FUNCTION matplotlib.simplelinechart (x numeric[], y numberic)
	  RETURNS numeric[]
	AS $$
	return x
	$$ LANGUAGE plpythonu
2022-11-12 02:02:02.235 IST [2812] ERROR:  language "plpythonu" does not exist
2022-11-12 02:02:02.235 IST [2812] STATEMENT:  
	CREATE FUNCTION matplotlib_simplelinechart (x numeric[], y numberic)
	  RETURNS numeric[]
	AS $$
	return x
	$$ LANGUAGE plpythonu
2022-11-12 02:02:09.044 IST [2812] ERROR:  type numberic does not exist
2022-11-12 02:02:09.044 IST [2812] STATEMENT:  
	CREATE FUNCTION matplotlib_simplelinechart (x numeric[], y numberic)
	  RETURNS numeric[]
	AS $$
	return x
	$$ LANGUAGE plpython3u
2022-11-12 02:03:19.227 IST [2812] ERROR:  function "matplotlib_simplelinechart" already exists with same argument types
2022-11-12 02:03:19.227 IST [2812] STATEMENT:  CREATE FUNCTION matplotlib_simplelinechart (x numeric[], y numeric[])
	  RETURNS numeric[]
	AS $$
	return x[1]
	$$ LANGUAGE plpython3u
2022-11-12 02:03:36.830 IST [2812] ERROR:  return value of function with array return type is not a Python sequence
2022-11-12 02:03:36.830 IST [2812] CONTEXT:  while creating return value
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 02:03:36.830 IST [2812] STATEMENT:  with test as(
	select
		trade_date,
		code,
		close,
		name,
		avg(round(close)) over(partition by code
	order by
		trade_date rows between 199 preceding and current Row) as sma200 FROM BSE ORDER BY trade_date desc ) 
	select matplotlib_simplelinechart(array_agg(sma200),array_agg(sma200)) from test where code = 532540
	
2022-11-12 02:04:04.185 IST [24460] LOG:  checkpoint starting: time
2022-11-12 02:04:04.890 IST [24460] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.657 s, sync=0.019 s, total=0.706 s; sync files=7, longest=0.010 s, average=0.003 s; distance=40 kB, estimate=123431 kB
2022-11-12 02:09:04.893 IST [24460] LOG:  checkpoint starting: time
2022-11-12 02:09:05.586 IST [24460] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.650 s, sync=0.020 s, total=0.693 s; sync files=7, longest=0.010 s, average=0.003 s; distance=43 kB, estimate=111092 kB
2022-11-12 02:09:54.824 IST [2812] ERROR:  function matplotlib_simplelinechart(numeric[], date[]) does not exist at character 227
2022-11-12 02:09:54.824 IST [2812] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-11-12 02:09:54.824 IST [2812] STATEMENT:  with test as(
	select
		trade_date,
		code,
		close,
		name,
		avg(round(close)) over(partition by code
	order by
		trade_date rows between 199 preceding and current Row) as sma200 FROM BSE ORDER BY trade_date desc ) 
	select matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date)) from test where code = 532540
2022-11-12 02:10:13.637 IST [2812] ERROR:  syntax error at or near "CREATE" at character 342
2022-11-12 02:10:13.637 IST [2812] STATEMENT:            
	with test as(
	select
		trade_date,
		code,
		close,
		name,
		avg(round(close)) over(partition by code
	order by
		trade_date rows between 199 preceding and current Row) as sma200 FROM BSE ORDER BY trade_date desc ) 
	select matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date)) from test where code = 532540
	
	
	CREATE or replace FUNCTION matplotlib_simplelinechart (xdat numeric[], ydat date[])
	  RETURNS bytea
	AS $$
	import base64
	from io import BytesIO
	from matplotlib.figure import Figure
	
	buf = BytesIO()
	import matplotlib.pyplot as plt
	import numpy as np
	
	f1, ax = plt.subplots(figsize = (10,5))
	ax.plot(ydat, xdat, label='sma200' )
	plt.xlabel('DATE')
	plt.ylabel('STOCK')
	plt.title('Name of stock')
	plt.legend()
	buffer = BytesIO()
	plt.savefig(buffer, format="png")
	return buffer.getvalue()
	$$ LANGUAGE plpython3u
2022-11-12 02:13:09.800 IST [2812] ERROR:  ValueError: x, y, and format string must not be None
2022-11-12 02:13:09.800 IST [2812] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 11, in <module>
	    ax.plot(ydat, xdat, label='sma200' )
	  PL/Python function "matplotlib_simplelinechart", line 1661, in plot
	  PL/Python function "matplotlib_simplelinechart", line 310, in __call__
	  PL/Python function "matplotlib_simplelinechart", line 464, in _plot_args
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 02:13:09.800 IST [2812] STATEMENT:              
	with test as(
	select
		trade_date,
		code,
		close,
		name,
		avg(round(close)) over(partition by code
	order by
		trade_date rows between 199 preceding and current Row) as sma200 FROM BSE ORDER BY trade_date desc limit 100) 
	select matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date)) from test where code = 532540
	limit 10
	
2022-11-12 02:14:04.602 IST [24460] LOG:  checkpoint starting: time
2022-11-12 02:14:05.304 IST [24460] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.658 s, sync=0.024 s, total=0.702 s; sync files=7, longest=0.010 s, average=0.004 s; distance=44 kB, estimate=99987 kB
2022-11-12 02:15:27.182 IST [17476] LOG:  background worker "logical replication launcher" (PID 24044) was terminated by exception 0x40010004
2022-11-12 02:15:27.182 IST [17476] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-11-12 02:15:27.182 IST [17476] LOG:  terminating any other active server processes
2022-11-12 02:15:27.275 IST [17476] LOG:  all server processes terminated; reinitializing
^C2022-11-12 12:17:20.222 IST [25820] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 12:17:20.242 IST [25820] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 12:17:20.253 IST [25820] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 12:17:20.420 IST [15272] LOG:  database system was interrupted; last known up at 2022-11-12 02:14:05 IST
2022-11-12 12:17:22.355 IST [15272] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-12 12:17:22.365 IST [15272] LOG:  redo starts at 0/A3E5858
2022-11-12 12:17:22.373 IST [15272] LOG:  invalid record length at 0/A3F0138: wanted 24, got 0
2022-11-12 12:17:22.373 IST [15272] LOG:  redo done at 0/A3F0100 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-12 12:17:22.380 IST [25492] LOG:  checkpoint starting: end-of-recovery immediate wait
2022-11-12 12:17:22.416 IST [25492] LOG:  checkpoint complete: wrote 10 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.008 s, sync=0.014 s, total=0.039 s; sync files=9, longest=0.003 s, average=0.002 s; distance=42 kB, estimate=42 kB
2022-11-12 12:17:22.517 IST [25820] LOG:  database system is ready to accept connections
2022-11-12 12:17:33.711 IST [16996] ERROR:  syntax error at or near "WITH" at character 86
2022-11-12 12:17:33.711 IST [16996] STATEMENT:  WITH test AS (
	SELECT
		*
	FROM
		bse
	WHERE
		code = 532540
	ORDER BY
		trade_date WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC )
			
	SELECT
		*
	FROM
		test
	WHERE
		code = 500209
	LIMIT 10 
			
	SELECT
		matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date))
	FROM
		test
	WHERE
		code = 500209
	LIMIT 10 
	
2022-11-12 12:19:02.334 IST [16996] ERROR:  syntax error at or near "matplotlib_simplelinechart" at character 14
2022-11-12 12:19:02.334 IST [16996] STATEMENT:  SELECT
		*
		matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date))
	FROM
		test
	WHERE
		code = 500209
	LIMIT 10 
2022-11-12 12:19:05.339 IST [16996] ERROR:  syntax error at or near "matplotlib_simplelinechart" at character 254
2022-11-12 12:19:05.339 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC )
			
	SELECT
		*
		matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date))
	FROM
		test
	WHERE
		code = 500209
	LIMIT 10 
2022-11-12 12:19:11.854 IST [16996] ERROR:  column "test.trade_date" must appear in the GROUP BY clause or be used in an aggregate function at character 250
2022-11-12 12:19:11.854 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC )
			
	SELECT
		*,
		matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date))
	FROM
		test
	WHERE
		code = 500209
	LIMIT 10 
2022-11-12 12:20:28.793 IST [16996] ERROR:  syntax error at or near "SELECT" at character 370
2022-11-12 12:20:28.793 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC )
			
	SELECT
		matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date))
	FROM
		test
	WHERE
		code = 500209
	LIMIT 10 
			
	SELECT
		matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date))
	FROM
		test
	WHERE
		code = 500209
	LIMIT 10 
2022-11-12 12:22:22.423 IST [25492] LOG:  checkpoint starting: time
2022-11-12 12:22:22.910 IST [25492] LOG:  checkpoint complete: wrote 5 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.431 s, sync=0.020 s, total=0.487 s; sync files=5, longest=0.011 s, average=0.004 s; distance=27 kB, estimate=40 kB
2022-11-12 12:29:26.887 IST [16996] ERROR:  syntax error at end of input at character 330
2022-11-12 12:29:26.887 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select sma200,trade_date
	FROM
		test
	WHERE
		code = 500209
		limit 10
2022-11-12 12:29:52.850 IST [16996] ERROR:  syntax error at end of input at character 329
2022-11-12 12:29:52.850 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select sma200,trade_date
	FROM
		test
	WHERE
		code = 500209
		limit 1
2022-11-12 12:30:48.272 IST [16996] ERROR:  syntax error at or near "selectmatplotlib_simplelinechart" at character 332
2022-11-12 12:30:48.272 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select sma200,trade_date
	FROM
		test
	WHERE
		code = 500209
		limit 1
	)selectmatplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date)) from lmt  
2022-11-12 12:32:22.933 IST [25492] LOG:  checkpoint starting: time
2022-11-12 12:32:23.416 IST [25492] LOG:  checkpoint complete: wrote 5 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.450 s, sync=0.010 s, total=0.484 s; sync files=5, longest=0.003 s, average=0.002 s; distance=28 kB, estimate=39 kB
2022-11-12 12:38:55.108 IST [16996] ERROR:  syntax error at or near "SELECT" at character 431
2022-11-12 12:38:55.108 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select sma200,trade_date
	FROM
		test
	WHERE
		code = 532540
	
		limit 125
	)select matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
			
	SELECT
		matplotlib_simplelinechart(array_agg(sma200),array_agg(trade_date))
	FROM
		test
	WHERE
		code = 500209
	LIMIT 10 
<string>:7: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
2022-11-12 12:42:22.432 IST [25492] LOG:  checkpoint starting: time
2022-11-12 12:42:22.915 IST [25492] LOG:  checkpoint complete: wrote 5 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.440 s, sync=0.019 s, total=0.483 s; sync files=5, longest=0.011 s, average=0.004 s; distance=29 kB, estimate=38 kB
2022-11-12 13:28:35.230 IST [25492] LOG:  checkpoint starting: time
2022-11-12 13:28:35.703 IST [25492] LOG:  checkpoint complete: wrote 5 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.439 s, sync=0.018 s, total=0.474 s; sync files=5, longest=0.010 s, average=0.004 s; distance=29 kB, estimate=37 kB
2022-11-12 13:33:35.705 IST [25492] LOG:  checkpoint starting: time
2022-11-12 13:33:36.386 IST [25492] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.650 s, sync=0.010 s, total=0.682 s; sync files=7, longest=0.002 s, average=0.002 s; distance=43 kB, estimate=43 kB
<string>:6: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
<string>:6: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
2022-11-12 14:14:56.766 IST [16996] ERROR:  NameError: name 'false' is not defined
2022-11-12 14:14:56.766 IST [16996] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 5, in <module>
	    plt.rcParams['axes.grid'] = false
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 14:14:56.766 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date
	FROM
		test
	WHERE
		code = 532540
	
		limit 365
	)select matplotlib_simplelinechart(array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
2022-11-12 14:17:52.162 IST [25492] LOG:  checkpoint starting: time
2022-11-12 14:17:53.491 IST [25492] LOG:  checkpoint complete: wrote 13 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.292 s, sync=0.018 s, total=1.330 s; sync files=9, longest=0.004 s, average=0.002 s; distance=76 kB, estimate=76 kB
2022-11-12 14:19:46.062 IST [16996] ERROR:  syntax error at or near "trade_date" at character 451
2022-11-12 14:19:46.062 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date
	FROM
		test
	WHERE
		code = 532540
	
		limit 10
	)select matplotlib_simplelinechart(array_agg(close),array_agg(sma200),array_agg(date_trunc('month', trade_date)trade_date)) from lmt  
	
	
			
2022-11-12 14:20:03.967 IST [16996] ERROR:  function matplotlib_simplelinechart(numeric[], numeric[], timestamp with time zone[]) does not exist at character 348
2022-11-12 14:20:03.967 IST [16996] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-11-12 14:20:03.967 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date
	FROM
		test
	WHERE
		code = 532540
	
		limit 10
	)select matplotlib_simplelinechart(array_agg(close),array_agg(sma200),array_agg(date_trunc('month', trade_date))) from lmt  
	
	
			
2022-11-12 14:21:14.024 IST [16996] ERROR:  syntax error at or near "scrip_name" at character 125
2022-11-12 14:21:14.024 IST [16996] STATEMENT:  CREATE OR REPLACE FUNCTION public.matplotlib_simplelinechart(close_arr numeric[], sma200_arr numeric[], ydat date[],varchar scrip_name)
	 RETURNS bytea
	 LANGUAGE plpython3u
	AS $function$
	from io import BytesIO
	import matplotlib.pyplot as plt
	
	plt.rcParams['axes.grid'] = False
	plt.xticks(rotation=45)
	fig, ax = plt.subplots(figsize=(10,5), layout='constrained')
	ax.plot(ydat, sma200_arr, label='sma200')  
	ax.plot(ydat, close_arr, label='close')  
	ax.set_xlabel('Trade Date')
	ax.set_ylabel('SMA 200')
	ax.set_title("SMA 200")
	ax.legend();  # Add a legend.
	
	buffer = BytesIO()
	plt.savefig(buffer, format="png")
	return buffer.getvalue()
	$function$
	
2022-11-12 14:21:30.688 IST [16996] ERROR:  syntax error at or near "scrip_name" at character 125
2022-11-12 14:21:30.688 IST [16996] STATEMENT:  CREATE OR REPLACE FUNCTION public.matplotlib_simplelinechart(close_arr numeric[], sma200_arr numeric[], ydat date[],varchar scrip_name)
	 RETURNS bytea
	 LANGUAGE plpython3u
	AS $function$
	from io import BytesIO
	import matplotlib.pyplot as plt
	
	plt.rcParams['axes.grid'] = False
	plt.xticks(rotation=45)
	fig, ax = plt.subplots(figsize=(10,5), layout='constrained')
	ax.plot(ydat, sma200_arr, label='sma200')  
	ax.plot(ydat, close_arr, label='close')  
	ax.set_xlabel('Trade Date')
	ax.set_ylabel('SMA 200')
	ax.set_title(scrip_name)
	ax.legend();  # Add a legend.
	
	buffer = BytesIO()
	plt.savefig(buffer, format="png")
	return buffer.getvalue()
	$function$
	
2022-11-12 14:21:37.313 IST [16996] ERROR:  type scrip_name does not exist
2022-11-12 14:21:37.313 IST [16996] STATEMENT:  CREATE OR REPLACE FUNCTION public.matplotlib_simplelinechart(close_arr numeric[], sma200_arr numeric[], ydat date[],text scrip_name)
	 RETURNS bytea
	 LANGUAGE plpython3u
	AS $function$
	from io import BytesIO
	import matplotlib.pyplot as plt
	
	plt.rcParams['axes.grid'] = False
	plt.xticks(rotation=45)
	fig, ax = plt.subplots(figsize=(10,5), layout='constrained')
	ax.plot(ydat, sma200_arr, label='sma200')  
	ax.plot(ydat, close_arr, label='close')  
	ax.set_xlabel('Trade Date')
	ax.set_ylabel('SMA 200')
	ax.set_title(scrip_name)
	ax.legend();  # Add a legend.
	
	buffer = BytesIO()
	plt.savefig(buffer, format="png")
	return buffer.getvalue()
	$function$
	
2022-11-12 14:22:52.494 IST [25492] LOG:  checkpoint starting: time
2022-11-12 14:22:52.854 IST [25492] LOG:  checkpoint complete: wrote 4 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.320 s, sync=0.018 s, total=0.361 s; sync files=4, longest=0.011 s, average=0.005 s; distance=14 kB, estimate=70 kB
2022-11-12 14:27:08.147 IST [16996] ERROR:  syntax error at or near "array_agg" at character 8
2022-11-12 14:27:08.147 IST [16996] STATEMENT:  
	
	
	(array_agg(sma200),array_agg(trade_date))
2022-11-12 14:27:48.318 IST [16996] ERROR:  column "name" does not exist at character 375
2022-11-12 14:27:48.318 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date
	FROM
		test
	WHERE
		code = 532540
	
		limit 10
	)select matplotlib_simplelinechart(name,array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
2022-11-12 14:27:52.847 IST [25492] LOG:  checkpoint starting: time
2022-11-12 14:27:53.636 IST [25492] LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.751 s, sync=0.018 s, total=0.790 s; sync files=7, longest=0.010 s, average=0.003 s; distance=43 kB, estimate=67 kB
2022-11-12 14:28:06.980 IST [16996] ERROR:  column "lmt.name" must appear in the GROUP BY clause or be used in an aggregate function at character 380
2022-11-12 14:28:06.980 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
	
		limit 10
	)select matplotlib_simplelinechart(name,array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
			
2022-11-12 14:29:04.348 IST [16996] ERROR:  NameError: name 'BytesIO' is not defined
2022-11-12 14:29:04.348 IST [16996] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 6, in <module>
	    buf = BytesIO()
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 14:29:04.348 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
	
		limit 10
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
2022-11-12 14:30:04.737 IST [16996] ERROR:  NameError: name 'BytesIO' is not defined
2022-11-12 14:30:04.737 IST [16996] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 13, in <module>
	    buffer = BytesIO()
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 14:30:04.737 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
	
		limit 10
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
2022-11-12 14:30:39.661 IST [16996] ERROR:  NameError: name 'BytesIO' is not defined
2022-11-12 14:30:39.661 IST [16996] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 13, in <module>
	    buffer = BytesIO()
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 14:30:39.661 IST [16996] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
	
		limit 10
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
2022-11-12 14:32:52.626 IST [25492] LOG:  checkpoint starting: time
2022-11-12 14:32:53.325 IST [25492] LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.654 s, sync=0.022 s, total=0.700 s; sync files=7, longest=0.010 s, average=0.004 s; distance=49 kB, estimate=65 kB
2022-11-12 14:37:52.338 IST [25492] LOG:  checkpoint starting: time
2022-11-12 14:37:52.815 IST [25492] LOG:  checkpoint complete: wrote 5 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.440 s, sync=0.012 s, total=0.478 s; sync files=5, longest=0.004 s, average=0.003 s; distance=24 kB, estimate=61 kB
2022-11-12 14:39:10.985 IST [16996] ERROR:  could not compile PL/Python function "matplotlib_simplelinechart"
2022-11-12 14:39:10.985 IST [16996] DETAIL:  SyntaxError: closing parenthesis ')' does not match opening parenthesis '[' (<string>, line 14)
2022-11-12 14:39:10.985 IST [16996] STATEMENT:  CREATE OR REPLACE FUNCTION public.matplotlib_simplelinechart(name text[], close numeric[], sma200 numeric[], trade_date date[])
	 RETURNS bytea
	 LANGUAGE plpython3u
	AS $function$
	import matplotlib as mpl
	import matplotlib.pyplot as plt
	from io import BytesIO
	plt.style.use('_mpl-gallery')
	
	fig = plt.figure()  # an empty figure with no Axes
	fig, ax = plt.subplots(figsize = (10,5),layout='constrained')
	ax.plot(trade_date, close,label='close' )
	ax.plot(trade_date, sma200, label='sma200' )
	ax.set_xlabel('date')  # Add an x-label to the axes.
	ax.set_ylabel('close,sma200')  # Add a y-label to the axes.
	ax.set_title(name[0)  # Add a title to the axes.
	ax.legend();  # Add a legend.
	buffer = BytesIO()
	plt.savefig(buffer, format="png")
	return buffer.getvalue()
	$function$
	
2022-11-12 14:42:52.817 IST [25492] LOG:  checkpoint starting: time
2022-11-12 14:42:53.285 IST [25492] LOG:  checkpoint complete: wrote 5 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.445 s, sync=0.008 s, total=0.468 s; sync files=5, longest=0.003 s, average=0.002 s; distance=34 kB, estimate=59 kB
2022-11-12 17:35:18.510 IST [10128] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:41:00.212 IST [5696] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:41:45.430 IST [15160] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:42:01.282 IST [24376] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:43:13.666 IST [1916] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:43:37.219 IST [12724] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:50:36.545 IST [12316] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:51:13.395 IST [2300] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:51:26.279 IST [8876] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:51:34.106 IST [12904] ERROR:  syntax error at or near "from" at character 684
2022-11-12 17:51:34.106 IST [12904] STATEMENT:  
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 200
	        )select (array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt 
	
	    
2022-11-12 17:52:02.267 IST [12904] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:52:43.425 IST [10720] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:52:43.425 IST [10720] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:53:09.550 IST [1016] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:53:09.550 IST [1016] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:53:28.926 IST [16300] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:53:28.926 IST [16300] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:53:49.380 IST [11928] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:53:49.380 IST [11928] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:54:15.218 IST [6260] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:54:15.218 IST [6260] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:55:44.061 IST [2708] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:55:44.061 IST [2708] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:55:57.085 IST [14792] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:55:57.085 IST [14792] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:56:12.049 IST [17064] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:56:12.049 IST [17064] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:57:25.792 IST [19656] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:57:25.793 IST [19656] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:57:54.608 IST [18588] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:57:54.608 IST [18588] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:57:59.191 IST [22472] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:57:59.192 IST [22472] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:58:18.327 IST [6208] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:58:18.327 IST [6208] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 17:58:31.230 IST [21540] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 17:58:31.230 IST [21540] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 18:00:38.764 IST [17380] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:00:38.764 IST [17380] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 18:01:05.292 IST [9372] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:01:26.648 IST [18636] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:01:26.648 IST [18636] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 18:01:55.336 IST [10860] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:01:55.336 IST [10860] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 18:02:29.265 IST [16252] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:02:29.265 IST [16252] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 18:03:19.809 IST [23396] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:03:19.809 IST [23396] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 18:03:30.733 IST [14184] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:03:46.085 IST [20136] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:03:46.085 IST [20136] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 18:19:33.374 IST [16996] ERROR:  could not compile PL/Python function "matplotlib_simplelinechart"
2022-11-12 18:19:33.374 IST [16996] DETAIL:  IndentationError: unindent does not match any outer indentation level (<string>, line 4)
2022-11-12 18:19:33.374 IST [16996] STATEMENT:  CREATE OR REPLACE FUNCTION public.matplotlib_simplelinechart(name text[], close numeric[], sma200 numeric[], trade_date date[])
	 RETURNS bytea
	 LANGUAGE plpython3u
	AS $function$
		from io import BytesIO
	    import matplotlib as mpl
	    mpl.use('Agg')
	    import matplotlib.pyplot as plt
	    # import numpy as np
	
	    plt.rcParams["figure.figsize"] = [7.50, 3.50]
	    plt.rcParams["figure.autolayout"] = True
	
	    # x = np.linspace(0, 2, 100)  # Sample data.
	    plt.figure(figsize=(10, 5), layout='constrained')
	    plt.plot(trade_date, close, label='close')  # Plot some data on the (implicit) axes.
	    plt.plot(trade_date,sma200, label='sma200')  # etc.
	    plt.xlabel('close, sma200')
	    plt.ylabel('trade date')
	    plt.title(name[0])
	    plt.legend()
	
	    buffer = BytesIO()
	    plt.savefig(buffer, format="png")
	return buffer.getvalue()
	$function$
	
2022-11-12 18:19:46.793 IST [16996] ERROR:  could not compile PL/Python function "matplotlib_simplelinechart"
2022-11-12 18:19:46.793 IST [16996] DETAIL:  IndentationError: unindent does not match any outer indentation level (<string>, line 4)
2022-11-12 18:19:46.793 IST [16996] STATEMENT:  CREATE OR REPLACE FUNCTION public.matplotlib_simplelinechart(name text[], close numeric[], sma200 numeric[], trade_date date[])
	 RETURNS bytea
	 LANGUAGE plpython3u
	AS $function$
		from io import BytesIO
	    import matplotlib as mpl
	    mpl.use('Agg')
	    import matplotlib.pyplot as plt
	    # import numpy as np
	
	    plt.rcParams["figure.figsize"] = [7.50, 3.50]
	    plt.rcParams["figure.autolayout"] = True
	
	    # x = np.linspace(0, 2, 100)  # Sample data.
	    plt.figure(figsize=(10, 5), layout='constrained')
	    plt.plot(trade_date, close, label='close')  # Plot some data on the (implicit) axes.
	    plt.plot(trade_date,sma200, label='sma200')  # etc.
	    plt.xlabel('close, sma200')
	    plt.ylabel('trade date')
	    plt.title(name[0])
	    plt.legend()
	
	    buffer = BytesIO()
	    plt.savefig(buffer, format="png")
		return buffer.getvalue()
	$function$
	
2022-11-12 18:20:11.564 IST [12284] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 18:20:11.564 IST [12284] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 18:22:50.577 IST [5320] ERROR:  ModuleNotFoundError: No module named 'matplotlib.artist'
2022-11-12 18:22:50.577 IST [5320] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 5, in <module>
	    import matplotlib.pyplot as plt
	  PL/Python function "matplotlib_simplelinechart", line 51, in <module>
	  PL/Python function "matplotlib_simplelinechart", line 18, in <module>
	  PL/Python function "matplotlib_simplelinechart", line 19, in <module>
	  PL/Python function "matplotlib_simplelinechart", line 13, in <module>
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 18:22:50.577 IST [5320] STATEMENT:  WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 200
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
2022-11-12 18:24:11.469 IST [17648] ERROR:  canceling statement due to user request
2022-11-12 18:24:11.470 IST [25820] LOG:  received fast shutdown request
2022-11-12 18:24:11.480 IST [25820] LOG:  aborting any active transactions
2022-11-12 18:24:11.481 IST [1996] FATAL:  terminating connection due to administrator command
2022-11-12 18:24:11.482 IST [21712] FATAL:  terminating connection due to administrator command
2022-11-12 18:24:11.482 IST [14548] FATAL:  terminating connection due to administrator command
2022-11-12 18:24:11.503 IST [25820] LOG:  background worker "logical replication launcher" (PID 17648) exited with exit code 1
2022-11-12 18:24:11.516 IST [25492] LOG:  shutting down
2022-11-12 18:24:11.519 IST [25492] LOG:  checkpoint starting: shutdown immediate
2022-11-12 18:24:11.546 IST [25492] LOG:  checkpoint complete: wrote 5 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.005 s, sync=0.010 s, total=0.031 s; sync files=5, longest=0.004 s, average=0.002 s; distance=31 kB, estimate=56 kB
2022-11-12 18:24:11.598 IST [25820] LOG:  database system is shut down
2022-11-12 18:24:14.267 IST [23032] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 18:24:14.279 IST [23032] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 18:24:14.286 IST [23032] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 18:24:14.379 IST [11952] LOG:  database system was shut down at 2022-11-12 18:24:11 IST
2022-11-12 18:24:14.435 IST [23032] LOG:  database system is ready to accept connections
2022-11-12 18:28:50.033 IST [12976] ERROR:  canceling statement due to user request
2022-11-12 18:28:50.034 IST [23032] LOG:  received fast shutdown request
2022-11-12 18:28:50.045 IST [23032] LOG:  aborting any active transactions
2022-11-12 18:28:50.046 IST [14552] FATAL:  terminating connection due to administrator command
2022-11-12 18:28:50.047 IST [2576] FATAL:  terminating connection due to administrator command
2022-11-12 18:28:50.065 IST [23032] LOG:  background worker "logical replication launcher" (PID 12976) exited with exit code 1
2022-11-12 18:28:50.071 IST [11344] LOG:  shutting down
2022-11-12 18:28:50.074 IST [11344] LOG:  checkpoint starting: shutdown immediate
2022-11-12 18:28:50.094 IST [11344] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.004 s, total=0.023 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-12 18:28:50.130 IST [23032] LOG:  database system is shut down
2022-11-12 18:31:09.504 IST [5068] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 18:31:09.516 IST [5068] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 18:31:09.523 IST [5068] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 18:31:09.617 IST [4124] LOG:  database system was shut down at 2022-11-12 18:28:50 IST
2022-11-12 18:31:09.677 IST [5068] LOG:  database system is ready to accept connections
2022-11-12 18:31:30.769 IST [13680] ERROR:  function blah() does not exist at character 10
2022-11-12 18:31:30.769 IST [13680] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-11-12 18:31:30.769 IST [13680] STATEMENT:  
	select blah()
2022-11-12 18:31:46.545 IST [13680] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 18:31:46.545 IST [13680] STATEMENT:  select blah('')
2022-11-12 18:32:15.126 IST [22236] ERROR:  canceling statement due to user request
2022-11-12 18:32:15.127 IST [5068] LOG:  received fast shutdown request
2022-11-12 18:32:15.138 IST [5068] LOG:  aborting any active transactions
2022-11-12 18:32:15.139 IST [13680] FATAL:  terminating connection due to administrator command
2022-11-12 18:32:15.139 IST [11152] FATAL:  terminating connection due to administrator command
2022-11-12 18:32:15.140 IST [18184] FATAL:  terminating connection due to administrator command
2022-11-12 18:32:15.154 IST [5068] LOG:  background worker "logical replication launcher" (PID 22236) exited with exit code 1
2022-11-12 18:32:15.184 IST [12572] LOG:  shutting down
2022-11-12 18:32:15.186 IST [12572] LOG:  checkpoint starting: shutdown immediate
2022-11-12 18:32:15.209 IST [12572] LOG:  checkpoint complete: wrote 4 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.005 s, sync=0.006 s, total=0.025 s; sync files=3, longest=0.003 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-12 18:32:15.234 IST [5068] LOG:  database system is shut down
2022-11-12 18:42:06.938 IST [12584] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 18:42:06.950 IST [12584] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 18:42:06.957 IST [12584] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 18:42:07.045 IST [20416] LOG:  database system was shut down at 2022-11-12 18:32:15 IST
2022-11-12 18:42:07.085 IST [12584] LOG:  database system is ready to accept connections
2022-11-12 18:42:11.522 IST [18952] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 18:42:11.522 IST [18952] STATEMENT:  
	
	select blah('')
	
2022-11-12 18:42:17.885 IST [18952] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 18:42:17.885 IST [18952] STATEMENT:  
	select blah('')
	
2022-11-12 18:46:41.431 IST [12584] LOG:  received fast shutdown request
2022-11-12 18:46:41.441 IST [12584] LOG:  aborting any active transactions
2022-11-12 18:46:41.441 IST [18952] FATAL:  terminating connection due to administrator command
2022-11-12 18:46:41.451 IST [12584] LOG:  background worker "logical replication launcher" (PID 19804) exited with exit code 1
2022-11-12 18:46:41.473 IST [23016] LOG:  shutting down
2022-11-12 18:46:41.475 IST [23016] LOG:  checkpoint starting: shutdown immediate
2022-11-12 18:46:41.498 IST [23016] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.003 s, total=0.026 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-12 18:46:41.520 IST [12584] LOG:  database system is shut down
2022-11-12 18:46:42.053 IST [1976] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 18:46:42.065 IST [1976] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 18:46:42.072 IST [1976] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 18:46:42.159 IST [21920] LOG:  database system was shut down at 2022-11-12 18:46:41 IST
2022-11-12 18:46:42.215 IST [1976] LOG:  database system is ready to accept connections
2022-11-12 18:46:46.502 IST [14548] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 18:46:46.502 IST [14548] STATEMENT:  select blah('')
2022-11-12 18:51:42.139 IST [16576] LOG:  checkpoint starting: time
2022-11-12 18:51:42.163 IST [16576] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.004 s, total=0.025 s; sync files=2, longest=0.003 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-12 18:51:53.703 IST [1976] LOG:  received fast shutdown request
2022-11-12 18:51:53.707 IST [1976] LOG:  aborting any active transactions
2022-11-12 18:51:53.707 IST [14548] FATAL:  terminating connection due to administrator command
2022-11-12 18:51:53.736 IST [1976] LOG:  background worker "logical replication launcher" (PID 21004) exited with exit code 1
2022-11-12 18:51:53.739 IST [16576] LOG:  shutting down
2022-11-12 18:51:53.741 IST [16576] LOG:  checkpoint starting: shutdown immediate
2022-11-12 18:51:53.752 IST [16576] LOG:  checkpoint complete: wrote 0 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.014 s; sync files=0, longest=0.000 s, average=0.000 s; distance=0 kB, estimate=0 kB
2022-11-12 18:51:53.784 IST [1976] LOG:  database system is shut down
2022-11-12 18:51:54.239 IST [8588] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 18:51:54.251 IST [8588] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 18:51:54.259 IST [8588] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 18:51:54.346 IST [18100] LOG:  database system was shut down at 2022-11-12 18:51:53 IST
2022-11-12 18:51:54.408 IST [8588] LOG:  database system is ready to accept connections
2022-11-12 18:51:59.826 IST [10740] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 18:51:59.826 IST [10740] STATEMENT:  
	select blah('')
2022-11-12 18:54:07.398 IST [16060] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 18:54:07.581 IST [16060] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 18:54:07.602 IST [16060] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 18:54:07.959 IST [15868] LOG:  database system was interrupted; last known up at 2022-11-12 18:51:54 IST
2022-11-12 18:54:11.073 IST [15868] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-12 18:54:11.192 IST [15868] LOG:  invalid record length at 0/A45C8E8: wanted 24, got 0
2022-11-12 18:54:11.193 IST [15868] LOG:  redo is not required
2022-11-12 18:54:11.203 IST [1900] LOG:  checkpoint starting: end-of-recovery immediate wait
2022-11-12 18:54:11.262 IST [1900] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.006 s, sync=0.007 s, total=0.063 s; sync files=2, longest=0.004 s, average=0.004 s; distance=0 kB, estimate=0 kB
2022-11-12 18:54:11.474 IST [16060] LOG:  database system is ready to accept connections
2022-11-12 18:54:34.433 IST [6596] ERROR:  cannot drop extension plpython3u because other objects depend on it
2022-11-12 18:54:34.433 IST [6596] DETAIL:  function blah(character varying) depends on language plpython3u
	function pymax(integer,integer) depends on language plpython3u
	function matplotlib_simplelinechart(text[],numeric[],numeric[],date[]) depends on language plpython3u
2022-11-12 18:54:34.433 IST [6596] HINT:  Use DROP ... CASCADE to drop the dependent objects too.
2022-11-12 18:54:34.433 IST [6596] STATEMENT:  
	drop extension plpython3u
2022-11-12 18:55:36.182 IST [6596] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 18:55:36.182 IST [6596] STATEMENT:  create extension plpython3u
	
2022-11-12 18:56:20.825 IST [11868] ERROR:  canceling statement due to user request
2022-11-12 18:56:20.826 IST [16060] LOG:  received fast shutdown request
2022-11-12 18:56:20.832 IST [16060] LOG:  aborting any active transactions
2022-11-12 18:56:20.832 IST [6596] FATAL:  terminating connection due to administrator command
2022-11-12 18:56:20.833 IST [6508] FATAL:  terminating connection due to administrator command
2022-11-12 18:56:20.834 IST [13588] FATAL:  terminating connection due to administrator command
2022-11-12 18:56:20.834 IST [16300] FATAL:  terminating connection due to administrator command
2022-11-12 18:56:20.851 IST [16060] LOG:  background worker "logical replication launcher" (PID 11868) exited with exit code 1
2022-11-12 18:56:20.881 IST [1900] LOG:  shutting down
2022-11-12 18:56:20.884 IST [1900] LOG:  checkpoint starting: shutdown immediate
2022-11-12 18:56:20.941 IST [1900] LOG:  checkpoint complete: wrote 19 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.007 s, sync=0.039 s, total=0.061 s; sync files=15, longest=0.007 s, average=0.003 s; distance=85 kB, estimate=85 kB
2022-11-12 18:56:20.984 IST [16060] LOG:  database system is shut down
2022-11-12 18:58:34.668 IST [5196] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 18:58:34.680 IST [5196] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 18:58:34.686 IST [5196] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 18:58:34.780 IST [6764] LOG:  database system was shut down at 2022-11-12 18:56:20 IST
2022-11-12 18:58:34.846 IST [5196] LOG:  database system is ready to accept connections
2022-11-12 18:58:42.468 IST [18100] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 18:58:42.468 IST [18100] STATEMENT:  
	create extension plpython3u
2022-11-12 19:00:53.964 IST [7088] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:01:12.413 IST [5196] LOG:  server process (PID 18688) exited with exit code 1
2022-11-12 19:01:12.413 IST [5196] LOG:  terminating any other active server processes
2022-11-12 19:05:17.741 IST [13328] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 19:05:17.753 IST [13328] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 19:05:17.759 IST [13328] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 19:05:17.854 IST [5768] LOG:  database system was interrupted; last known up at 2022-11-12 18:58:34 IST
2022-11-12 19:05:18.237 IST [5768] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-12 19:05:18.243 IST [5768] LOG:  redo starts at 0/A471DD8
2022-11-12 19:05:18.248 IST [5768] LOG:  invalid record length at 0/A482730: wanted 24, got 0
2022-11-12 19:05:18.248 IST [5768] LOG:  redo done at 0/A4826F8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-12 19:05:18.253 IST [10436] LOG:  checkpoint starting: end-of-recovery immediate wait
2022-11-12 19:05:18.284 IST [10436] LOG:  checkpoint complete: wrote 17 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.006 s, sync=0.016 s, total=0.033 s; sync files=14, longest=0.002 s, average=0.002 s; distance=66 kB, estimate=66 kB
2022-11-12 19:05:18.326 IST [13328] LOG:  database system is ready to accept connections
2022-11-12 19:05:32.941 IST [13328] LOG:  received fast shutdown request
2022-11-12 19:05:32.944 IST [13328] LOG:  aborting any active transactions
2022-11-12 19:05:32.945 IST [10664] FATAL:  terminating connection due to administrator command
2022-11-12 19:05:32.955 IST [13328] LOG:  background worker "logical replication launcher" (PID 15292) exited with exit code 1
2022-11-12 19:05:32.967 IST [10436] LOG:  shutting down
2022-11-12 19:05:32.970 IST [10436] LOG:  checkpoint starting: shutdown immediate
2022-11-12 19:05:32.987 IST [10436] LOG:  checkpoint complete: wrote 2 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.003 s, total=0.020 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=59 kB
2022-11-12 19:05:33.016 IST [13328] LOG:  database system is shut down
2022-11-12 19:05:33.511 IST [17268] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 19:05:33.525 IST [17268] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 19:05:33.531 IST [17268] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 19:05:33.640 IST [19216] LOG:  database system was shut down at 2022-11-12 19:05:32 IST
2022-11-12 19:05:33.709 IST [17268] LOG:  database system is ready to accept connections
2022-11-12 19:05:52.717 IST [15788] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 19:05:52.717 IST [15788] STATEMENT:  
	create extension plpython3u
2022-11-12 19:08:56.003 IST [15788] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 19:08:56.003 IST [15788] STATEMENT:  
	create extension plpython3u
2022-11-12 19:09:00.501 IST [17204] ERROR:  canceling statement due to user request
2022-11-12 19:09:00.503 IST [17268] LOG:  received fast shutdown request
2022-11-12 19:09:00.507 IST [17268] LOG:  aborting any active transactions
2022-11-12 19:09:00.508 IST [15788] FATAL:  terminating connection due to administrator command
2022-11-12 19:09:00.509 IST [2188] FATAL:  terminating connection due to administrator command
2022-11-12 19:09:00.509 IST [5756] FATAL:  terminating connection due to administrator command
2022-11-12 19:09:00.525 IST [17268] LOG:  background worker "logical replication launcher" (PID 17204) exited with exit code 1
2022-11-12 19:09:00.545 IST [14620] LOG:  shutting down
2022-11-12 19:09:00.548 IST [14620] LOG:  checkpoint starting: shutdown immediate
2022-11-12 19:09:00.586 IST [14620] LOG:  checkpoint complete: wrote 16 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.006 s, sync=0.018 s, total=0.041 s; sync files=13, longest=0.002 s, average=0.002 s; distance=53 kB, estimate=53 kB
2022-11-12 19:09:00.638 IST [17268] LOG:  database system is shut down
2022-11-12 19:09:02.227 IST [17592] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-12 19:09:02.238 IST [17592] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 19:09:02.245 IST [17592] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 19:09:02.333 IST [18520] LOG:  database system was shut down at 2022-11-12 19:09:00 IST
2022-11-12 19:09:02.374 IST [17592] LOG:  database system is ready to accept connections
2022-11-12 19:09:06.586 IST [14412] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-15.0-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-11-12 19:09:06.586 IST [14412] STATEMENT:  create extension plpython3u
2022-11-12 19:12:32.007 IST [14704] ERROR:  canceling statement due to user request
2022-11-12 19:12:32.008 IST [17592] LOG:  received fast shutdown request
2022-11-12 19:12:32.016 IST [17592] LOG:  aborting any active transactions
2022-11-12 19:12:32.016 IST [14412] FATAL:  terminating connection due to administrator command
2022-11-12 19:12:32.017 IST [17372] FATAL:  terminating connection due to administrator command
2022-11-12 19:12:32.017 IST [11576] FATAL:  terminating connection due to administrator command
2022-11-12 19:12:32.036 IST [17592] LOG:  background worker "logical replication launcher" (PID 14704) exited with exit code 1
2022-11-12 19:12:32.051 IST [18972] LOG:  shutting down
2022-11-12 19:12:32.053 IST [18972] LOG:  checkpoint starting: shutdown immediate
2022-11-12 19:12:32.089 IST [18972] LOG:  checkpoint complete: wrote 14 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.006 s, sync=0.017 s, total=0.039 s; sync files=13, longest=0.002 s, average=0.002 s; distance=53 kB, estimate=53 kB
2022-11-12 19:12:32.112 IST [17592] LOG:  database system is shut down
2022-11-12 19:29:52.492 IST [10196] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-12 19:29:52.504 IST [10196] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 19:29:52.510 IST [10196] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 19:29:52.585 IST [9884] LOG:  database system was shut down at 2022-11-12 19:24:11 IST
2022-11-12 19:29:52.717 IST [10196] LOG:  database system is ready to accept connections
2022-11-12 19:30:00.136 IST [19388] ERROR:  relation "bse" does not exist at character 334
2022-11-12 19:30:00.136 IST [19388] STATEMENT:  
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 365
	        )select array_agg(name) as namearr,array_agg(close) as closearr,array_agg(sma200) as smaarr,array_agg(trade_date) as trade_datearr from lmt 
	
	    
2022-11-12 19:32:03.770 IST [19388] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-12 19:32:03.770 IST [19388] STATEMENT:  
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 365
	        )select array_agg(name) as namearr,array_agg(close) as closearr,array_agg(sma200) as smaarr,array_agg(trade_date) as trade_datearr from lmt 
	
	    
2022-11-12 19:32:11.178 IST [3632] ERROR:  canceling statement due to user request
2022-11-12 19:32:11.178 IST [3632] STATEMENT:  insert into bse values('EQ020322.CSV','2022-03-02',530065,'LORDSHOTL   ','XT','Q',7.54,7.90,7.54,7.54,7.54,7.54,6,38,'287.00')
2022-11-12 19:32:11.181 IST [16568] ERROR:  canceling statement due to user request
2022-11-12 19:32:11.183 IST [10196] LOG:  received fast shutdown request
2022-11-12 19:32:11.188 IST [10196] LOG:  aborting any active transactions
2022-11-12 19:32:11.188 IST [3632] FATAL:  terminating connection due to administrator command
2022-11-12 19:32:11.189 IST [19388] FATAL:  terminating connection due to administrator command
2022-11-12 19:32:11.190 IST [4880] FATAL:  terminating connection due to administrator command
2022-11-12 19:32:11.239 IST [10196] LOG:  background worker "logical replication launcher" (PID 16568) exited with exit code 1
2022-11-12 19:32:11.253 IST [17520] LOG:  shutting down
2022-11-12 19:32:11.868 IST [10196] LOG:  database system is shut down
2022-11-12 19:32:14.002 IST [18556] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-12 19:32:14.026 IST [18556] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 19:32:14.034 IST [18556] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 19:32:14.151 IST [4104] LOG:  database system was shut down at 2022-11-12 19:32:11 IST
2022-11-12 19:32:14.362 IST [18556] LOG:  database system is ready to accept connections
2022-11-12 19:33:31.565 IST [20256] ERROR:  conflicting or redundant options at character 581
2022-11-12 19:33:31.565 IST [20256] STATEMENT:  CREATE OR replace FUNCTION matplotlib_simplelinechart (name text[],close NUMERIC[],sma200 NUMERIC[],trade_date DATE[]) 
	 
	 RETURNS bytea
	 LANGUAGE plpython3u
	AS $$
	import matplotlib.pyplot as plt
	from io import BytesIO
	plt.style.use('_mpl-gallery')
	
	f1, ax = plt.subplots(figsize = (10,5), layout='constrained')
	ax.plot(trade_date, close,label='close' )
	ax.plot(trade_date, sma200, label='sma200' )
	plt.xlabel('DATE')
	plt.ylabel('Close, SMA200')
	plt.title(name[0])
	plt.legend()
	buffer = BytesIO()
	plt.savefig(buffer, format="png")
	return buffer.getvalue()
	
	$$ LANGUAGE plpython3u
2022-11-12 19:34:15.275 IST [20256] ERROR:  OSError: '_mpl-gallery' not found in the style library and input is not a valid URL or path; see `style.available` for list of available styles
2022-11-12 19:34:15.275 IST [20256] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 4, in <module>
	    plt.style.use('_mpl-gallery')
	  PL/Python function "matplotlib_simplelinechart", line 117, in use
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:34:15.275 IST [20256] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
	
2022-11-12 19:34:53.344 IST [20256] ERROR:  OSError: '_mpl-gallery' not found in the style library and input is not a valid URL or path; see `style.available` for list of available styles
2022-11-12 19:34:53.344 IST [20256] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 4, in <module>
	    plt.style.use('_mpl-gallery')
	  PL/Python function "matplotlib_simplelinechart", line 117, in use
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:34:53.344 IST [20256] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
2022-11-12 19:35:06.586 IST [20256] ERROR:  extension "plpython3u" already exists
2022-11-12 19:35:06.586 IST [20256] STATEMENT:  
	
	create extension plpython3u
2022-11-12 19:35:14.560 IST [20256] ERROR:  TypeError: __init__() got an unexpected keyword argument 'layout'
2022-11-12 19:35:14.560 IST [20256] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 5, in <module>
	    f1, ax = plt.subplots(figsize = (10,5), layout='constrained')
	  PL/Python function "matplotlib_simplelinechart", line 470, in wrapper
	  PL/Python function "matplotlib_simplelinechart", line 1438, in subplots
	  PL/Python function "matplotlib_simplelinechart", line 796, in figure
	  PL/Python function "matplotlib_simplelinechart", line 315, in new_figure_manager
	  PL/Python function "matplotlib_simplelinechart", line 3543, in new_figure_manager
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:35:14.560 IST [20256] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
2022-11-12 19:36:44.816 IST [20256] ERROR:  TypeError: __init__() got an unexpected keyword argument 'layout'
2022-11-12 19:36:44.816 IST [20256] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 10, in <module>
	    plt.figure(figsize=(10, 5), layout='constrained')
	  PL/Python function "matplotlib_simplelinechart", line 796, in figure
	  PL/Python function "matplotlib_simplelinechart", line 315, in new_figure_manager
	  PL/Python function "matplotlib_simplelinechart", line 3543, in new_figure_manager
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:36:44.816 IST [20256] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
2022-11-12 19:38:32.958 IST [20256] ERROR:  TypeError: __init__() got an unexpected keyword argument 'layout'
2022-11-12 19:38:32.958 IST [20256] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 10, in <module>
	    plt.figure(figsize=(10, 5), layout='constrained')
	  PL/Python function "matplotlib_simplelinechart", line 796, in figure
	  PL/Python function "matplotlib_simplelinechart", line 315, in new_figure_manager
	  PL/Python function "matplotlib_simplelinechart", line 3543, in new_figure_manager
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:38:32.958 IST [20256] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
2022-11-12 19:39:29.243 IST [20256] ERROR:  TypeError: __init__() got an unexpected keyword argument 'layout'
2022-11-12 19:39:29.243 IST [20256] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 9, in <module>
	    plt.figure(figsize=(10, 5), layout="constrained")
	  PL/Python function "matplotlib_simplelinechart", line 796, in figure
	  PL/Python function "matplotlib_simplelinechart", line 315, in new_figure_manager
	  PL/Python function "matplotlib_simplelinechart", line 3543, in new_figure_manager
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:39:29.243 IST [20256] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
	
2022-11-12 19:40:04.902 IST [7728] ERROR:  canceling statement due to user request
2022-11-12 19:40:04.903 IST [18556] LOG:  received fast shutdown request
2022-11-12 19:40:04.906 IST [18556] LOG:  aborting any active transactions
2022-11-12 19:40:04.907 IST [20256] FATAL:  terminating connection due to administrator command
2022-11-12 19:40:04.907 IST [14904] FATAL:  terminating connection due to administrator command
2022-11-12 19:40:04.908 IST [4484] FATAL:  terminating connection due to administrator command
2022-11-12 19:40:04.938 IST [18556] LOG:  background worker "logical replication launcher" (PID 7728) exited with exit code 1
2022-11-12 19:40:04.965 IST [7560] LOG:  shutting down
2022-11-12 19:40:05.043 IST [18556] LOG:  database system is shut down
2022-11-12 19:40:06.397 IST [9804] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-12 19:40:06.409 IST [9804] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 19:40:06.415 IST [9804] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 19:40:06.624 IST [16716] LOG:  database system was shut down at 2022-11-12 19:40:04 IST
2022-11-12 19:40:06.769 IST [9804] LOG:  database system is ready to accept connections
2022-11-12 19:40:25.863 IST [19288] ERROR:  TypeError: __init__() got an unexpected keyword argument 'layout'
2022-11-12 19:40:25.863 IST [19288] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 9, in <module>
	    plt.figure(figsize=(10, 5), layout="constrained")
	  PL/Python function "matplotlib_simplelinechart", line 796, in figure
	  PL/Python function "matplotlib_simplelinechart", line 315, in new_figure_manager
	  PL/Python function "matplotlib_simplelinechart", line 3543, in new_figure_manager
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:40:25.863 IST [19288] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
2022-11-12 19:43:00.227 IST [19064] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:43:09.400 IST [18664] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:43:17.186 IST [3336] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:43:50.891 IST [4880] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:43:50.891 IST [4880] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 19:44:08.942 IST [18720] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:44:08.943 IST [18720] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 19:44:37.280 IST [10440] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:45:06.665 IST [20116] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:45:06.665 IST [20116] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 19:45:09.397 IST [7288] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 19:51:27.774 IST [19288] ERROR:  NameError: name 'BytesIO' is not defined
2022-11-12 19:51:27.774 IST [19288] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 7, in <module>
	    buf = BytesIO()
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:51:27.774 IST [19288] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
2022-11-12 19:51:47.177 IST [19288] ERROR:  NameError: name 'base64' is not defined
2022-11-12 19:51:47.177 IST [19288] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 11, in <module>
	    data = base64.b64encode(buf.getbuffer()).decode("ascii")
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:51:47.177 IST [19288] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
	
2022-11-12 19:52:03.657 IST [19288] ERROR:  could not create bytes representation of Python object
2022-11-12 19:52:03.657 IST [19288] DETAIL:  TypeError: cannot convert 'str' object to bytes
2022-11-12 19:52:03.657 IST [19288] CONTEXT:  while creating return value
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 19:52:03.657 IST [19288] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
2022-11-12 19:52:15.622 IST [19288] ERROR:  cannot change return type of existing function
2022-11-12 19:52:15.622 IST [19288] HINT:  Use DROP FUNCTION matplotlib_simplelinechart(text[],numeric[],numeric[],date[]) first.
2022-11-12 19:52:15.622 IST [19288] STATEMENT:  
	CREATE OR replace FUNCTION matplotlib_simplelinechart (name text[],close NUMERIC[],sma200 NUMERIC[],trade_date DATE[]) 
	RETURNS text
	AS $$
	import base64
	from io import BytesIO
	from matplotlib.figure import Figure
	fig = Figure()
	ax = fig.subplots()
	ax.plot([1, 2])
	# Save it to a temporary buffer.
	buf = BytesIO()
	fig.savefig(buf, format="png")
	# Embed the result in the html output.
	data = base64.b64encode(buf.getbuffer()).decode("ascii")
	return data
	$$ LANGUAGE plpython3u
	
2022-11-12 19:52:34.527 IST [19288] ERROR:  syntax error at or near "CREATE" at character 81
2022-11-12 19:52:34.527 IST [19288] STATEMENT:  
	DROP FUNCTION matplotlib_simplelinechart(text[],numeric[],numeric[],date[]) 
	CREATE OR replace FUNCTION matplotlib_simplelinechart (name text[],close NUMERIC[],sma200 NUMERIC[],trade_date DATE[]) 
	RETURNS text
	AS $$
	import base64
	from io import BytesIO
	from matplotlib.figure import Figure
	fig = Figure()
	ax = fig.subplots()
	ax.plot([1, 2])
	# Save it to a temporary buffer.
	buf = BytesIO()
	fig.savefig(buf, format="png")
	# Embed the result in the html output.
	data = base64.b64encode(buf.getbuffer()).decode("ascii")
	return data
	$$ LANGUAGE plpython3u
	
	
2022-11-12 20:07:32.603 IST [13028] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 20:07:32.603 IST [13028] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 20:10:47.503 IST [17136] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 20:10:47.503 IST [17136] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 20:10:57.619 IST [12436] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-12 20:10:57.619 IST [12436] LOG:  unexpected EOF on client connection with an open transaction
2022-11-12 20:13:53.906 IST [20268] ERROR:  canceling statement due to user request
2022-11-12 20:13:53.907 IST [9804] LOG:  received fast shutdown request
2022-11-12 20:13:53.919 IST [9804] LOG:  aborting any active transactions
2022-11-12 20:13:53.919 IST [12296] FATAL:  terminating connection due to administrator command
2022-11-12 20:13:53.920 IST [19288] FATAL:  terminating connection due to administrator command
2022-11-12 20:13:53.920 IST [14708] FATAL:  terminating connection due to administrator command
2022-11-12 20:13:53.936 IST [9804] LOG:  background worker "logical replication launcher" (PID 20268) exited with exit code 1
2022-11-12 20:13:53.968 IST [16996] LOG:  shutting down
2022-11-12 20:13:54.378 IST [9804] LOG:  database system is shut down
2022-11-12 20:14:35.699 IST [1276] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-12 20:14:35.718 IST [1276] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 20:14:35.726 IST [1276] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 20:14:35.810 IST [14356] LOG:  database system was shut down at 2022-11-12 20:13:54 IST
2022-11-12 20:14:35.970 IST [1276] LOG:  database system is ready to accept connections
2022-11-12 21:01:40.897 IST [604] ERROR:  type timestam[] does not exist
2022-11-12 21:01:40.897 IST [604] STATEMENT:  CREATE OR replace FUNCTION matplotlib_simplelinechart (name text[],close NUMERIC[],sma200 NUMERIC[],trade_date TIMESTAM[]) 
	RETURNS text
	AS $$
	import base64
	from io import BytesIO
	from matplotlib.figure import Figure
	fig = Figure()
	ax = fig.subplots()
	ax.plot(trade_date, close, label='linear')
	ax.plot(trade_date, sma200, label='linear')
	# Save it to a temporary buffer.
	buf = BytesIO()
	fig.savefig(buf, format="png")
	# Embed the result in the html output.
	data = base64.b64encode(buf.getbuffer()).decode("ascii")
	return data
	$$ LANGUAGE plpython3u
	
2022-11-12 21:03:55.792 IST [604] ERROR:  function matplotlib_simplelinechart(text[], numeric[], numeric[], date[]) does not exist
2022-11-12 21:03:55.792 IST [604] STATEMENT:  DROP FUNCTION matplotlib_simplelinechart(text[],numeric[],numeric[],date[])
2022-11-12 21:04:39.602 IST [604] ERROR:  TypeError: __init__() got an unexpected keyword argument 'layout'
2022-11-12 21:04:39.602 IST [604] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 10, in <module>
	    plt.figure(figsize=(5, 2.7), layout='constrained')
	  PL/Python function "matplotlib_simplelinechart", line 796, in figure
	  PL/Python function "matplotlib_simplelinechart", line 315, in new_figure_manager
	  PL/Python function "matplotlib_simplelinechart", line 3543, in new_figure_manager
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 21:04:39.602 IST [604] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 2
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
	
2022-11-12 21:09:09.777 IST [1276] LOG:  received fast shutdown request
2022-11-12 21:09:09.778 IST [14044] ERROR:  canceling statement due to user request
2022-11-12 21:09:09.781 IST [1276] LOG:  aborting any active transactions
2022-11-12 21:09:09.782 IST [604] FATAL:  terminating connection due to administrator command
2022-11-12 21:09:09.782 IST [10456] FATAL:  terminating connection due to administrator command
2022-11-12 21:09:09.783 IST [3816] FATAL:  terminating connection due to administrator command
2022-11-12 21:09:09.793 IST [1276] LOG:  background worker "logical replication launcher" (PID 14044) exited with exit code 1
2022-11-12 21:09:09.843 IST [11820] LOG:  shutting down
2022-11-12 21:09:09.923 IST [1276] LOG:  database system is shut down
2022-11-12 21:45:06.596 IST [3288] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-12 21:45:06.610 IST [3288] LOG:  listening on IPv6 address "::1", port 5432
2022-11-12 21:45:06.617 IST [3288] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-12 21:45:06.697 IST [13468] LOG:  database system was shut down at 2022-11-12 21:09:09 IST
2022-11-12 21:45:06.860 IST [3288] LOG:  database system is ready to accept connections
2022-11-12 21:47:49.981 IST [14044] ERROR:  TypeError: __init__() got an unexpected keyword argument 'layout'
2022-11-12 21:47:49.981 IST [14044] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 46, in <module>
	    plt.figure(figsize=(10, 5), layout='constrained')
	  PL/Python function "matplotlib_simplelinechart", line 796, in figure
	  PL/Python function "matplotlib_simplelinechart", line 315, in new_figure_manager
	  PL/Python function "matplotlib_simplelinechart", line 3543, in new_figure_manager
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 21:47:49.981 IST [14044] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
2022-11-12 21:52:36.850 IST [14044] ERROR:  cannot change return type of existing function
2022-11-12 21:52:36.850 IST [14044] HINT:  Use DROP FUNCTION matplotlib_simplelinechart() first.
2022-11-12 21:52:36.850 IST [14044] STATEMENT:  
	CREATE OR replace FUNCTION matplotlib_simplelinechart () 
	RETURNS bytea
	AS $$
	
	sql = '''
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 200
	        )select array_agg(name) as namearr,array_agg(close) as closearr,array_agg(sma200) as smaarr,array_agg(trade_date) as trade_datearr from lmt 
	
	    '''
	
	res = plpy.execute(sql)
	
	name = res[0]['namearr'][0]
	closearr = res[0]['closearr']
	smaarr = res[0]['smaarr']
	tradearr = res[0]['trade_datearr']
	
	#return name
	
	from io import BytesIO
	import matplotlib.pyplot as plt
	# import numpy as np
	plt.rcParams["figure.figsize"] = [7.50, 3.50]
	plt.rcParams["figure.autolayout"] = True
	# x = np.linspace(0, 2, 100)  # Sample data.
	plt.figure(figsize=(10, 5))
	plt.plot(tradearr, closearr, label='close')  # Plot some data on the (implicit) axes.
	plt.plot(tradearr,smaarr, label='sma200')  # etc.
	plt.xlabel('close, sma200')
	plt.ylabel('trade date')
	plt.title(name)
	plt.legend()
	buffer = BytesIO()
	plt.savefig(buffer, format="png")
	return buffer.getvalue()
	
	$$ LANGUAGE plpython3u
2022-11-12 21:53:45.909 IST [14044] ERROR:  TypeError: an integer is required (got type str)
2022-11-12 21:53:45.909 IST [14044] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 39, in <module>
	    tradearr = [datetime(t) for t in tradearr]
	  PL/Python function "matplotlib_simplelinechart", line 39, in <listcomp>
	    tradearr = [datetime(t) for t in tradearr]
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 21:53:45.909 IST [14044] STATEMENT:  
	
	select matplotlib_simplelinechart()
	
	
2022-11-12 21:59:03.792 IST [14044] ERROR:  function matplotlib_simplelinechart(text[], numeric[], numeric[], date[]) does not exist
2022-11-12 21:59:03.792 IST [14044] STATEMENT:  DROP FUNCTION matplotlib_simplelinechart(text[],numeric[],numeric[],date[])
2022-11-12 22:00:14.770 IST [14044] ERROR:  cannot change return type of existing function
2022-11-12 22:00:14.770 IST [14044] HINT:  Use DROP FUNCTION matplotlib_simplelinechart(text[],numeric[],numeric[],date[]) first.
2022-11-12 22:00:14.770 IST [14044] STATEMENT:  CREATE OR replace FUNCTION matplotlib_simplelinechart (name text[],closearr NUMERIC[],smaarr NUMERIC[],tradearr date[]) 
	RETURNS text
	AS $$
	return type(tradearr[0]) + " " + type(closearr[0])
	from io import BytesIO
	
	import matplotlib.pyplot as plt
	# import numpy as np
	plt.rcParams["figure.figsize"] = [7.50, 3.50]
	plt.rcParams["figure.autolayout"] = True
	# x = np.linspace(0, 2, 100)  # Sample data.
	plt.figure(figsize=(10, 5))
	plt.plot(tradearr, closearr, label='close')  # Plot some data on the (implicit) axes.
	plt.plot(tradearr,smaarr, label='sma200')  # etc.
	plt.xlabel('close, sma200')
	plt.ylabel('trade date')
	plt.title(name)
	plt.legend()
	buffer = BytesIO()
	plt.savefig(buffer, format="png")
	return buffer.getvalue()
	$$ LANGUAGE plpython3u
2022-11-12 22:00:28.194 IST [14044] ERROR:  TypeError: unsupported operand type(s) for +: 'type' and 'str'
2022-11-12 22:00:28.194 IST [14044] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "matplotlib_simplelinechart", line 2, in <module>
	    return type(tradearr[0]) + " " + type(closearr[0])
	PL/Python function "matplotlib_simplelinechart"
2022-11-12 22:00:28.194 IST [14044] STATEMENT:  
	WITH test AS(
		SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		
			
	), lmt as(
			
	select close,sma200,trade_date,name
	FROM
		test
	WHERE
		code = 532540
		limit 365
	)select matplotlib_simplelinechart(array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date)) from lmt  
	
	
2022-11-13 02:02:26.136 IST [6320] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 02:02:26.148 IST [6320] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 02:02:26.155 IST [6320] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 02:02:26.258 IST [16744] LOG:  database system was interrupted; last known up at 2022-11-12 22:00:07 IST
2022-11-13 02:02:28.047 IST [16744] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-13 02:02:28.057 IST [16744] LOG:  redo starts at 0/18551C08
2022-11-13 02:02:28.063 IST [16744] LOG:  invalid record length at 0/1855BDF0: wanted 24, got 0
2022-11-13 02:02:28.063 IST [16744] LOG:  redo done at 0/1855BDB8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-13 02:02:28.322 IST [6320] LOG:  database system is ready to accept connections
2022-11-13 02:03:45.812 IST [11792] ERROR:  argument of WHERE must be type boolean, not type date at character 181
2022-11-13 02:03:45.812 IST [11792] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name, AVG(close) OVER(PARTITION BY code ORDER BY trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM BSE WHERE  trade_date ORDER BY trade_date desc ) select * from test limit 200 offset 0
2022-11-13 02:04:10.053 IST [11792] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-13 02:04:10.053 IST [11792] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name, AVG(close) OVER(PARTITION BY code ORDER BY trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM BSE WHERE  code > 1 ORDER BY trade_date desc ) select * from test limit 200 offset 0
2022-11-13 02:04:13.460 IST [4924] ERROR:  canceling statement due to user request
2022-11-13 02:04:13.461 IST [6320] LOG:  received fast shutdown request
2022-11-13 02:04:13.473 IST [6320] LOG:  aborting any active transactions
2022-11-13 02:04:13.473 IST [11792] FATAL:  terminating connection due to administrator command
2022-11-13 02:04:13.474 IST [9888] FATAL:  terminating connection due to administrator command
2022-11-13 02:04:13.484 IST [6320] LOG:  background worker "logical replication launcher" (PID 4924) exited with exit code 1
2022-11-13 02:04:13.500 IST [18048] LOG:  shutting down
2022-11-13 02:04:13.579 IST [6320] LOG:  database system is shut down
2022-11-13 02:04:15.484 IST [1120] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 02:04:15.496 IST [1120] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 02:04:15.502 IST [1120] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 02:04:15.577 IST [2964] LOG:  database system was shut down at 2022-11-13 02:04:13 IST
2022-11-13 02:04:15.780 IST [1120] LOG:  database system is ready to accept connections
2022-11-13 12:45:08.684 IST [12344] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 12:45:08.752 IST [12344] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 12:45:08.780 IST [12344] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 12:45:09.239 IST [12244] LOG:  database system was interrupted; last known up at 2022-11-13 02:28:53 IST
2022-11-13 12:45:11.699 IST [12244] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-13 12:45:11.704 IST [12244] LOG:  redo starts at 0/1855BF50
2022-11-13 12:45:11.704 IST [12244] LOG:  invalid record length at 0/1855C050: wanted 24, got 0
2022-11-13 12:45:11.704 IST [12244] LOG:  redo done at 0/1855C018 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-13 12:45:11.961 IST [12344] LOG:  database system is ready to accept connections
2022-11-13 13:00:46.967 IST [12352] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:00:46.967 IST [12352] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:01:21.738 IST [1616] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:01:21.739 IST [1616] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:01:30.572 IST [7700] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:01:54.863 IST [13804] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:01:54.863 IST [13804] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:02:02.703 IST [6656] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:02:47.566 IST [15028] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:02:47.567 IST [15028] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:03:26.340 IST [5196] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:03:26.341 IST [5196] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:04:19.369 IST [9320] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:04:19.370 IST [9320] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:04:37.530 IST [15352] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:04:37.530 IST [15352] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:26:01.753 IST [2176] ERROR:  syntax error at or near "THEN" at character 71
2022-11-13 13:26:01.753 IST [2176] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name,CASE WHEN  close <   THEN 1000 END close_lt_1000 FROM BSE) select * from test limit 200 offset 0
2022-11-13 13:26:04.187 IST [2176] ERROR:  syntax error at or near "THEN" at character 71
2022-11-13 13:26:04.187 IST [2176] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name,CASE WHEN  close <   THEN 1000 END close_lt_1000 FROM BSE) select * from test limit 200 offset 0
2022-11-13 13:28:00.722 IST [2176] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-13 13:28:00.722 IST [2176] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name,CASE WHEN  close < 1000  THEN close_lt_11000 END close_lt_1000 FROM BSE) select * from test limit 200 offset 0
2022-11-13 13:28:12.183 IST [14240] ERROR:  canceling statement due to user request
2022-11-13 13:28:12.183 IST [12344] LOG:  received fast shutdown request
2022-11-13 13:28:12.189 IST [12344] LOG:  aborting any active transactions
2022-11-13 13:28:12.189 IST [2176] FATAL:  terminating connection due to administrator command
2022-11-13 13:28:12.190 IST [18580] FATAL:  terminating connection due to administrator command
2022-11-13 13:28:12.190 IST [16492] FATAL:  terminating connection due to administrator command
2022-11-13 13:28:12.214 IST [12344] LOG:  background worker "logical replication launcher" (PID 14240) exited with exit code 1
2022-11-13 13:28:12.220 IST [16744] LOG:  shutting down
2022-11-13 13:28:12.322 IST [12344] LOG:  database system is shut down
2022-11-13 13:28:15.245 IST [18904] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 13:28:15.261 IST [18904] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 13:28:15.268 IST [18904] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 13:28:15.356 IST [4192] LOG:  database system was shut down at 2022-11-13 13:28:12 IST
2022-11-13 13:28:15.550 IST [18904] LOG:  database system is ready to accept connections
2022-11-13 13:28:16.973 IST [9928] ERROR:  column "close_lt_11000" does not exist at character 80
2022-11-13 13:28:16.973 IST [9928] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name,CASE WHEN  close < 1000  THEN close_lt_11000 END close_lt_1000 FROM BSE) select * from test limit 200 offset 0
2022-11-13 13:29:08.433 IST [4260] ERROR:  column "close_lt_11000" does not exist at character 95
2022-11-13 13:29:08.433 IST [4260] STATEMENT:  with test as(
	select
		trade_date,
		code,
		close,
		name,
		case
			when close < 1000 then close_lt_11000
		end close_lt_1000
	from
		BSE)
	select
		*
	from
		test
	limit 200 offset 0
2022-11-13 13:29:23.062 IST [4260] ERROR:  column "close_lt_11000" does not exist at character 97
2022-11-13 13:29:23.062 IST [4260] STATEMENT:  
	with test as(
	select
		trade_date,
		code,
		close,
		name,
		case
			when close < 1000 then close_lt_11000
		end 
	from
		BSE)
	select
		*
	from
		test
	limit 200 offset 0
	
2022-11-13 13:30:18.581 IST [9928] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:30:30.637 IST [20004] ERROR:  column "close_lt_11000" does not exist at character 80
2022-11-13 13:30:30.637 IST [20004] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name,CASE WHEN  close < 1000  THEN close_lt_11000 END  FROM BSE) select * from test limit 200 offset 0
2022-11-13 13:30:57.193 IST [20004] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-13 13:30:57.193 IST [20004] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name,CASE WHEN  close < 1000  THEN true END  FROM BSE) select * from test limit 200 offset 0
2022-11-13 13:31:00.514 IST [20276] ERROR:  canceling statement due to user request
2022-11-13 13:31:00.516 IST [18904] LOG:  received fast shutdown request
2022-11-13 13:31:00.520 IST [18904] LOG:  aborting any active transactions
2022-11-13 13:31:00.521 IST [20004] FATAL:  terminating connection due to administrator command
2022-11-13 13:31:00.521 IST [4260] FATAL:  terminating connection due to administrator command
2022-11-13 13:31:00.522 IST [4724] FATAL:  terminating connection due to administrator command
2022-11-13 13:31:00.542 IST [18904] LOG:  background worker "logical replication launcher" (PID 20276) exited with exit code 1
2022-11-13 13:31:00.570 IST [6784] LOG:  shutting down
2022-11-13 13:31:00.651 IST [18904] LOG:  database system is shut down
2022-11-13 13:31:01.978 IST [14168] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 13:31:01.990 IST [14168] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 13:31:01.996 IST [14168] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 13:31:02.068 IST [17204] LOG:  database system was shut down at 2022-11-13 13:31:00 IST
2022-11-13 13:31:02.359 IST [14168] LOG:  database system is ready to accept connections
2022-11-13 13:32:19.419 IST [2756] ERROR:  function matplotlib_simplelinechart() does not exist at character 8
2022-11-13 13:32:19.419 IST [2756] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-11-13 13:32:19.419 IST [2756] STATEMENT:  select matplotlib_simplelinechart()
2022-11-13 13:32:51.896 IST [15500] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:32:51.897 IST [15500] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:33:10.148 IST [17772] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:33:10.148 IST [17772] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 13:57:43.627 IST [2428] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 13:57:43.627 IST [2428] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 14:01:55.955 IST [6064] ERROR:  function high(numeric) does not exist at character 51
2022-11-13 14:01:55.955 IST [6064] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-11-13 14:01:55.955 IST [6064] STATEMENT:  WITH test AS( SELECT  trade_date,code,close,name, HIGH(close) OVER(PARTITION BY code ORDER BY trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as highs, LOW(close) OVER(PARTITION BY code ORDER BY trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as lows,CASE WHEN  code < 600000 and close < 1000  THEN 1 ELSE 0END as ss FROM BSE) select * from test limit 2000 offset 0
2022-11-13 14:03:10.727 IST [6064] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-13 14:03:10.727 IST [6064] STATEMENT:  WITH test AS( SELECT   MAX(close) OVER(PARTITION BY code ORDER BY trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sss FROM BSE) select * from test limit 200 offset 0
2022-11-13 14:03:15.231 IST [16760] ERROR:  canceling statement due to user request
2022-11-13 14:03:15.232 IST [14168] LOG:  received fast shutdown request
2022-11-13 14:03:15.243 IST [14168] LOG:  aborting any active transactions
2022-11-13 14:03:15.244 IST [6064] FATAL:  terminating connection due to administrator command
2022-11-13 14:03:15.244 IST [2756] FATAL:  terminating connection due to administrator command
2022-11-13 14:03:15.245 IST [12740] FATAL:  terminating connection due to administrator command
2022-11-13 14:03:15.258 IST [14168] LOG:  background worker "logical replication launcher" (PID 16760) exited with exit code 1
2022-11-13 14:03:15.277 IST [13660] LOG:  shutting down
2022-11-13 14:03:15.340 IST [14168] LOG:  database system is shut down
2022-11-13 14:03:17.165 IST [2012] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 14:03:17.180 IST [2012] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 14:03:17.187 IST [2012] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 14:03:17.265 IST [15496] LOG:  database system was shut down at 2022-11-13 14:03:15 IST
2022-11-13 14:03:17.375 IST [2012] LOG:  database system is ready to accept connections
2022-11-13 15:37:29.263 IST [7060] ERROR:  syntax error at or near "where" at character 222
2022-11-13 15:37:29.263 IST [7060] STATEMENT:  	SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
		ORDER BY
			trade_date DESC 
		where code = 532540
	
		
2022-11-13 15:38:46.277 IST [7060] ERROR:  syntax error at or near "having" at character 225
2022-11-13 15:38:46.277 IST [7060] STATEMENT:  	SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
			
		ORDER BY
			trade_date desc
		having close > 1000
2022-11-13 15:39:13.389 IST [7060] ERROR:  column "bse.trade_date" must appear in the GROUP BY clause or be used in an aggregate function at character 12
2022-11-13 15:39:13.389 IST [7060] STATEMENT:  	SELECT
			trade_date,
			code,
			CLOSE,
			name,
			AVG(round(CLOSE)) OVER(PARTITION BY code
		ORDER BY
			trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
		FROM
			BSE
			having close > 1000
		ORDER BY
			trade_date desc
2022-11-13 17:01:04.632 IST [18648] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:01:04.633 IST [18648] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 17:01:22.783 IST [20208] ERROR:  canceling statement due to user request
2022-11-13 17:01:22.784 IST [2012] LOG:  received fast shutdown request
2022-11-13 17:01:22.795 IST [2012] LOG:  aborting any active transactions
2022-11-13 17:01:22.796 IST [7060] FATAL:  terminating connection due to administrator command
2022-11-13 17:01:22.796 IST [2236] FATAL:  terminating connection due to administrator command
2022-11-13 17:01:22.797 IST [10112] FATAL:  terminating connection due to administrator command
2022-11-13 17:01:22.801 IST [2012] LOG:  background worker "logical replication launcher" (PID 20208) exited with exit code 1
2022-11-13 17:01:22.821 IST [18752] LOG:  shutting down
2022-11-13 17:01:22.901 IST [2012] LOG:  database system is shut down
2022-11-13 17:01:24.800 IST [19144] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 17:01:24.812 IST [19144] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 17:01:24.818 IST [19144] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 17:01:24.889 IST [17184] LOG:  database system was shut down at 2022-11-13 17:01:22 IST
2022-11-13 17:01:24.995 IST [19144] LOG:  database system is ready to accept connections
2022-11-13 17:03:34.995 IST [2000] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:04:09.729 IST [6316] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:04:16.613 IST [4468] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:04:37.844 IST [11380] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:05:35.359 IST [2128] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:06:02.827 IST [6384] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:11:00.266 IST [6820] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:11:27.824 IST [17864] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:12:20.127 IST [17228] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:12:20.128 IST [17228] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 17:16:05.224 IST [13392] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:16:05.224 IST [13392] LOG:  unexpected EOF on client connection with an open transaction
2022-11-13 17:25:10.276 IST [14556] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:25:43.854 IST [20092] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:26:03.118 IST [6020] ERROR:  canceling statement due to user request
2022-11-13 17:26:03.119 IST [19144] LOG:  received fast shutdown request
2022-11-13 17:26:03.131 IST [19144] LOG:  aborting any active transactions
2022-11-13 17:26:03.133 IST [19336] FATAL:  terminating connection due to administrator command
2022-11-13 17:26:03.133 IST [15684] FATAL:  terminating connection due to administrator command
2022-11-13 17:26:03.138 IST [19144] LOG:  background worker "logical replication launcher" (PID 6020) exited with exit code 1
2022-11-13 17:26:03.155 IST [15188] LOG:  shutting down
2022-11-13 17:26:03.191 IST [19144] LOG:  database system is shut down
2022-11-13 17:26:50.446 IST [11336] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 17:26:50.457 IST [11336] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 17:26:50.463 IST [11336] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 17:26:50.533 IST [15140] LOG:  database system was shut down at 2022-11-13 17:26:03 IST
2022-11-13 17:26:50.637 IST [11336] LOG:  database system is ready to accept connections
2022-11-13 17:27:10.395 IST [980] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 17:28:15.917 IST [2196] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 18:59:47.043 IST [16752] ERROR:  column "select * from test" does not exist at character 64
2022-11-13 18:59:47.043 IST [16752] STATEMENT:  insert into CTE(name,ctejson,ctesql) values('test','{"a":"b"}',"select * from test")
2022-11-13 19:00:40.135 IST [16752] ERROR:  syntax error at or near "insert" at character 81
2022-11-13 19:00:40.135 IST [16752] STATEMENT:  
	
	create table CTE(name text unique,ctejson json, ctesql text,parent text)
	
	insert into CTE(name,ctejson,ctesql) values('test','{"a":"b"}','select * from test')
2022-11-13 19:01:37.924 IST [16752] ERROR:  relation "cte" already exists
2022-11-13 19:01:37.924 IST [16752] STATEMENT:  
	create table CTE(name text unique,ctejson json, ctesql text,parent text)
2022-11-13 19:02:01.827 IST [16752] ERROR:  duplicate key value violates unique constraint "cte_name_key"
2022-11-13 19:02:01.827 IST [16752] DETAIL:  Key (name)=(test) already exists.
2022-11-13 19:02:01.827 IST [16752] STATEMENT:  
	insert into CTE(name,ctejson,ctesql) values('test','{"a":"b"}','select * from test')
2022-11-13 19:17:20.506 IST [13872] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:31:35.895 IST [16772] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:32:04.568 IST [19968] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:32:27.391 IST [13032] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:32:32.132 IST [2996] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:32:45.104 IST [18200] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:34:04.585 IST [16292] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:34:25.832 IST [15372] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:34:52.150 IST [18244] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:35:16.535 IST [16440] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:35:41.840 IST [2176] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:36:06.234 IST [2616] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:36:09.908 IST [18292] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:54:45.479 IST [17688] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:55:00.442 IST [172] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:55:03.149 IST [7976] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:56:51.963 IST [2556] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:57:48.794 IST [16752] ERROR:  operator does not exist: json = unknown at character 52
2022-11-13 23:57:48.794 IST [16752] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2022-11-13 23:57:48.794 IST [16752] STATEMENT:  DELETE FROM public.cte
		WHERE "name"=$1 AND ctejson=$2 AND ctesql=$3
2022-11-13 23:58:21.226 IST [18052] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:59:19.550 IST [16128] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:59:28.437 IST [15176] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:59:41.508 IST [3536] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-13 23:59:50.223 IST [2756] ERROR:  canceling statement due to user request
2022-11-13 23:59:50.224 IST [11336] LOG:  received fast shutdown request
2022-11-13 23:59:50.236 IST [11336] LOG:  aborting any active transactions
2022-11-13 23:59:50.237 IST [16920] FATAL:  terminating connection due to administrator command
2022-11-13 23:59:50.237 IST [16752] FATAL:  terminating connection due to administrator command
2022-11-13 23:59:50.238 IST [20344] FATAL:  terminating connection due to administrator command
2022-11-13 23:59:50.238 IST [11336] LOG:  background worker "logical replication launcher" (PID 2756) exited with exit code 1
2022-11-13 23:59:50.275 IST [9312] LOG:  shutting down
2022-11-13 23:59:50.366 IST [11336] LOG:  database system is shut down
2022-11-13 23:59:52.561 IST [15464] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-13 23:59:52.574 IST [15464] LOG:  listening on IPv6 address "::1", port 5432
2022-11-13 23:59:52.580 IST [15464] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-13 23:59:52.663 IST [6932] LOG:  database system was shut down at 2022-11-13 23:59:50 IST
2022-11-13 23:59:52.800 IST [15464] LOG:  database system is ready to accept connections
2022-11-14 00:00:42.594 IST [196] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:02:24.237 IST [2556] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:02:37.226 IST [2764] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:02:57.364 IST [17636] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:03:05.227 IST [12216] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:04:05.390 IST [20156] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:08:34.984 IST [13348] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:08:56.307 IST [932] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:13:33.949 IST [12880] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:13:33.949 IST [12880] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 00:14:11.551 IST [10108] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:14:13.618 IST [7208] ERROR:  syntax error at or near "name" at character 89
2022-11-14 00:14:13.618 IST [7208] STATEMENT:  
	        insert into 
	        CTE(name,ctejson,ctesql,parent) 
	        values('test','{'name': 'test', 'from': ['BSE'], 'parent': '', 'cols': [{'name': '', 'type': 'normal'}], 'where': [], 'order': [], 'limit': '200', 'offset': '0'}','
	        create table if not exists CTE(name text,ctejson json, ctesql text,parent text)
	    ','')
	    
2022-11-14 00:14:41.176 IST [7208] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:17:29.412 IST [9888] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:17:29.412 IST [9888] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 00:18:12.401 IST [15340] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:19:51.046 IST [8456] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:19:51.046 IST [8456] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 00:19:58.872 IST [18068] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:20:02.549 IST [7104] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:20:26.865 IST [16060] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:20:30.632 IST [6928] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:25:54.595 IST [16972] ERROR:  operator does not exist: json = unknown at character 52
2022-11-14 00:25:54.595 IST [16972] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2022-11-14 00:25:54.595 IST [16972] STATEMENT:  DELETE FROM public.cte
		WHERE "name"=$1 AND ctejson=$2 AND ctesql=$3
2022-11-14 00:26:09.330 IST [16972] ERROR:  operator does not exist: json = unknown at character 52
2022-11-14 00:26:09.330 IST [16972] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2022-11-14 00:26:09.330 IST [16972] STATEMENT:  DELETE FROM public.cte
		WHERE "name"=$1 AND ctejson=$2 AND ctesql=$3
2022-11-14 00:57:35.107 IST [2732] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:58:07.507 IST [5832] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 00:58:15.035 IST [20400] ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
2022-11-14 00:58:15.035 IST [20400] STATEMENT:  
	        insert into 
	        CTE(name,ctejson,ctesql,parent) 
	        values('test','{"name": "test", "from": ["BSE"], "parent": "", "cols": [{"name": "trade_date", "type": "normal"}, {"name": "code", "type": "normal"}, {"name": "close", "type": "normal"}], "where": [], "order": [], "limit": "200", "offset": "0"}','WITH test AS( SELECT  trade_date,code,close FROM BSE) select * from test limit 200 offset 0','')
	
	        on conflict(name)
	        DO 
	        update set ctejson = '{"name": "test", "from": ["BSE"], "parent": "", "cols": [{"name": "trade_date", "type": "normal"}, {"name": "code", "type": "normal"}, {"name": "close", "type": "normal"}], "where": [], "order": [], "limit": "200", "offset": "0"}', ctesql = 'WITH test AS( SELECT  trade_date,code,close FROM BSE) select * from test limit 200 offset 0', parent =  ''
	    
2022-11-14 00:58:15.164 IST [20400] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 00:58:15.164 IST [20400] STATEMENT:  WITH test AS( SELECT  trade_date,code,close FROM BSE) select * from test limit 200 offset 0
2022-11-14 00:58:15.238 IST [20400] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 00:58:15.238 IST [20400] STATEMENT:  WITH test AS( SELECT  trade_date,code,close FROM BSE) select * from test limit 200 offset 0
2022-11-14 00:58:15.350 IST [20400] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 00:58:15.350 IST [20400] STATEMENT:  WITH test AS( SELECT  trade_date,code,close FROM BSE) select * from test limit 200 offset 0
2022-11-14 00:58:15.517 IST [20400] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 00:58:15.517 IST [20400] STATEMENT:  WITH test AS( SELECT  trade_date,code,close FROM BSE) select * from test limit 200 offset 0
2022-11-14 00:58:27.214 IST [17756] ERROR:  canceling statement due to user request
2022-11-14 00:58:27.216 IST [15464] LOG:  received fast shutdown request
2022-11-14 00:58:27.227 IST [15464] LOG:  aborting any active transactions
2022-11-14 00:58:27.228 IST [20400] FATAL:  terminating connection due to administrator command
2022-11-14 00:58:27.228 IST [16972] FATAL:  terminating connection due to administrator command
2022-11-14 00:58:27.229 IST [20000] FATAL:  terminating connection due to administrator command
2022-11-14 00:58:27.247 IST [15464] LOG:  background worker "logical replication launcher" (PID 17756) exited with exit code 1
2022-11-14 00:58:27.266 IST [9136] LOG:  shutting down
2022-11-14 00:58:27.400 IST [15464] LOG:  database system is shut down
2022-11-14 00:58:28.633 IST [15024] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-14 00:58:28.644 IST [15024] LOG:  listening on IPv6 address "::1", port 5432
2022-11-14 00:58:28.651 IST [15024] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-14 00:58:28.720 IST [19596] LOG:  database system was shut down at 2022-11-14 00:58:27 IST
2022-11-14 00:58:28.890 IST [15024] LOG:  database system is ready to accept connections
2022-11-14 00:58:32.224 IST [15260] ERROR:  there is no unique or exclusion constraint matching the ON CONFLICT specification
2022-11-14 00:58:32.224 IST [15260] STATEMENT:  
	        insert into 
	        CTE(name,ctejson,ctesql,parent) 
	        values('test','{"name": "test", "from": ["BSE"], "parent": "", "cols": [{"name": "trade_date", "type": "normal"}, {"name": "code", "type": "normal"}, {"name": "close", "type": "normal"}], "where": [], "order": [], "limit": "200", "offset": "0"}','WITH test AS( SELECT  trade_date,code,close FROM BSE) select * from test limit 200 offset 0','')
	
	        on conflict(name)
	        DO 
	        update set ctejson = '{"name": "test", "from": ["BSE"], "parent": "", "cols": [{"name": "trade_date", "type": "normal"}, {"name": "code", "type": "normal"}, {"name": "close", "type": "normal"}], "where": [], "order": [], "limit": "200", "offset": "0"}', ctesql = 'WITH test AS( SELECT  trade_date,code,close FROM BSE) select * from test limit 200 offset 0', parent =  ''
	    
2022-11-14 00:58:49.645 IST [15260] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 03:01:22.292 IST [10172] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 03:02:38.815 IST [18088] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 03:07:25.761 IST [11904] ERROR:  NameError: name 'njit' is not defined
2022-11-14 03:07:25.761 IST [11904] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "testspeed", line 6, in <module>
	    @njit
	PL/Python function "testspeed"
2022-11-14 03:07:25.761 IST [11904] STATEMENT:  
	
	select * from testspeed()
2022-11-14 03:08:13.081 IST [11904] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 03:08:13.081 IST [11904] STATEMENT:  
	CREATE OR replace FUNCTION testspeed () 
	RETURNS numeric
	AS $$
	import numpy as np
	import numba
	from numba import jit,njit
	
	@njit
	def monte_carlo_pi(nsamples):
	    acc = 0
	    for i in range(nsamples):
	        x = random.random()
	        y = random.random()
	        if (x ** 2 + y ** 2) < 1.0:
	            acc += 1
	    return 4.0 * acc / nsamples
	
	return monte_carlo(100)
	$$ LANGUAGE plpython3u
2022-11-14 03:08:13.131 IST [11904] ERROR:  NameError: name 'monte_carlo' is not defined
2022-11-14 03:08:13.131 IST [11904] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "testspeed", line 16, in <module>
	    return monte_carlo(100)
	PL/Python function "testspeed"
2022-11-14 03:08:13.131 IST [11904] STATEMENT:  
	
	select * from testspeed()
2022-11-14 03:08:18.406 IST [11904] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 03:08:18.406 IST [11904] STATEMENT:  SELECT x.oid,x.relname,x.relnamespace,x.relkind FROM pg_catalog.pg_class x WHERE x.relkind in('r','v','m') AND x.relname ILIKE $1  ORDER BY x.relname LIMIT 1
2022-11-14 03:08:18.521 IST [11904] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 03:08:18.521 IST [11904] STATEMENT:  SELECT x.oid,x.relname,x.relnamespace,x.relkind FROM pg_catalog.pg_class x WHERE x.relkind in('r','v','m') AND x.relname ILIKE $1  ORDER BY x.relname LIMIT 1
2022-11-14 03:08:18.774 IST [11904] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 03:08:18.774 IST [11904] STATEMENT:  SELECT x.oid,x.relname,x.relnamespace,x.relkind FROM pg_catalog.pg_class x WHERE x.relkind in('r','v','m') AND x.relname ILIKE $1  AND x.relnamespace IN ($2,$3) ORDER BY x.relname LIMIT 10
2022-11-14 03:08:19.877 IST [11904] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 03:08:19.877 IST [11904] STATEMENT:  SELECT x.oid,x.relname,x.relnamespace,x.relkind FROM pg_catalog.pg_class x WHERE x.relkind in('r','v','m') AND x.relname ILIKE $1  AND x.relnamespace IN ($2,$3) ORDER BY x.relname LIMIT 10
2022-11-14 03:08:21.333 IST [11904] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 03:08:21.333 IST [11904] STATEMENT:  
	
	
	CREATE OR replace FUNCTION testspeed () 
	RETURNS numeric
	AS $$
	import numpy as np
	import numba
	from numba import jit,njit
	
	@njit
	def monte_carlo_pi(nsamples):
	    acc = 0
	    for i in range(nsamples):
	        x = random.random()
	        y = random.random()
	        if (x ** 2 + y ** 2) < 1.0:
	            acc += 1
	    return 4.0 * acc / nsamples
	
	return monte_carlo_pi(100)
	$$ LANGUAGE plpython3u
2022-11-14 03:08:22.845 IST [11904] ERROR:  numba.core.errors.TypingError: Failed in nopython mode pipeline (step: nopython frontend)
	[1mNameError: name 'random' is not defined[0m
2022-11-14 03:08:22.845 IST [11904] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "testspeed", line 16, in <module>
	    return monte_carlo_pi(100)
	  PL/Python function "testspeed", line 467, in _compile_for_args
	  PL/Python function "testspeed", line 408, in error_rewrite
	PL/Python function "testspeed"
2022-11-14 03:08:22.845 IST [11904] STATEMENT:  
	
	select * from testspeed()
2022-11-14 03:08:51.972 IST [11904] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 03:08:51.972 IST [11904] STATEMENT:  
	CREATE OR replace FUNCTION testspeed () 
	RETURNS numeric
	AS $$
	import numpy as np
	import numba
	from numba import jit,njit
	import random
	@njit
	def monte_carlo_pi(nsamples):
	    acc = 0
	    for i in range(nsamples):
	        x = random.random()
	        y = random.random()
	        if (x ** 2 + y ** 2) < 1.0:
	            acc += 1
	    return 4.0 * acc / nsamples
	
	return monte_carlo_pi(100)
	$$ LANGUAGE plpython3u
2022-11-14 03:10:38.985 IST [11904] ERROR:  KeyboardInterrupt: 
2022-11-14 03:10:38.985 IST [11904] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "testspeed", line 18, in <module>
	    return monte_carlo_pi(10000000000000000)
	  PL/Python function "testspeed", line 14, in monte_carlo_pi
	    if (x ** 2 + y ** 2) < 1.0:
	PL/Python function "testspeed"
2022-11-14 03:10:38.985 IST [11904] STATEMENT:  
	
	select * from testspeed()
2022-11-14 03:10:38.987 IST [11904] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 03:10:38.987 IST [11904] STATEMENT:  SELECT x.oid,x.relname,x.relnamespace,x.relkind FROM pg_catalog.pg_class x WHERE x.relkind in('r','v','m') AND x.relname ILIKE $1  AND x.relnamespace IN ($2,$3) ORDER BY x.relname LIMIT 10
2022-11-14 03:10:38.987 IST [19296] ERROR:  canceling statement due to user request
2022-11-14 03:10:38.989 IST [15024] LOG:  received fast shutdown request
2022-11-14 03:10:38.996 IST [15024] LOG:  aborting any active transactions
2022-11-14 03:10:38.997 IST [11904] FATAL:  terminating connection due to administrator command
2022-11-14 03:10:38.997 IST [7840] FATAL:  terminating connection due to administrator command
2022-11-14 03:10:38.999 IST [12608] FATAL:  terminating connection due to administrator command
2022-11-14 03:10:39.014 IST [15024] LOG:  background worker "logical replication launcher" (PID 19296) exited with exit code 1
2022-11-14 03:10:39.047 IST [12728] LOG:  shutting down
2022-11-14 03:10:39.140 IST [15024] LOG:  database system is shut down
2022-11-14 03:10:42.329 IST [15680] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-14 03:10:42.341 IST [15680] LOG:  listening on IPv6 address "::1", port 5432
2022-11-14 03:10:42.347 IST [15680] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-14 03:10:42.530 IST [15340] LOG:  database system was shut down at 2022-11-14 03:10:39 IST
2022-11-14 03:10:42.681 IST [15680] LOG:  database system is ready to accept connections
2022-11-14 03:11:12.873 IST [10048] ERROR:  canceling statement due to user request
2022-11-14 03:11:12.874 IST [15680] LOG:  received fast shutdown request
2022-11-14 03:11:12.886 IST [15680] LOG:  aborting any active transactions
2022-11-14 03:11:12.887 IST [4848] FATAL:  terminating connection due to administrator command
2022-11-14 03:11:12.887 IST [6904] FATAL:  terminating connection due to administrator command
2022-11-14 03:11:12.903 IST [15680] LOG:  background worker "logical replication launcher" (PID 10048) exited with exit code 1
2022-11-14 03:11:22.599 IST [13068] FATAL:  the database system is shutting down
2022-11-14 03:11:40.746 IST [18936] FATAL:  the database system is shutting down
2022-11-14 03:11:40.802 IST [12292] FATAL:  the database system is shutting down
2022-11-14 03:11:40.858 IST [3940] FATAL:  the database system is shutting down
2022-11-14 03:11:40.977 IST [7648] FATAL:  the database system is shutting down
2022-11-14 03:11:41.042 IST [17884] FATAL:  the database system is shutting down
2022-11-14 03:12:22.953 IST [15680] LOG:  server process (PID 12628) exited with exit code 1
2022-11-14 03:12:22.953 IST [15680] DETAIL:  Failed process was running: 
	
	select * from testspeed()
2022-11-14 03:12:22.953 IST [15680] LOG:  terminating any other active server processes
2022-11-14 03:12:23.025 IST [14540] FATAL:  the database system is shutting down
2022-11-14 03:12:23.053 IST [15680] LOG:  abnormal database system shutdown
2022-11-14 03:12:23.056 IST [15680] LOG:  database system is shut down
2022-11-14 03:12:23.713 IST [2400] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-14 03:12:23.724 IST [2400] LOG:  listening on IPv6 address "::1", port 5432
2022-11-14 03:12:23.730 IST [2400] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-14 03:12:23.801 IST [1412] LOG:  database system was interrupted; last known up at 2022-11-14 03:10:42 IST
2022-11-14 03:12:24.133 IST [13920] FATAL:  the database system is starting up
2022-11-14 03:12:24.254 IST [2248] FATAL:  the database system is starting up
2022-11-14 03:12:24.315 IST [1344] FATAL:  the database system is starting up
2022-11-14 03:12:25.044 IST [1412] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-14 03:12:25.049 IST [1412] LOG:  redo starts at 0/186894C0
2022-11-14 03:12:25.053 IST [1412] LOG:  invalid record length at 0/18693858: wanted 24, got 0
2022-11-14 03:12:25.053 IST [1412] LOG:  redo done at 0/18693820 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-14 03:12:25.241 IST [2400] LOG:  database system is ready to accept connections
2022-11-14 03:13:17.298 IST [2400] LOG:  server process (PID 10036) exited with exit code 1
2022-11-14 03:13:17.298 IST [2400] DETAIL:  Failed process was running: 
	
	select * from testspeed()
2022-11-14 03:13:17.298 IST [2400] LOG:  terminating any other active server processes
2022-11-14 03:13:17.329 IST [2400] LOG:  all server processes terminated; reinitializing
2022-11-14 03:13:17.396 IST [8132] LOG:  database system was interrupted; last known up at 2022-11-14 03:12:25 IST
2022-11-14 03:13:17.419 IST [9880] FATAL:  the database system is in recovery mode
2022-11-14 03:13:17.549 IST [6396] FATAL:  the database system is in recovery mode
2022-11-14 03:13:17.610 IST [440] FATAL:  the database system is in recovery mode
2022-11-14 03:13:17.670 IST [17596] FATAL:  the database system is in recovery mode
2022-11-14 03:13:17.790 IST [8132] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-14 03:13:17.791 IST [11836] FATAL:  the database system is in recovery mode
2022-11-14 03:13:17.796 IST [8132] LOG:  redo starts at 0/186938D0
2022-11-14 03:13:17.801 IST [8132] LOG:  invalid record length at 0/1869D5D0: wanted 24, got 0
2022-11-14 03:13:17.801 IST [8132] LOG:  redo done at 0/1869D598 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-14 03:13:17.878 IST [1696] FATAL:  the database system is in recovery mode
2022-11-14 03:13:17.960 IST [2400] LOG:  database system is ready to accept connections
2022-11-14 03:13:21.902 IST [18316] ERROR:  canceling statement due to user request
2022-11-14 03:13:21.903 IST [20048] ERROR:  canceling statement due to user request
2022-11-14 03:13:21.907 IST [2400] LOG:  received fast shutdown request
2022-11-14 03:13:21.919 IST [2400] LOG:  aborting any active transactions
2022-11-14 03:13:21.920 IST [2400] LOG:  background worker "logical replication launcher" (PID 18316) exited with exit code 1
2022-11-14 03:13:21.957 IST [10456] LOG:  shutting down
2022-11-14 03:13:22.037 IST [2400] LOG:  database system is shut down
2022-11-14 03:13:23.265 IST [19504] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-14 03:13:23.277 IST [19504] LOG:  listening on IPv6 address "::1", port 5432
2022-11-14 03:13:23.283 IST [19504] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-14 03:13:23.352 IST [18056] LOG:  database system was shut down at 2022-11-14 03:13:21 IST
2022-11-14 03:13:23.519 IST [19504] LOG:  database system is ready to accept connections
2022-11-14 03:24:59.214 IST [8336] FATAL:  terminating connection due to unexpected postmaster exit
2022-11-14 09:52:08.956 IST [13632] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-14 09:52:08.987 IST [13632] LOG:  listening on IPv6 address "::1", port 5432
2022-11-14 09:52:09.052 IST [13632] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-14 09:52:09.211 IST [13376] LOG:  database system was interrupted; last known up at 2022-11-14 03:18:24 IST
2022-11-14 09:52:10.622 IST [13376] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-14 09:52:10.632 IST [13376] LOG:  redo starts at 0/186A49D0
2022-11-14 09:52:10.632 IST [13376] LOG:  invalid record length at 0/186A4AB8: wanted 24, got 0
2022-11-14 09:52:10.632 IST [13376] LOG:  redo done at 0/186A4A80 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-14 09:52:10.858 IST [13632] LOG:  database system is ready to accept connections
2022-11-14 09:52:25.841 IST [13632] LOG:  received fast shutdown request
2022-11-14 09:52:25.845 IST [13632] LOG:  aborting any active transactions
2022-11-14 09:52:25.870 IST [13632] LOG:  background worker "logical replication launcher" (PID 15628) exited with exit code 1
2022-11-14 09:52:25.871 IST [19680] LOG:  shutting down
2022-11-14 09:52:25.966 IST [13632] LOG:  database system is shut down
2022-11-14 09:52:26.901 IST [14380] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-14 09:52:26.941 IST [14380] LOG:  listening on IPv6 address "::1", port 5432
2022-11-14 09:52:26.965 IST [14380] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-14 09:52:27.182 IST [9272] LOG:  database system was shut down at 2022-11-14 09:52:25 IST
2022-11-14 09:52:27.394 IST [14380] LOG:  database system is ready to accept connections
2022-11-14 11:08:16.471 IST [15692] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:09:23.155 IST [9816] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:10:11.647 IST [11492] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:10:28.212 IST [6984] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:10:35.759 IST [8412] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:30:58.718 IST [12560] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:31:41.327 IST [11560] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:37:36.346 IST [1772] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:37:45.244 IST [12768] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 11:38:19.777 IST [14652] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 12:05:32.208 IST [17672] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 12:41:47.109 IST [4488] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 12:45:57.089 IST [2196] ERROR:  NameError: name 'monte_carlo' is not defined
2022-11-14 12:45:57.089 IST [2196] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "testspeed", line 16, in <module>
	    return monte_carlo(100)
	PL/Python function "testspeed"
2022-11-14 12:45:57.089 IST [2196] STATEMENT:  
	
	select * from testspeed()
2022-11-14 12:46:19.886 IST [2196] ERROR:  numba.core.errors.TypingError: Failed in nopython mode pipeline (step: nopython frontend)
	[1mNameError: name 'random' is not defined[0m
2022-11-14 12:46:19.886 IST [2196] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "testspeed", line 16, in <module>
	    return monte_carlo_pi(100)
	  PL/Python function "testspeed", line 467, in _compile_for_args
	  PL/Python function "testspeed", line 408, in error_rewrite
	PL/Python function "testspeed"
2022-11-14 12:46:19.886 IST [2196] STATEMENT:  
	
	select * from testspeed()
2022-11-14 13:10:45.722 IST [10180] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:11:05.293 IST [5212] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:11:35.158 IST [19076] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:12:36.906 IST [12396] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:14:06.214 IST [3700] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:14:17.201 IST [17564] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:15:48.039 IST [8020] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:16:14.742 IST [17772] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:16:16.077 IST [3172] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:16:24.650 IST [15596] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:18:19.784 IST [20172] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:18:46.635 IST [21064] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:18:46.636 IST [21064] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:30:24.689 IST [20496] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:30:24.689 IST [20496] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:31:42.932 IST [20924] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:31:42.932 IST [20924] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:33:19.341 IST [17688] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:33:19.342 IST [17688] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:33:55.937 IST [13340] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:33:55.937 IST [13340] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:34:04.782 IST [4028] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:34:52.490 IST [15084] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:34:52.490 IST [15084] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:35:21.299 IST [21408] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:35:21.300 IST [21408] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:35:35.582 IST [19360] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:35:35.583 IST [19360] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:37:14.454 IST [5068] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:37:14.454 IST [5068] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:37:20.516 IST [4740] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:37:42.131 IST [4916] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:37:42.131 IST [4916] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:38:19.497 IST [2632] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:38:19.497 IST [2632] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:38:29.855 IST [12468] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:38:29.856 IST [12468] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:38:41.068 IST [8708] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:39:54.540 IST [20676] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:39:54.540 IST [20676] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 13:40:04.983 IST [9656] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 13:40:04.984 IST [9656] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 15:51:15.865 IST [18376] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 15:51:15.865 IST [18376] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 18:23:09.290 IST [13192] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:23:09.290 IST [13192] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 18:24:13.290 IST [20976] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:28:29.956 IST [20060] ERROR:  INSERT has more expressions than target columns at character 335
2022-11-14 18:28:29.956 IST [20060] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql) 
	            values('testcte','{"name": "testcte", "parent": "", "from": ["bse"], "cols": [{"name": "close", "type": "normal"}], "where": [], "order": [], "limit": "200", "offset": "0"}','WITH testcte AS( SELECT  close FROM bse) select * from testcte limit 200 offset 0','')
	        
2022-11-14 18:30:36.181 IST [20060] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:30:55.442 IST [21708] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:36:47.839 IST [844] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:38:01.482 IST [20620] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:41:43.989 IST [19888] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:41:59.087 IST [8928] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:42:12.019 IST [19068] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:42:23.959 IST [13660] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:42:33.742 IST [22372] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:43:36.070 IST [21916] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:46:31.324 IST [5264] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:46:33.697 IST [20764] ERROR:  column "bse" does not exist at character 45
2022-11-14 18:46:33.697 IST [20764] STATEMENT:  
	            SELECT * FROM CTE WHERE name = bse
	        
2022-11-14 18:47:57.118 IST [20764] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:49:49.349 IST [22648] ERROR:  column "bse" does not exist at character 45
2022-11-14 18:49:49.349 IST [22648] STATEMENT:  
	            SELECT * FROM CTE WHERE name = bse
	        
2022-11-14 18:50:16.099 IST [22648] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 18:50:16.099 IST [22648] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-11-14 18:50:20.888 IST [15736] ERROR:  canceling statement due to user request
2022-11-14 18:50:20.889 IST [14380] LOG:  received fast shutdown request
2022-11-14 18:50:20.893 IST [14380] LOG:  aborting any active transactions
2022-11-14 18:50:20.894 IST [22648] FATAL:  terminating connection due to administrator command
2022-11-14 18:50:20.894 IST [2196] FATAL:  terminating connection due to administrator command
2022-11-14 18:50:20.897 IST [14380] LOG:  background worker "logical replication launcher" (PID 15736) exited with exit code 1
2022-11-14 18:50:20.898 IST [9136] FATAL:  terminating connection due to administrator command
2022-11-14 18:50:20.955 IST [18980] LOG:  shutting down
2022-11-14 18:50:21.099 IST [14380] LOG:  database system is shut down
2022-11-14 18:50:22.627 IST [3308] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-14 18:50:22.641 IST [3308] LOG:  listening on IPv6 address "::1", port 5432
2022-11-14 18:50:22.647 IST [3308] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-14 18:50:22.734 IST [21804] LOG:  database system was shut down at 2022-11-14 18:50:20 IST
2022-11-14 18:50:22.855 IST [3308] LOG:  database system is ready to accept connections
2022-11-14 18:50:45.176 IST [20836] ERROR:  column "bse" does not exist at character 45
2022-11-14 18:50:45.176 IST [20836] STATEMENT:  
	            SELECT * FROM CTE WHERE name = bse
	        
2022-11-14 18:54:02.166 IST [20836] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-14 18:54:02.166 IST [20836] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-11-14 18:54:05.729 IST [2912] ERROR:  canceling statement due to user request
2022-11-14 18:54:05.730 IST [3308] LOG:  received fast shutdown request
2022-11-14 18:54:05.733 IST [3308] LOG:  aborting any active transactions
2022-11-14 18:54:05.734 IST [20836] FATAL:  terminating connection due to administrator command
2022-11-14 18:54:05.734 IST [21940] FATAL:  terminating connection due to administrator command
2022-11-14 18:54:05.746 IST [3308] LOG:  background worker "logical replication launcher" (PID 2912) exited with exit code 1
2022-11-14 18:54:05.764 IST [21660] LOG:  shutting down
2022-11-14 18:54:05.929 IST [3308] LOG:  database system is shut down
2022-11-14 18:54:07.425 IST [21164] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-14 18:54:07.437 IST [21164] LOG:  listening on IPv6 address "::1", port 5432
2022-11-14 18:54:07.444 IST [21164] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-14 18:54:07.531 IST [16244] LOG:  database system was shut down at 2022-11-14 18:54:05 IST
2022-11-14 18:54:07.668 IST [21164] LOG:  database system is ready to accept connections
2022-11-14 18:55:20.852 IST [19984] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 18:56:59.592 IST [10768] ERROR:  column "test" does not exist at character 45
2022-11-14 18:56:59.592 IST [10768] STATEMENT:  
	            SELECT * FROM CTE WHERE name = test
	        
2022-11-14 23:22:55.606 IST [10768] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 23:27:47.538 IST [1432] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 23:27:47.538 IST [1432] LOG:  unexpected EOF on client connection with an open transaction
2022-11-14 23:27:51.792 IST [23532] ERROR:  column "test" does not exist at character 637
2022-11-14 23:27:51.792 IST [23532] STATEMENT:  
	            update cte set ctejson = '[{"name": "test", "parent": "", "from": ["bse"], "cols": [{"name": "close", "type": "normal"}], "where": [], "order": [], "limit": "200", "offset": "0"}, {"name": "test1", "parent": "test", "from": ["test"], "cols": [{"name": "close", "type": "normal"}, {"name": "close_lt_1000", "type": "case", "attributes": {"when": ["close", "lt", "1000", ""], "then": "1", "else": "0"}}], "where": [], "order": [], "limit": "200", "offset": "0"}]', ctesql = ', test1 as ( SELECT  close,CASE WHEN  close < 1000  THEN 1 ELSE 0END as close_lt_1000 FROM test) select * from test1 limit 200 offset 0' where name = test
	        
2022-11-14 23:28:23.202 IST [23532] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 23:30:58.233 IST [19744] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 23:31:48.506 IST [14056] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 23:32:23.331 IST [12900] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 23:34:08.977 IST [22328] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 23:35:46.275 IST [12496] ERROR:  syntax error at or near "(" at character 47
2022-11-14 23:35:46.275 IST [12496] STATEMENT:  WITH test AS( SELECT  code FROM bse, test1 as ( SELECT  code FROM test) select * from test1 limit 200 offset 0
2022-11-14 23:41:21.207 IST [12496] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-14 23:42:20.011 IST [1412] ERROR:  column "code" does not exist at character 62
2022-11-14 23:42:20.011 IST [1412] HINT:  Perhaps you meant to reference the column "test.close".
2022-11-14 23:42:20.011 IST [1412] STATEMENT:  WITH test AS ( SELECT  close FROM bse ) , test1 as ( SELECT  code FROM test WHERE  code > 600000) select * from test1 limit 200 offset 0
2022-11-15 00:17:33.851 IST [1412] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-15 00:17:33.851 IST [1412] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-11-15 00:19:08.501 IST [21104] ERROR:  canceling statement due to user request
2022-11-15 00:19:08.502 IST [21164] LOG:  received fast shutdown request
2022-11-15 00:19:08.514 IST [21164] LOG:  aborting any active transactions
2022-11-15 00:19:08.514 IST [1412] FATAL:  terminating connection due to administrator command
2022-11-15 00:19:08.515 IST [20540] FATAL:  terminating connection due to administrator command
2022-11-15 00:19:08.516 IST [15900] FATAL:  terminating connection due to administrator command
2022-11-15 00:19:08.523 IST [21164] LOG:  background worker "logical replication launcher" (PID 21104) exited with exit code 1
2022-11-15 00:19:08.562 IST [16212] LOG:  shutting down
2022-11-15 00:19:08.651 IST [21164] LOG:  database system is shut down
2022-11-15 00:19:11.137 IST [22344] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 00:19:11.157 IST [22344] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 00:19:11.167 IST [22344] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 00:19:11.345 IST [17300] LOG:  database system was shut down at 2022-11-15 00:19:08 IST
2022-11-15 00:19:11.523 IST [22344] LOG:  database system is ready to accept connections
2022-11-15 00:19:23.817 IST [17208] ERROR:  syntax error at or near ")" at character 27
2022-11-15 00:19:23.817 IST [17208] STATEMENT:  create table cte_temp as  ) , test1 as ( SELECT  code FROM test WHERE  code > 600000) select * from test1 limit 200 offset 0
2022-11-15 00:19:29.180 IST [17208] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-15 00:19:29.180 IST [17208] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-11-15 00:19:56.296 IST [17208] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-15 00:19:56.296 IST [17208] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-11-15 00:20:02.167 IST [12208] ERROR:  canceling statement due to user request
2022-11-15 00:20:02.168 IST [22344] LOG:  received fast shutdown request
2022-11-15 00:20:02.172 IST [22344] LOG:  aborting any active transactions
2022-11-15 00:20:02.173 IST [13912] FATAL:  terminating connection due to administrator command
2022-11-15 00:20:02.173 IST [17208] FATAL:  terminating connection due to administrator command
2022-11-15 00:20:02.173 IST [16372] FATAL:  terminating connection due to administrator command
2022-11-15 00:20:02.194 IST [22344] LOG:  background worker "logical replication launcher" (PID 12208) exited with exit code 1
2022-11-15 00:20:02.225 IST [9060] LOG:  shutting down
2022-11-15 00:20:02.320 IST [22344] LOG:  database system is shut down
2022-11-15 00:20:03.554 IST [4140] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 00:20:03.571 IST [4140] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 00:20:03.579 IST [4140] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 00:20:03.659 IST [1604] LOG:  database system was shut down at 2022-11-15 00:20:02 IST
2022-11-15 00:20:03.832 IST [4140] LOG:  database system is ready to accept connections
2022-11-15 00:23:47.686 IST [18124] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 00:23:47.686 IST [18124] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 00:25:55.065 IST [17100] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 00:26:01.961 IST [21784] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 00:28:41.789 IST [4716] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 00:28:41.789 IST [4716] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 00:42:03.359 IST [23212] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 00:42:03.359 IST [23212] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 00:49:30.215 IST [23280] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 00:49:30.215 IST [23280] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 00:49:35.963 IST [1420] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 00:49:50.930 IST [13484] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 00:49:58.708 IST [13464] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 01:05:40.636 IST [12736] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 01:05:40.636 IST [12736] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 01:10:07.046 IST [596] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 01:10:07.046 IST [596] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 01:10:37.328 IST [14500] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 01:11:37.410 IST [15436] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 01:11:37.410 IST [15436] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 01:13:58.593 IST [19752] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 01:15:38.031 IST [20488] ERROR:  syntax error at or near ")" at character 27
2022-11-15 01:15:38.031 IST [20488] STATEMENT:  create table cte_temp as  ) , test1 as ( SELECT  CASE WHEN  test.close < 1000  THEN 1 ELSE 0END as close_lt_1000 FROM test) select * from test1 limit 200 offset 0
2022-11-15 01:16:13.198 IST [20488] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-15 01:16:13.198 IST [20488] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-11-15 01:16:17.406 IST [11508] ERROR:  canceling statement due to user request
2022-11-15 01:16:17.407 IST [4140] LOG:  received fast shutdown request
2022-11-15 01:16:17.411 IST [4140] LOG:  aborting any active transactions
2022-11-15 01:16:17.412 IST [20488] FATAL:  terminating connection due to administrator command
2022-11-15 01:16:17.412 IST [16188] FATAL:  terminating connection due to administrator command
2022-11-15 01:16:17.413 IST [21296] FATAL:  terminating connection due to administrator command
2022-11-15 01:16:17.414 IST [4140] LOG:  background worker "logical replication launcher" (PID 11508) exited with exit code 1
2022-11-15 01:16:17.449 IST [15512] LOG:  shutting down
2022-11-15 01:16:17.557 IST [4140] LOG:  database system is shut down
2022-11-15 01:16:19.097 IST [19984] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 01:16:19.113 IST [19984] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 01:16:19.120 IST [19984] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 01:16:19.205 IST [21704] LOG:  database system was shut down at 2022-11-15 01:16:17 IST
2022-11-15 01:16:19.290 IST [19984] LOG:  database system is ready to accept connections
2022-11-15 01:16:21.611 IST [18604] ERROR:  syntax error at or near ")" at character 27
2022-11-15 01:16:21.611 IST [18604] STATEMENT:  create table cte_temp as  ) , test1 as ( SELECT  CASE WHEN  test.close < 1000  THEN 1 ELSE 0END as close_lt_1000 FROM test) select * from test1 limit 200 offset 0
2022-11-15 01:27:15.706 IST [21976] ERROR:  canceling statement due to user request
2022-11-15 01:27:15.707 IST [19984] LOG:  received fast shutdown request
2022-11-15 01:27:15.719 IST [19984] LOG:  aborting any active transactions
2022-11-15 01:27:15.720 IST [18604] FATAL:  terminating connection due to administrator command
2022-11-15 01:27:15.720 IST [4048] FATAL:  terminating connection due to administrator command
2022-11-15 01:27:15.735 IST [19984] LOG:  background worker "logical replication launcher" (PID 21976) exited with exit code 1
2022-11-15 01:27:15.755 IST [18116] LOG:  shutting down
2022-11-15 01:27:15.831 IST [19984] LOG:  database system is shut down
2022-11-15 01:27:18.427 IST [11768] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 01:27:18.438 IST [11768] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 01:27:18.445 IST [11768] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 01:27:18.580 IST [19868] LOG:  database system was shut down at 2022-11-15 01:27:15 IST
2022-11-15 01:27:18.756 IST [11768] LOG:  database system is ready to accept connections
2022-11-15 01:27:21.794 IST [1504] ERROR:  syntax error at or near ")" at character 27
2022-11-15 01:27:21.794 IST [1504] STATEMENT:  create table cte_temp as  ) , test1 as ( SELECT  CASE WHEN  test.close < 1000  THEN 1 ELSE 0END as close_lt_1000 FROM test) select * from test1 limit 200 offset 0
2022-11-15 01:29:21.257 IST [1504] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 01:29:25.993 IST [22708] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 01:35:39.578 IST [14380] ERROR:  canceling statement due to user request
2022-11-15 01:35:39.579 IST [11768] LOG:  received fast shutdown request
2022-11-15 01:35:39.591 IST [11768] LOG:  aborting any active transactions
2022-11-15 01:35:39.591 IST [4144] FATAL:  terminating connection due to administrator command
2022-11-15 01:35:39.591 IST [20888] FATAL:  terminating connection due to administrator command
2022-11-15 01:35:39.592 IST [19428] FATAL:  terminating connection due to administrator command
2022-11-15 01:35:39.616 IST [11768] LOG:  background worker "logical replication launcher" (PID 14380) exited with exit code 1
2022-11-15 01:35:39.641 IST [20784] LOG:  shutting down
2022-11-15 01:35:39.740 IST [11768] LOG:  database system is shut down
2022-11-15 10:06:21.057 IST [12904] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 10:06:21.077 IST [12904] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 10:06:21.087 IST [12904] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 10:06:21.203 IST [22928] LOG:  database system was shut down at 2022-11-15 01:35:39 IST
2022-11-15 10:06:21.322 IST [12904] LOG:  database system is ready to accept connections
2022-11-15 10:15:39.351 IST [19520] ERROR:  syntax error at or near "{" at character 712
2022-11-15 10:15:39.351 IST [19520] STATEMENT:  
	
	
	
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        )select array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date),{'a'} from lmt 
	        
	        
2022-11-15 10:16:19.526 IST [19520] ERROR:  syntax error at or near "{" at character 757
2022-11-15 10:16:19.526 IST [19520] STATEMENT:  
	
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        ), agg as (
	        select array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt
	        ) select *,{'a'} from agg
	        
2022-11-15 10:17:18.032 IST [19520] ERROR:  syntax error at or near "{" at character 759
2022-11-15 10:17:18.032 IST [19520] STATEMENT:  
	
	
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        ), agg as (
	        select array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt
	        ) select *,{'a':'b'} as metadata from agg
2022-11-15 10:18:42.005 IST [19520] ERROR:  syntax error at end of input at character 806
2022-11-15 10:18:42.005 IST [19520] STATEMENT:  
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        ), agg as (
	        select '{"foo": [true, "bar"], "tags": {"a": 1, "b": null}}'::json as metadata,array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt
2022-11-15 10:22:29.521 IST [19520] ERROR:  invalid input syntax for type json at character 649
2022-11-15 10:22:29.521 IST [19520] DETAIL:  Token "xcols" is invalid.
2022-11-15 10:22:29.521 IST [19520] CONTEXT:  JSON data, line 1: {xcols...
2022-11-15 10:22:29.521 IST [19520] STATEMENT:  
	
	
	
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        )
	        select '{xcols:{"name":"trade_date","type":"date"}, ycols:{"name":"close","type":"numeric","name":"sma200","type":"numeric"}}'::json as metadata,array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt
	     
2022-11-15 10:23:19.761 IST [19520] ERROR:  invalid input syntax for type json at character 647
2022-11-15 10:23:19.761 IST [19520] DETAIL:  Token "ycols" is invalid.
2022-11-15 10:23:19.761 IST [19520] CONTEXT:  JSON data, line 1: {"xcols":{"name":"trade_date","type":"date"}, ycols...
2022-11-15 10:23:19.761 IST [19520] STATEMENT:  
	
	
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        )
	        select '{"xcols":{"name":"trade_date","type":"date"}, ycols:[{"name":"close","type":"numeric","name":"sma200","type":"numeric"}}]'::json as metadata,array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt
	      
	        
2022-11-15 10:23:31.862 IST [19520] ERROR:  invalid input syntax for type json at character 647
2022-11-15 10:23:31.862 IST [19520] DETAIL:  Token "ycols" is invalid.
2022-11-15 10:23:31.862 IST [19520] CONTEXT:  JSON data, line 1: {"xcols":{"name":"trade_date","type":"date"}, ycols...
2022-11-15 10:23:31.862 IST [19520] STATEMENT:  
	
	
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        )
	        select '{"xcols":{"name":"trade_date","type":"date"}, ycols:[{"name":"close","type":"numeric","name":"sma200","type":"numeric"}}]'::json as metadata,array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt
	      
2022-11-15 10:23:45.794 IST [19520] ERROR:  invalid input syntax for type json at character 647
2022-11-15 10:23:45.794 IST [19520] DETAIL:  Expected "," or "]", but found "}".
2022-11-15 10:23:45.794 IST [19520] CONTEXT:  JSON data, line 1: ...ype":"numeric","name":"sma200","type":"numeric"}}...
2022-11-15 10:23:45.794 IST [19520] STATEMENT:  
	
	
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        )
	        select '{"xcols":{"name":"trade_date","type":"date"}, "ycols":[{"name":"close","type":"numeric","name":"sma200","type":"numeric"}}]'::json as metadata,array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt
	      
	        
2022-11-15 10:24:28.928 IST [19520] ERROR:  invalid input syntax for type json at character 643
2022-11-15 10:24:28.928 IST [19520] DETAIL:  The input string ended unexpectedly.
2022-11-15 10:24:28.928 IST [19520] CONTEXT:  JSON data, line 1: ...e":"numeric"},{"name":"sma200","type":"numeric"}]
2022-11-15 10:24:28.928 IST [19520] STATEMENT:  
	            WITH test AS(
	            SELECT
	                trade_date,
	                code,
	                CLOSE,
	                name,
	                AVG(round(CLOSE)) OVER(PARTITION BY code
	            ORDER BY
	                trade_date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200
	            FROM
	                BSE
	            ORDER BY
	                trade_date DESC 
	            
	                
	        ), lmt as(
	                
	        select close,sma200,trade_date,name
	        FROM
	            test
	        WHERE
	            code = 532540
	            limit 10
	        )
	        select '{"xcols":{"name":"trade_date","type":"date"}, "ycols":[{"name":"close","type":"numeric"},{"name":"sma200","type":"numeric"}]'::json as metadata,array_agg(name),array_agg(close),array_agg(sma200),array_agg(trade_date) from lmt
2022-11-15 14:56:51.486 IST [18620] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 14:56:51.487 IST [18620] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 14:57:28.985 IST [21164] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 14:57:51.382 IST [3024] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 14:58:07.595 IST [1636] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 14:58:23.805 IST [24492] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 15:02:13.951 IST [18436] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 15:02:13.951 IST [18436] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 15:06:34.444 IST [3772] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 15:06:34.444 IST [3772] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 15:10:17.465 IST [18660] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 15:10:17.465 IST [18660] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 15:10:49.356 IST [19312] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 15:10:49.357 IST [19312] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 15:57:42.356 IST [11588] ERROR:  relation "test0" does not exist at character 312
2022-11-15 15:57:42.356 IST [11588] STATEMENT:  WITH test1 AS ( SELECT  bse.code,bse.name,bse.close, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 299 preceding  AND current Row) as sma300 FROM test0,bse WHERE  test0.code = bse.code ORDER BY bse.trade_date desc ) select * from test1 limit 200 offset 0
2022-11-15 16:00:14.669 IST [2976] ERROR:  canceling statement due to user request
2022-11-15 16:00:14.669 IST [12904] LOG:  received fast shutdown request
2022-11-15 16:00:14.673 IST [12904] LOG:  aborting any active transactions
2022-11-15 16:00:14.674 IST [11588] FATAL:  terminating connection due to administrator command
2022-11-15 16:00:14.674 IST [19520] FATAL:  terminating connection due to administrator command
2022-11-15 16:00:14.675 IST [8008] FATAL:  terminating connection due to administrator command
2022-11-15 16:00:14.682 IST [12904] LOG:  background worker "logical replication launcher" (PID 2976) exited with exit code 1
2022-11-15 16:00:14.703 IST [17608] LOG:  shutting down
2022-11-15 16:00:14.773 IST [12904] LOG:  database system is shut down
2022-11-15 16:00:17.757 IST [18592] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 16:00:17.768 IST [18592] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 16:00:17.775 IST [18592] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 16:00:17.856 IST [14032] LOG:  database system was shut down at 2022-11-15 16:00:14 IST
2022-11-15 16:00:17.965 IST [18592] LOG:  database system is ready to accept connections
2022-11-15 16:06:23.637 IST [15464] ERROR:  relation "test0" does not exist at character 200
2022-11-15 16:06:23.637 IST [15464] STATEMENT:  WITH test1 AS ( SELECT  bse.code,bse.name,bse.close,bse.trade_date, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test0,bse WHERE  test0.code = bse.code ORDER BY bse.trade_date desc ) select * from test1 limit 200 offset 0
2022-11-15 16:14:28.055 IST [15464] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-15 16:14:28.055 IST [15464] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-11-15 16:14:32.451 IST [17672] ERROR:  canceling statement due to user request
2022-11-15 16:14:32.452 IST [18592] LOG:  received fast shutdown request
2022-11-15 16:14:32.456 IST [18592] LOG:  aborting any active transactions
2022-11-15 16:14:32.456 IST [21460] FATAL:  terminating connection due to administrator command
2022-11-15 16:14:32.457 IST [15464] FATAL:  terminating connection due to administrator command
2022-11-15 16:14:32.457 IST [12280] FATAL:  terminating connection due to administrator command
2022-11-15 16:14:32.484 IST [18592] LOG:  background worker "logical replication launcher" (PID 17672) exited with exit code 1
2022-11-15 16:14:32.525 IST [16492] LOG:  shutting down
2022-11-15 16:14:32.652 IST [18592] LOG:  database system is shut down
2022-11-15 16:14:33.811 IST [18704] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 16:14:33.824 IST [18704] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 16:14:33.833 IST [18704] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 16:14:33.933 IST [14228] LOG:  database system was shut down at 2022-11-15 16:14:32 IST
2022-11-15 16:14:34.089 IST [18704] LOG:  database system is ready to accept connections
2022-11-15 16:35:01.440 IST [23788] ERROR:  canceling statement due to user request
2022-11-15 16:35:01.441 IST [18704] LOG:  received fast shutdown request
2022-11-15 16:35:01.452 IST [18704] LOG:  aborting any active transactions
2022-11-15 16:35:01.453 IST [4328] FATAL:  terminating connection due to administrator command
2022-11-15 16:35:01.453 IST [1764] FATAL:  terminating connection due to administrator command
2022-11-15 16:35:01.454 IST [12284] FATAL:  terminating connection due to administrator command
2022-11-15 16:35:01.461 IST [18704] LOG:  background worker "logical replication launcher" (PID 23788) exited with exit code 1
2022-11-15 16:35:01.493 IST [15356] LOG:  shutting down
2022-11-15 16:35:01.587 IST [18704] LOG:  database system is shut down
2022-11-15 16:35:31.295 IST [6460] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 16:35:31.306 IST [6460] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 16:35:31.314 IST [6460] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 16:35:31.387 IST [6532] LOG:  database system was shut down at 2022-11-15 16:35:01 IST
2022-11-15 16:35:31.607 IST [6460] LOG:  database system is ready to accept connections
2022-11-15 16:39:18.498 IST [21536] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:39:18.498 IST [21536] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:45:45.387 IST [15156] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:45:45.387 IST [15156] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:46:35.555 IST [23712] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:46:35.555 IST [23712] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:46:47.437 IST [17792] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:47:15.757 IST [18160] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:47:29.807 IST [15884] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:47:29.807 IST [15884] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:47:41.031 IST [11320] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:47:45.794 IST [3920] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:47:58.896 IST [18956] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:47:58.896 IST [18956] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:48:11.082 IST [12076] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:48:11.083 IST [12076] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:48:30.289 IST [9696] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:48:41.252 IST [8352] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:49:19.994 IST [16236] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:49:19.994 IST [16236] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:49:30.890 IST [9772] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:51:35.937 IST [24124] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:51:35.937 IST [24124] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:52:16.747 IST [20940] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:52:40.000 IST [12388] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:52:40.000 IST [12388] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 16:58:59.174 IST [11912] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 16:58:59.174 IST [11912] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 17:18:12.520 IST [22928] ERROR:  syntax error at or near "2022" at character 1687
2022-11-15 17:18:12.520 IST [22928] STATEMENT:  
	            update cte set name = 'test3', ctejson = '[{"parent": "", "name": "test0", "from": ["sensex"], "cols": [{"name": "sensex.code", "type": "normal"}, {"name": "sensex.name", "type": "normal"}], "where": [], "order": [], "limit": "200", "offset": "0"}, {"parent": "test0", "name": "test1", "from": ["test0", "bse"], "cols": [{"name": "bse.code", "type": "normal"}, {"name": "bse.name", "type": "normal"}, {"name": "bse.close", "type": "normal"}, {"name": "bse.trade_date", "type": "normal"}], "where": ["test0.code", "=", "bse.code"], "order": [], "limit": "200", "offset": "0"}, {"parent": "test1", "name": "test2", "from": ["test1"], "cols": [{"name": "test1.code", "type": "normal"}, {"name": "test1.name", "type": "normal"}, {"name": "test1.close", "type": "normal"}, {"name": "test1.trade_date", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "test1.close", "over": {"partition_by": "test1.code", "order_by": "test1.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "199 preceding", "following": "current Row"}}}}], "where": [], "order": ["test1.trade_date", "desc"], "limit": "200", "offset": "0"}, {"parent": "test2", "name": "test3", "from": ["test2"], "cols": [{"name": "test2.code", "type": "normal"}, {"name": "test2.name", "type": "normal"}, {"name": "test2.close", "type": "normal"}, {"name": "test2.trade_date", "type": "normal"}, {"name": "test2.sma200", "type": "normal"}, {"name": "close_lt_sma200", "type": "case", "attributes": {"when": ["test2.close", "lt", "test2.sma200", ""], "then": "1", "else": "0"}}], "where": ["test2.trade_date", "=", "'2022-11-11'"], "order": ["test2.trade_date", "desc"], "limit": "200", "offset": "0"}]', ctesql = 'WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date FROM test0,bse WHERE  test0.code = bse.code ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date, AVG(test1.close) OVER(PARTITION BY test1.code ORDER BY test1.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test1 ORDER BY test1.trade_date desc  ) , test3 as ( SELECT  test2.code,test2.name,test2.close,test2.trade_date,test2.sma200,CASE WHEN  test2.close < test2.sma200  THEN 1 ELSE 0END as close_lt_sma200 FROM test2 WHERE  test2.trade_date = '2022-11-11' ORDER BY test2.trade_date desc ) select * from test3 limit 200 offset 0' where name = 'test2'
	        
2022-11-15 17:19:28.285 IST [22928] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 17:20:10.576 IST [8524] ERROR:  syntax error at or near "2022" at character 1687
2022-11-15 17:20:10.576 IST [8524] STATEMENT:  
	            update cte set name = 'test3', ctejson = '[{"parent": "", "name": "test0", "from": ["sensex"], "cols": [{"name": "sensex.code", "type": "normal"}, {"name": "sensex.name", "type": "normal"}], "where": [], "order": [], "limit": "200", "offset": "0"}, {"parent": "test0", "name": "test1", "from": ["test0", "bse"], "cols": [{"name": "bse.code", "type": "normal"}, {"name": "bse.name", "type": "normal"}, {"name": "bse.close", "type": "normal"}, {"name": "bse.trade_date", "type": "normal"}], "where": ["test0.code", "=", "bse.code"], "order": [], "limit": "200", "offset": "0"}, {"parent": "test1", "name": "test2", "from": ["test1"], "cols": [{"name": "test1.code", "type": "normal"}, {"name": "test1.name", "type": "normal"}, {"name": "test1.close", "type": "normal"}, {"name": "test1.trade_date", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "test1.close", "over": {"partition_by": "test1.code", "order_by": "test1.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "199 preceding", "following": "current Row"}}}}], "where": [], "order": ["test1.trade_date", "desc"], "limit": "200", "offset": "0"}, {"parent": "test2", "name": "test3", "from": ["test2"], "cols": [{"name": "test2.code", "type": "normal"}, {"name": "test2.name", "type": "normal"}, {"name": "test2.close", "type": "normal"}, {"name": "test2.trade_date", "type": "normal"}, {"name": "test2.sma200", "type": "normal"}, {"name": "close_lt_sma200", "type": "case", "attributes": {"when": ["test2.close", "lt", "test2.sma200", ""], "then": "1", "else": "0"}}], "where": ["test2.trade_date", "=", "'2022-11-11'"], "order": ["test2.trade_date", "desc"], "limit": "200", "offset": "0"}]', ctesql = 'WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date FROM test0,bse WHERE  test0.code = bse.code ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date, AVG(test1.close) OVER(PARTITION BY test1.code ORDER BY test1.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test1 ORDER BY test1.trade_date desc  ) , test3 as ( SELECT  test2.code,test2.name,test2.close,test2.trade_date,test2.sma200,CASE WHEN  test2.close < test2.sma200  THEN 1 ELSE 0END as close_lt_sma200 FROM test2 WHERE  test2.trade_date = '2022-11-11' ORDER BY test2.trade_date desc ) select * from test3 limit 200 offset 0' where name = 'test2'
	        
2022-11-15 17:21:06.558 IST [8524] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 17:21:35.052 IST [10716] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 17:21:38.306 IST [12816] ERROR:  syntax error at or near "2022" at character 622
2022-11-15 17:21:38.306 IST [12816] STATEMENT:  WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date FROM test0,bse WHERE  test0.code = bse.code ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date, AVG(test1.close) OVER(PARTITION BY test1.code ORDER BY test1.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test1 ORDER BY test1.trade_date desc  ) , test3 as ( SELECT  test2.code,test2.name,test2.close,test2.trade_date,test2.sma200,CASE WHEN  test2.close < test2.sma200  THEN 1 ELSE 0END as close_lt_sma200 FROM test2 WHERE  test2.trade_date = ''2022-11-11'' ORDER BY test2.trade_date desc ) select * from test3 limit 200 offset 0
2022-11-15 17:22:14.871 IST [12816] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 17:23:04.286 IST [17236] ERROR:  canceling statement due to user request
2022-11-15 17:23:04.287 IST [6460] LOG:  received fast shutdown request
2022-11-15 17:23:04.291 IST [6460] LOG:  aborting any active transactions
2022-11-15 17:23:04.291 IST [24020] FATAL:  terminating connection due to administrator command
2022-11-15 17:23:04.291 IST [23772] FATAL:  terminating connection due to administrator command
2022-11-15 17:23:04.292 IST [20228] FATAL:  terminating connection due to administrator command
2022-11-15 17:23:04.314 IST [6460] LOG:  background worker "logical replication launcher" (PID 17236) exited with exit code 1
2022-11-15 17:23:04.344 IST [18876] LOG:  shutting down
2022-11-15 17:23:04.441 IST [6460] LOG:  database system is shut down
2022-11-15 17:23:06.100 IST [24284] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 17:23:06.111 IST [24284] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 17:23:06.119 IST [24284] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 17:23:06.191 IST [15780] LOG:  database system was shut down at 2022-11-15 17:23:04 IST
2022-11-15 17:23:06.289 IST [24284] LOG:  database system is ready to accept connections
2022-11-15 17:24:11.378 IST [7796] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-15 17:24:11.379 IST [7796] LOG:  unexpected EOF on client connection with an open transaction
2022-11-15 17:25:40.183 IST [20212] ERROR:  canceling statement due to user request
2022-11-15 17:25:40.184 IST [24284] LOG:  received fast shutdown request
2022-11-15 17:25:40.195 IST [24284] LOG:  aborting any active transactions
2022-11-15 17:25:40.196 IST [21004] FATAL:  terminating connection due to administrator command
2022-11-15 17:25:40.196 IST [17028] FATAL:  terminating connection due to administrator command
2022-11-15 17:25:40.197 IST [11312] FATAL:  terminating connection due to administrator command
2022-11-15 17:25:40.212 IST [24284] LOG:  background worker "logical replication launcher" (PID 20212) exited with exit code 1
2022-11-15 17:25:40.233 IST [8008] LOG:  shutting down
2022-11-15 17:25:40.323 IST [24284] LOG:  database system is shut down
2022-11-15 17:26:22.509 IST [8048] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 17:26:22.520 IST [8048] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 17:26:22.528 IST [8048] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 17:26:22.599 IST [5232] LOG:  database system was shut down at 2022-11-15 17:25:40 IST
2022-11-15 17:26:22.710 IST [8048] LOG:  database system is ready to accept connections
2022-11-15 17:36:28.922 IST [20008] ERROR:  operator does not exist: date = integer at character 717
2022-11-15 17:36:28.922 IST [20008] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2022-11-15 17:36:28.922 IST [20008] STATEMENT:  WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test0,bse WHERE  bse.code = test0.code ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date,test1.sma200,CASE WHEN  test1.close < test1.sma200  THEN 1 ELSE 0END as close_lt_sma200 FROM test1 ORDER BY test1.trade_date desc  ) , test3 as ( SELECT  test2.code,test2.name,test2.close,test2.trade_date,test2.sma200,test2.close_lt_sma200 FROM test2,bse,sensex WHERE  test2.close_lt_sma200 = 1 and test2.code = sensex.code and test2.trade_date = 2022-11-11 ORDER BY test2.trade_date desc ) select * from test3 limit 200 offset 0
2022-11-15 17:36:36.998 IST [20008] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-15 17:36:36.998 IST [20008] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2022-11-15 17:37:10.359 IST [20008] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-15 17:37:10.359 IST [20008] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2022-11-15 18:33:00.585 IST [16536] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 18:33:00.607 IST [16536] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 18:33:00.624 IST [16536] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 18:33:00.722 IST [24148] LOG:  database system was interrupted; last known up at 2022-11-15 17:36:28 IST
2022-11-15 18:33:01.089 IST [10772] FATAL:  the database system is starting up
2022-11-15 18:33:03.342 IST [24148] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-15 18:33:03.354 IST [24148] LOG:  redo starts at 0/194145B8
2022-11-15 18:33:03.354 IST [24148] LOG:  invalid record length at 0/194146A0: wanted 24, got 0
2022-11-15 18:33:03.354 IST [24148] LOG:  redo done at 0/19414668 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-15 18:33:03.710 IST [16536] LOG:  database system is ready to accept connections
2022-11-15 18:33:08.153 IST [14756] ERROR:  syntax error at or near "distinct" at character 525
2022-11-15 18:33:08.153 IST [14756] STATEMENT:  with test0 as (
	select
		sensex.code,
		sensex.name
	from
		sensex ) ,
	test1 as (
	select
		bse.code,
		bse.name,
		bse.close,
		bse.trade_date,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200
	from
		test0,
		bse 
		where test0.code = bse.code
		) ,
	test2 as (
	select
		test1.code,
		test1.name,
		test1.close,
		test1.trade_date,
		test1.sma200
	from
		test1
	where
		test1.close < test1.sma200
	order by
		test1.close asc )
	select
		*,distinct(test2.code)
	from
		test2
	limit 200 offset 0
2022-11-15 18:33:16.759 IST [14756] ERROR:  syntax error at or near "distinct" at character 525
2022-11-15 18:33:16.759 IST [14756] STATEMENT:  with test0 as (
	select
		sensex.code,
		sensex.name
	from
		sensex ) ,
	test1 as (
	select
		bse.code,
		bse.name,
		bse.close,
		bse.trade_date,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200
	from
		test0,
		bse 
		where test0.code = bse.code
		) ,
	test2 as (
	select
		test1.code,
		test1.name,
		test1.close,
		test1.trade_date,
		test1.sma200
	from
		test1
	where
		test1.close < test1.sma200
	order by
		test1.close asc )
	select
		*,distinct(test2.code)
	from
		test2
	limit 200 offset 0
2022-11-15 18:33:21.923 IST [16536] LOG:  received fast shutdown request
2022-11-15 18:33:21.928 IST [16536] LOG:  aborting any active transactions
2022-11-15 18:33:21.928 IST [14756] FATAL:  terminating connection due to administrator command
2022-11-15 18:33:21.956 IST [16536] LOG:  background worker "logical replication launcher" (PID 11796) exited with exit code 1
2022-11-15 18:33:21.957 IST [23172] LOG:  shutting down
2022-11-15 18:33:22.018 IST [16536] LOG:  database system is shut down
2022-11-15 18:33:22.528 IST [13232] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-15 18:33:22.539 IST [13232] LOG:  listening on IPv6 address "::1", port 5432
2022-11-15 18:33:22.547 IST [13232] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-15 18:33:22.620 IST [6340] LOG:  database system was shut down at 2022-11-15 18:33:21 IST
2022-11-15 18:33:22.782 IST [13232] LOG:  database system is ready to accept connections
2022-11-15 18:33:27.212 IST [23368] ERROR:  syntax error at or near "distinct" at character 525
2022-11-15 18:33:27.212 IST [23368] STATEMENT:  with test0 as (
	select
		sensex.code,
		sensex.name
	from
		sensex ) ,
	test1 as (
	select
		bse.code,
		bse.name,
		bse.close,
		bse.trade_date,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200
	from
		test0,
		bse 
		where test0.code = bse.code
		) ,
	test2 as (
	select
		test1.code,
		test1.name,
		test1.close,
		test1.trade_date,
		test1.sma200
	from
		test1
	where
		test1.close < test1.sma200
	order by
		test1.close asc )
	select
		*,distinct(test2.code)
	from
		test2
	limit 200 offset 0
2022-11-15 18:33:36.524 IST [21496] ERROR:  syntax error at or near "distinct" at character 525
2022-11-15 18:33:36.524 IST [21496] STATEMENT:  with test0 as (
	select
		sensex.code,
		sensex.name
	from
		sensex ) ,
	test1 as (
	select
		bse.code,
		bse.name,
		bse.close,
		bse.trade_date,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200
	from
		test0,
		bse 
		where test0.code = bse.code
		) ,
	test2 as (
	select
		test1.code,
		test1.name,
		test1.close,
		test1.trade_date,
		test1.sma200
	from
		test1
	where
		test1.close < test1.sma200
	order by
		test1.close asc )
	select
		*,distinct(test2.code)
	from
		test2
	limit 200 offset 0
2022-11-15 22:16:00.062 IST [21496] ERROR:  syntax error at or near "with" at character 475
2022-11-15 22:16:00.062 IST [21496] STATEMENT:  
	 WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test0,bse ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date,test1.sma200 FROM test1 WHERE  test1.close < test1.sma200 ORDER BY test1.close 
	asc ) select * from test2 limit 200 offset 0
	
	with test0 as (
	select
		sensex.code,
		sensex.name
	from
		sensex ) ,
	test1 as (
	select
		bse.code,
		bse.name,
		bse.close,
		bse.trade_date,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200
	from
		test0 left join
		bse 
		on test0.code = bse.code
		
		) ,
	test2 as (
	select
		test1.code,
		test1.name,
		test1.close,
		test1.trade_date,
		test1.sma200
	from
		test1
	where
		test1.close < test1.sma200
	order by
		test1.close asc )
	select
		distinct(code),*
	from
		test2
	limit 200 offset 0
2022-11-15 22:19:04.401 IST [21496] ERROR:  syntax error at or near "with" at character 472
2022-11-15 22:19:04.401 IST [21496] STATEMENT:  WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test0,bse ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date,test1.sma200 FROM test1 WHERE  test1.close < test1.sma200 ORDER BY test1.close 
	asc ) select * from test2 limit 200 offset 0
	
	with test0 as (
	select
		sensex.code,
		sensex.name
	from
		sensex ) ,
	test1 as (
	select
		bse.code,
		bse.name,
		bse.close,
		bse.trade_date,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200
	from
		test0,
		bse 
		where test0.code = bse.code
		) ,
	test2 as (
	select
		test1.code,
		test1.name,
		test1.close,
		test1.trade_date,
		test1.sma200
	from
		test1
	where
		test1.close < test1.sma200
	order by
		test1.close asc )
	select
		distinct(code),*
	from
		test2
	limit 200 offset 0
2022-11-15 22:22:38.150 IST [21496] ERROR:  column reference "code" is ambiguous at character 207
2022-11-15 22:22:38.150 IST [21496] STATEMENT:  
	select *,
	avg(bse.close) over(partition by bse.code
	order by
	bse.trade_date asc rows between 199 preceding and current row) as sma200
	from 
	sensex left join bse 
	on sensex.code = bse.code
	group by code
2022-11-15 22:27:54.395 IST [21496] ERROR:  syntax error at or near ")" at character 301
2022-11-15 22:27:54.395 IST [21496] STATEMENT:  select *,
	avg(bse.close) over(partition by bse.code
	order by
	bse.trade_date asc rows between 199 preceding and current row) as sma200,
	RANK() over(partition by bse.code
	order by bse.trade_date desc) as rank
	from 
	sensex left join bse 
	on sensex.code = bse.code
	order by bse.trade_date desc
	) select * from ranked_cte where rank = 1
2022-11-15 23:52:58.920 IST [21496] ERROR:  syntax error at or near ")" at character 301
2022-11-15 23:52:58.920 IST [21496] STATEMENT:  select *,
	avg(bse.close) over(partition by bse.code
	order by
	bse.trade_date asc rows between 199 preceding and current row) as sma200,
	RANK() over(partition by bse.code
	order by bse.trade_date desc) as rank
	from 
	sensex left join bse 
	on sensex.code = bse.code
	order by bse.trade_date desc
	) select * from ranked_cte where rank = 1
2022-11-15 23:54:17.262 IST [21496] ERROR:  syntax error at or near "as" at character 331
2022-11-15 23:54:17.262 IST [21496] STATEMENT:  
	
	
	with ranked_cte as(
	select *,
	avg(bse.close) over(partition by bse.code
	order by
	bse.trade_date asc rows between 199 preceding and current row) as sma200,
	RANK() over(partition by bse.code
	order by bse.trade_date desc) as rank
	from 
	sensex left join bse 
	on sensex.code = bse.code
	order by bse.trade_date desc
	), as belowsma200 as (
	select * from ranked_cte where rank = 1 where ranked_cte.close < ranked_cte.sma200
2022-11-15 23:54:32.834 IST [21496] ERROR:  syntax error at or near "as" at character 327
2022-11-15 23:54:32.834 IST [21496] STATEMENT:  
	with ranked_cte as(
	select *,
	avg(bse.close) over(partition by bse.code
	order by
	bse.trade_date asc rows between 199 preceding and current row) as sma200,
	RANK() over(partition by bse.code
	order by bse.trade_date desc) as rank
	from 
	sensex left join bse 
	on sensex.code = bse.code
	order by bse.trade_date desc
	), as belowsma200 as (
	select * from ranked_cte where rank = 1 where ranked_cte.close < ranked_cte.sma200
	)select * from belowsma200
2022-11-15 23:54:41.651 IST [21496] ERROR:  syntax error at or near "where" at character 385
2022-11-15 23:54:41.651 IST [21496] STATEMENT:  
	with ranked_cte as(
	select *,
	avg(bse.close) over(partition by bse.code
	order by
	bse.trade_date asc rows between 199 preceding and current row) as sma200,
	RANK() over(partition by bse.code
	order by bse.trade_date desc) as rank
	from 
	sensex left join bse 
	on sensex.code = bse.code
	order by bse.trade_date desc
	), belowsma200 as (
	select * from ranked_cte where rank = 1 where ranked_cte.close < ranked_cte.sma200
	)select * from belowsma200
2022-11-16 00:00:31.495 IST [21496] ERROR:  syntax error at or near "then" at character 732
2022-11-16 00:00:31.495 IST [21496] STATEMENT:  
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 
		     else  ranked_cte.close < ranked_cte.sma300 then 3 
		     else  ranked_cte.close < ranked_cte.sma500 then 5
		end dep
	from
		ranked_cte
	where
		rank = 1	
	)select
		*
	from
		belowsma200
2022-11-16 00:02:30.704 IST [21496] ERROR:  syntax error at or near "case" at character 704
2022-11-16 00:02:30.704 IST [21496] STATEMENT:  
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		*
	from
		belowsma200
2022-11-16 00:02:49.435 IST [21496] ERROR:  syntax error at or near "from" at character 862
2022-11-16 00:02:49.435 IST [21496] STATEMENT:  
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep,
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		*
	from
		belowsma200
2022-11-17 00:00:44.978 IST [14164] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-17 00:00:45.002 IST [14164] LOG:  listening on IPv6 address "::1", port 5432
2022-11-17 00:00:45.011 IST [14164] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-17 00:00:45.204 IST [8460] LOG:  database system was interrupted; last known up at 2022-11-16 00:16:24 IST
2022-11-17 00:00:47.784 IST [21964] FATAL:  the database system is starting up
2022-11-17 00:00:51.047 IST [19544] FATAL:  the database system is starting up
2022-11-17 00:00:52.438 IST [8460] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-17 00:00:52.445 IST [8460] LOG:  redo starts at 0/194290D8
2022-11-17 00:00:52.445 IST [8460] LOG:  invalid record length at 0/194291C0: wanted 24, got 0
2022-11-17 00:00:52.445 IST [8460] LOG:  redo done at 0/19429188 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-17 00:00:52.576 IST [14164] LOG:  database system is ready to accept connections
2022-11-17 00:02:21.324 IST [13944] ERROR:  syntax error at or near "tablea" at character 8
2022-11-17 00:02:21.324 IST [13944] STATEMENT:  insert tablea values((1,a),(2,b))
2022-11-17 00:02:28.593 IST [13944] ERROR:  column "a" does not exist at character 30
2022-11-17 00:02:28.593 IST [13944] STATEMENT:  insert into tablea values((1,a),(2,b))
2022-11-17 00:02:39.424 IST [13944] ERROR:  column "id" is of type integer but expression is of type record at character 27
2022-11-17 00:02:39.424 IST [13944] HINT:  You will need to rewrite or cast the expression.
2022-11-17 00:02:39.424 IST [13944] STATEMENT:  insert into tablea values((1,'a'),(2,'b'))
2022-11-17 00:03:57.775 IST [13944] ERROR:  INSERT has more target columns than expressions at character 23
2022-11-17 00:03:57.775 IST [13944] HINT:  The insertion source is a row expression containing the same number of columns expected by the INSERT. Did you accidentally use extra parentheses?
2022-11-17 00:03:57.775 IST [13944] STATEMENT:  insert into tablea(id,col) values((1,'a'))
2022-11-17 00:05:22.396 IST [13944] ERROR:  syntax error at or near "insert" at character 63
2022-11-17 00:05:22.396 IST [13944] STATEMENT:  
	
	insert into tablea(id,col) values(1,'a'),(2,'b'),(3,'c')
	insert into tableb(id,col) values(1,'d'),(2,'e'),(3,'f')
2022-11-17 00:09:17.479 IST [13944] ERROR:  syntax error at or near "on" at character 29
2022-11-17 00:09:17.479 IST [13944] STATEMENT:  select * from tablea,tableb on tablea.id = tableb.id
2022-11-18 01:57:42.282 IST [5232] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-18 01:57:42.295 IST [5232] LOG:  listening on IPv6 address "::1", port 5432
2022-11-18 01:57:42.302 IST [5232] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-18 01:57:42.501 IST [1672] LOG:  database system was interrupted; last known up at 2022-11-17 00:15:55 IST
2022-11-18 01:57:52.582 IST [1672] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-18 01:57:52.587 IST [1672] LOG:  redo starts at 0/19499EC8
2022-11-18 01:57:52.587 IST [1672] LOG:  invalid record length at 0/19499FB0: wanted 24, got 0
2022-11-18 01:57:52.587 IST [1672] LOG:  redo done at 0/19499F78 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-18 01:57:52.735 IST [5232] LOG:  database system is ready to accept connections
2022-11-18 02:04:50.139 IST [17620] ERROR:  missing FROM-clause entry for table "ranked_cte" at character 989
2022-11-18 02:04:50.139 IST [17620] STATEMENT:  
	
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		*
	from
		belowsma200
		order by sma500dep desc,sma300dep desc,sma200dep desc,ranked_cte.close
2022-11-18 11:35:59.627 IST [11776] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-18 11:35:59.643 IST [11776] LOG:  listening on IPv6 address "::1", port 5432
2022-11-18 11:35:59.652 IST [11776] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-18 11:36:00.046 IST [11980] LOG:  database system was interrupted; last known up at 2022-11-18 02:03:22 IST
2022-11-18 11:36:08.340 IST [11980] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-18 11:36:08.349 IST [11980] LOG:  redo starts at 0/197242A8
2022-11-18 11:36:08.355 IST [11980] LOG:  invalid record length at 0/1972A5D8: wanted 24, got 0
2022-11-18 11:36:08.355 IST [11980] LOG:  redo done at 0/1972A5A0 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-18 11:36:08.556 IST [11776] LOG:  database system is ready to accept connections
2022-11-18 11:37:47.519 IST [17948] ERROR:  syntax error at or near "varchar" at character 146
2022-11-18 11:37:47.519 IST [17948] STATEMENT:  
	-- SQLINES DEMO *** mbol, @start_date, and @end_date to 
	-- SQLINES DEMO *** ulled from a database of time series values
	declare 
	 v_symbol varchar(5) = 'GOOGL'
	
2022-11-18 11:39:02.527 IST [17948] ERROR:  syntax error at or near "varchar" at character 18
2022-11-18 11:39:02.527 IST [17948] STATEMENT:  declare v_symbol varchar(5) = 'GOOGL'
2022-11-18 11:39:14.091 IST [17948] ERROR:  syntax error at or near "varchar" at character 20
2022-11-18 11:39:14.091 IST [17948] STATEMENT:  declare 
	v_symbol varchar(5) = 'GOOGL'
2022-11-18 11:39:25.560 IST [17948] ERROR:  syntax error at or near "text" at character 20
2022-11-18 11:39:25.560 IST [17948] STATEMENT:  declare 
	v_symbol text = 'GOOGL'
2022-11-18 13:58:04.215 IST [17948] ERROR:  syntax error at or near "where" at character 989
2022-11-18 13:58:04.215 IST [17948] STATEMENT:  
	
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		*
	from
		belowsma200
		order by sma500dep desc,sma300dep desc,sma200dep desc where belowsma200.code = 506285
2022-11-18 13:58:18.677 IST [17948] ERROR:  column reference "code" is ambiguous at character 942
2022-11-18 13:58:18.677 IST [17948] STATEMENT:  
	
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		*
	from
		belowsma200
		 where belowsma200.code = 506285
		order by sma500dep desc,sma300dep desc,sma200dep desc
2022-11-18 13:58:44.760 IST [17948] ERROR:  column reference "code" is ambiguous at character 940
2022-11-18 13:58:44.760 IST [17948] STATEMENT:  
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		*
	from
		belowsma200
		 where code = 506285
		order by sma500dep desc,sma300dep desc,sma200dep desc
2022-11-18 13:58:58.903 IST [17948] ERROR:  column reference "code" is ambiguous at character 940
2022-11-18 13:58:58.903 IST [17948] STATEMENT:  
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		*
	from
		belowsma200
		 where belowsma200.code = 506285
		order by sma500dep desc,sma300dep desc,sma200dep desc
2022-11-18 14:00:18.059 IST [17948] ERROR:  column reference "code" is ambiguous at character 913
2022-11-18 14:00:18.059 IST [17948] STATEMENT:  
	
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		*,code as belowsma200_code
	from
		belowsma200
		 
		order by sma500dep desc,sma300dep desc,sma200dep desc
2022-11-18 14:00:56.839 IST [17948] ERROR:  column reference "code" is ambiguous at character 909
2022-11-18 14:00:56.839 IST [17948] STATEMENT:  
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		code, sma500dep ,sma300dep ,sma200dep
	from
		belowsma200
		 
		order by sma500dep desc,sma300dep desc,sma200dep desc
2022-11-18 14:01:15.384 IST [17948] ERROR:  missing FROM-clause entry for table "ranked_cte" at character 909
2022-11-18 14:01:15.384 IST [17948] STATEMENT:  
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		belowsma200.ranked_cte.code, sma500dep ,sma300dep ,sma200dep
	from
		belowsma200
		 
		order by sma500dep desc,sma300dep desc,sma200dep desc
2022-11-18 14:01:30.441 IST [17948] ERROR:  invalid reference to FROM-clause entry for table "ranked_cte" at character 909
2022-11-18 14:01:30.441 IST [17948] HINT:  There is an entry for table "ranked_cte", but it cannot be referenced from this part of the query.
2022-11-18 14:01:30.441 IST [17948] STATEMENT:  
	with ranked_cte as(
	select
		*,
		avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 199 preceding and current row) as sma200,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 299 preceding and current row) as sma300,
	avg(bse.close) over(partition by bse.code
	order by
		bse.trade_date asc rows between 499 preceding and current row) as sma500,
		rank() over(partition by bse.code
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc ),
	belowsma200 as (
	select
		*,
		case when ranked_cte.close < ranked_cte.sma200 then 2 else 0 end sma200dep,
		case when ranked_cte.close < ranked_cte.sma300 then 3 else 0 end sma300dep,
		case when ranked_cte.close < ranked_cte.sma500 then 5 else 0 end sma500dep
	
	from
		ranked_cte
	where
		rank = 1	
	)select
		belowsma200.ranked_cte.code, sma500dep ,sma300dep ,sma200dep
	from
		belowsma200,ranked_cte
		 
		order by sma500dep desc,sma300dep desc,sma200dep desc
2022-11-18 14:01:56.218 IST [17948] ERROR:  column reference "name" is ambiguous at character 882
2022-11-18 14:01:56.218 IST [17948] STATEMENT:  WITH ranked_cte AS (SELECT *, avg(bse.close) OVER (PARTITION BY bse.code ORDER BY bse.trade_date ASC ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200, avg(bse.close) OVER (PARTITION BY bse.code ORDER BY bse.trade_date ASC ROWS BETWEEN 299 PRECEDING AND CURRENT ROW) AS sma300, avg(bse.close) OVER (PARTITION BY bse.code ORDER BY bse.trade_date ASC ROWS BETWEEN 499 PRECEDING AND CURRENT ROW) AS sma500, rank() OVER (PARTITION BY bse.code ORDER BY bse.trade_date DESC) AS rank FROM sensex LEFT JOIN bse ON sensex.code = bse.code ORDER BY bse.trade_date DESC), belowsma200 AS (SELECT *, CASE WHEN ranked_cte.close < ranked_cte.sma200 THEN 2 ELSE 0 END sma200dep, CASE WHEN ranked_cte.close < ranked_cte.sma300 THEN 3 ELSE 0 END sma300dep, CASE WHEN ranked_cte.close < ranked_cte.sma500 THEN 5 ELSE 0 END sma500dep FROM ranked_cte WHERE rank = 1) SELECT * FROM belowsma200 WHERE "name" = 'Bayer CropScience Ltd/India' ORDER BY sma500dep DESC, sma300dep DESC, sma200dep DESC
2022-11-18 14:02:09.591 IST [17948] ERROR:  column reference "name" is ambiguous at character 882
2022-11-18 14:02:09.591 IST [17948] STATEMENT:  WITH ranked_cte AS (SELECT *, avg(bse.close) OVER (PARTITION BY bse.code ORDER BY bse.trade_date ASC ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200, avg(bse.close) OVER (PARTITION BY bse.code ORDER BY bse.trade_date ASC ROWS BETWEEN 299 PRECEDING AND CURRENT ROW) AS sma300, avg(bse.close) OVER (PARTITION BY bse.code ORDER BY bse.trade_date ASC ROWS BETWEEN 499 PRECEDING AND CURRENT ROW) AS sma500, rank() OVER (PARTITION BY bse.code ORDER BY bse.trade_date DESC) AS rank FROM sensex LEFT JOIN bse ON sensex.code = bse.code ORDER BY bse.trade_date DESC), belowsma200 AS (SELECT *, CASE WHEN ranked_cte.close < ranked_cte.sma200 THEN 2 ELSE 0 END sma200dep, CASE WHEN ranked_cte.close < ranked_cte.sma300 THEN 3 ELSE 0 END sma300dep, CASE WHEN ranked_cte.close < ranked_cte.sma500 THEN 5 ELSE 0 END sma500dep FROM ranked_cte WHERE rank = 1) SELECT * FROM belowsma200 WHERE "name" = 'Bayer CropScience Ltd/India' ORDER BY sma500dep DESC, sma300dep DESC, sma200dep DESC
2022-11-18 16:01:43.609 IST [11776] LOG:  server process (PID 15800) was terminated by exception 0x40010004
2022-11-18 16:01:43.609 IST [11776] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-11-18 16:01:43.610 IST [11776] LOG:  terminating any other active server processes
2022-11-18 16:01:43.796 IST [11776] LOG:  all server processes terminated; reinitializing
2022-11-18 16:01:43.963 IST [11776] LOG:  startup process (PID 25144) was terminated by exception 0xC000026B
2022-11-18 16:01:43.963 IST [11776] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-11-18 16:01:43.964 IST [11776] LOG:  aborting startup due to startup process failure
2022-11-18 16:01:43.969 IST [11776] LOG:  database system is shut down
2022-11-22 22:17:04.083 IST [19884] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-22 22:17:04.095 IST [19884] LOG:  listening on IPv6 address "::1", port 5432
2022-11-22 22:17:04.102 IST [19884] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-22 22:17:04.204 IST [17816] LOG:  database system was interrupted; last known up at 2022-11-18 11:36:08 IST
2022-11-22 22:17:13.021 IST [17816] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-22 22:17:13.027 IST [17816] LOG:  redo starts at 0/1972A650
2022-11-22 22:17:13.027 IST [17816] LOG:  invalid record length at 0/1972A688: wanted 24, got 0
2022-11-22 22:17:13.027 IST [17816] LOG:  redo done at 0/1972A650 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-22 22:17:13.132 IST [19884] LOG:  database system is ready to accept connections
2022-11-22 22:17:29.914 IST [3300] ERROR:  syntax error at or near "AS" at character 7
2022-11-22 22:17:29.914 IST [3300] STATEMENT:  WITH  AS ( SELECT  bse.filename FROM bse) select * from  limit 200 offset 0
2022-11-22 22:17:38.272 IST [3300] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-11-22 22:17:38.272 IST [3300] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2022-11-22 22:19:49.976 IST [3300] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-22 22:20:23.601 IST [1420] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-22 22:21:01.196 IST [8456] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-22 22:21:28.451 IST [11416] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-22 22:21:35.241 IST [19760] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-22 22:21:56.530 IST [18560] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-23 12:53:00.259 IST [19884] LOG:  autovacuum launcher process (PID 15928) was terminated by exception 0x40010004
2022-11-23 12:53:00.259 IST [19884] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-11-23 12:53:00.259 IST [19884] LOG:  terminating any other active server processes
2022-11-23 12:53:00.269 IST [19884] LOG:  statistics collector process (PID 14260) was terminated by exception 0x40010004
2022-11-23 12:53:00.269 IST [19884] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-11-23 12:53:00.269 IST [19884] LOG:  all server processes terminated; reinitializing
^C2022-11-25 16:07:41.268 IST [20124] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-25 16:07:41.304 IST [20124] LOG:  listening on IPv6 address "::1", port 5432
2022-11-25 16:07:41.326 IST [20124] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-25 16:07:41.630 IST [7808] LOG:  database system was interrupted; last known up at 2022-11-22 22:57:16 IST
2022-11-25 16:08:03.393 IST [7808] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-25 16:08:03.404 IST [7808] LOG:  redo starts at 0/1977F830
2022-11-25 16:08:03.404 IST [7808] LOG:  invalid record length at 0/1977FA38: wanted 24, got 0
2022-11-25 16:08:03.404 IST [7808] LOG:  redo done at 0/1977FA00 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-25 16:08:03.683 IST [20124] LOG:  database system is ready to accept connections
2022-11-25 17:01:09.472 IST [15820] ERROR:  aggregate functions are not allowed in GROUP BY at character 51
2022-11-25 17:01:09.472 IST [15820] STATEMENT:  
		SELECT date_trunc('week', trade_date),
	       count(*)
	FROM bse
	GROUP BY 2
	ORDER BY 2
2022-11-26 13:18:08.424 IST [12736] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-26 13:18:08.447 IST [12736] LOG:  listening on IPv6 address "::1", port 5432
2022-11-26 13:18:08.469 IST [12736] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-26 13:18:08.589 IST [13152] LOG:  database system was interrupted; last known up at 2022-11-25 16:38:04 IST
2022-11-26 13:18:11.433 IST [13152] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-26 13:18:11.441 IST [13152] LOG:  redo starts at 0/197811D8
2022-11-26 13:18:11.441 IST [13152] LOG:  invalid record length at 0/197812C0: wanted 24, got 0
2022-11-26 13:18:11.441 IST [13152] LOG:  redo done at 0/19781288 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-26 13:18:11.551 IST [12736] LOG:  database system is ready to accept connections
2022-11-26 13:18:13.832 IST [12736] LOG:  received fast shutdown request
2022-11-26 13:18:13.835 IST [12736] LOG:  aborting any active transactions
2022-11-26 13:18:13.865 IST [12736] LOG:  background worker "logical replication launcher" (PID 22728) exited with exit code 1
2022-11-26 13:18:13.866 IST [11640] LOG:  shutting down
2022-11-26 13:18:13.901 IST [12736] LOG:  database system is shut down
2022-11-26 13:18:14.438 IST [21408] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-26 13:18:14.455 IST [21408] LOG:  listening on IPv6 address "::1", port 5432
2022-11-26 13:18:14.461 IST [21408] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-26 13:18:14.534 IST [9764] LOG:  database system was shut down at 2022-11-26 13:18:13 IST
2022-11-26 13:18:14.663 IST [21408] LOG:  database system is ready to accept connections
2022-11-26 13:18:21.680 IST [21408] LOG:  received fast shutdown request
2022-11-26 13:18:21.684 IST [21408] LOG:  aborting any active transactions
2022-11-26 13:18:21.691 IST [21408] LOG:  background worker "logical replication launcher" (PID 20256) exited with exit code 1
2022-11-26 13:18:21.705 IST [17040] LOG:  shutting down
2022-11-26 13:18:21.785 IST [21408] LOG:  database system is shut down
2022-11-26 13:18:22.338 IST [12472] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-26 13:18:22.350 IST [12472] LOG:  listening on IPv6 address "::1", port 5432
2022-11-26 13:18:22.356 IST [12472] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-26 13:18:22.428 IST [16744] LOG:  database system was shut down at 2022-11-26 13:18:21 IST
2022-11-26 13:18:22.509 IST [12472] LOG:  database system is ready to accept connections
2022-11-26 13:18:35.589 IST [5944] ERROR:  canceling statement due to user request
2022-11-26 13:18:35.589 IST [10784] ERROR:  canceling statement due to user request
2022-11-26 13:18:35.590 IST [12472] LOG:  received fast shutdown request
2022-11-26 13:18:35.594 IST [12472] LOG:  aborting any active transactions
2022-11-26 13:18:35.595 IST [2656] FATAL:  terminating connection due to administrator command
2022-11-26 13:18:35.595 IST [4428] FATAL:  terminating connection due to administrator command
2022-11-26 13:18:35.618 IST [12472] LOG:  background worker "logical replication launcher" (PID 5944) exited with exit code 1
2022-11-26 13:18:35.665 IST [20848] LOG:  shutting down
2022-11-26 13:18:35.728 IST [12472] LOG:  database system is shut down
2022-11-26 13:18:42.596 IST [11276] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-26 13:18:42.608 IST [11276] LOG:  listening on IPv6 address "::1", port 5432
2022-11-26 13:18:42.615 IST [11276] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-26 13:18:42.693 IST [11236] LOG:  database system was shut down at 2022-11-26 13:18:35 IST
2022-11-26 13:18:42.867 IST [11276] LOG:  database system is ready to accept connections
2022-11-26 14:13:21.246 IST [19116] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-26 14:13:21.246 IST [19116] LOG:  unexpected EOF on client connection with an open transaction
2022-11-26 14:13:33.862 IST [19944] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-27 00:14:49.122 IST [16492] ERROR:  syntax error at or near "as" at character 71
2022-11-27 00:14:49.122 IST [16492] STATEMENT:  
		
	with ranked_cte as(
	select
		*
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc )
	select top(30) from ranked_cte
2022-11-27 00:15:04.001 IST [16492] ERROR:  syntax error at or near "as" at character 74
2022-11-27 00:15:04.001 IST [16492] STATEMENT:  
		
		
	with ranked_cte as(
	select
		*
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc )
	select * from ranked_cte limit 30
2022-11-27 00:15:16.849 IST [16492] ERROR:  syntax error at or near ")" at character 43
2022-11-27 00:15:16.849 IST [16492] STATEMENT:  select
		*
	order by
		bse.trade_date desc) as rank
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc
2022-11-27 00:16:23.247 IST [16492] ERROR:  syntax error at or near "from" at character 17
2022-11-27 00:16:23.247 IST [16492] STATEMENT:  select
		*,
		
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc
2022-11-27 00:17:53.277 IST [16492] ERROR:  syntax error at or near "lag" at character 14
2022-11-27 00:17:53.277 IST [16492] STATEMENT:  select
		*
		lag(close,250) over(partition by code order by trade_date asc) last_year_val
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc 
2022-11-27 00:18:05.410 IST [16492] ERROR:  column reference "code" is ambiguous at character 48
2022-11-27 00:18:05.410 IST [16492] STATEMENT:  select
		*,
		lag(close,250) over(partition by code order by trade_date asc) last_year_val
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc 
2022-11-27 00:22:05.427 IST [16492] ERROR:  syntax error at or near "as" at character 224
2022-11-27 00:22:05.427 IST [16492] STATEMENT:  with ranked_cte as(
	select
		*,
		close - lag(close,250) over(partition by sensex.code order by trade_date asc) last_year_diff
	from
		sensex
	left join bse on
		sensex.code = bse.code
	order by
		bse.trade_date desc 
	), as top_30(
	
		select * from ranked_cte limit 30
	) select * from top_30 order by last_year_diff
2022-11-27 03:02:15.790 IST [2400] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-27 03:02:15.806 IST [2400] LOG:  listening on IPv6 address "::1", port 5432
2022-11-27 03:02:15.816 IST [2400] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-27 03:02:16.067 IST [23148] LOG:  database system was interrupted; last known up at 2022-11-26 14:55:13 IST
2022-11-27 03:02:19.966 IST [9740] FATAL:  the database system is starting up
2022-11-27 03:02:20.056 IST [11032] FATAL:  the database system is starting up
2022-11-27 03:02:20.248 IST [4960] FATAL:  the database system is starting up
2022-11-27 03:02:20.423 IST [16084] FATAL:  the database system is starting up
2022-11-27 03:02:20.531 IST [20380] FATAL:  the database system is starting up
2022-11-27 03:02:25.126 IST [21580] FATAL:  the database system is starting up
2022-11-27 03:02:25.185 IST [12828] FATAL:  the database system is starting up
2022-11-27 03:02:25.246 IST [8380] FATAL:  the database system is starting up
2022-11-27 03:02:25.382 IST [18208] FATAL:  the database system is starting up
2022-11-27 03:02:25.450 IST [8372] FATAL:  the database system is starting up
2022-11-27 03:02:31.994 IST [23148] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-27 03:02:32.001 IST [23148] LOG:  redo starts at 0/19845B80
2022-11-27 03:02:32.001 IST [23148] LOG:  invalid record length at 0/19846190: wanted 24, got 0
2022-11-27 03:02:32.001 IST [23148] LOG:  redo done at 0/19846158 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-27 03:02:32.167 IST [2400] LOG:  database system is ready to accept connections
2022-11-27 03:15:00.895 IST [2400] LOG:  server process (PID 11320) exited with exit code 1
2022-11-27 03:15:00.895 IST [2400] LOG:  terminating any other active server processes
2022-11-27 03:43:40.892 IST [15288] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-11-27 03:43:40.910 IST [15288] LOG:  listening on IPv6 address "::1", port 5432
2022-11-27 03:43:40.935 IST [15288] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-27 03:43:41.083 IST [23048] LOG:  database system was interrupted; last known up at 2022-11-27 03:13:15 IST
2022-11-27 03:43:41.394 IST [16696] FATAL:  the database system is starting up
2022-11-27 03:43:41.577 IST [18820] FATAL:  the database system is starting up
2022-11-27 03:43:41.757 IST [10320] FATAL:  the database system is starting up
2022-11-27 03:43:46.234 IST [23048] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-27 03:43:46.243 IST [23048] LOG:  redo starts at 0/19BEF3A0
2022-11-27 03:43:46.244 IST [23048] LOG:  invalid record length at 0/19BEF488: wanted 24, got 0
2022-11-27 03:43:46.244 IST [23048] LOG:  redo done at 0/19BEF450 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-27 03:43:46.507 IST [15288] LOG:  database system is ready to accept connections
2022-11-27 03:43:55.157 IST [1876] ERROR:  relation "sensex_index" does not exist at character 143
2022-11-27 03:43:55.157 IST [1876] STATEMENT:  with ranked_cte as(
	select
		*,
		close - lag(close,252) over(partition by sensex_index.code order by trade_date asc) last_year_diff
	from
		sensex_index
	left join bse on
		sensex_index.code = bse.code
	order by
		bse.trade_date desc 
	), top_30 as(
	
		select * from ranked_cte 
	) select * from top_30 where close < 1000 and last_year_diff > 0 order by last_year_diff desc 
2022-11-27 05:32:21.872 IST [15288] LOG:  server process (PID 4756) was terminated by exception 0x40010004
2022-11-27 05:32:21.872 IST [15288] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-11-27 05:32:21.872 IST [15288] LOG:  terminating any other active server processes
2022-12-05 17:22:49.602 IST [1284] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-12-05 17:22:49.612 IST [1284] LOG:  listening on IPv6 address "::1", port 5432
2022-12-05 17:22:49.619 IST [1284] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-05 17:22:49.720 IST [8960] LOG:  database system was interrupted; last known up at 2022-11-27 03:48:47 IST
2022-12-05 17:22:58.524 IST [8960] LOG:  database system was not properly shut down; automatic recovery in progress
2022-12-05 17:22:58.530 IST [8960] LOG:  redo starts at 0/19BFBA48
2022-12-05 17:22:58.530 IST [8960] LOG:  invalid record length at 0/19BFBB30: wanted 24, got 0
2022-12-05 17:22:58.530 IST [8960] LOG:  redo done at 0/19BFBAF8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-12-05 17:22:58.692 IST [1284] LOG:  database system is ready to accept connections
2022-12-05 17:23:12.358 IST [21072] ERROR:  relation "sensex" does not exist at character 79
2022-12-05 17:23:12.358 IST [21072] STATEMENT:  create table cte_temp as WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test0,bse WHERE  bse.code = test0.code ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date,test1.sma200,CASE WHEN  test1.close < test1.sma200  THEN 1 ELSE 0END as close_lt_sma200 FROM test1 ORDER BY test1.trade_date desc ) select * from test2 limit 30 offset 0
2022-12-05 17:23:39.374 IST [21072] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-12-05 17:47:08.661 IST [1284] LOG:  server process (PID 15676) was terminated by exception 0xC000013A
2022-12-05 17:47:08.661 IST [1284] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-12-05 17:47:08.661 IST [1284] LOG:  terminating any other active server processes
2022-12-05 17:47:08.705 IST [1284] LOG:  all server processes terminated; reinitializing
2022-12-05 17:47:08.733 IST [1284] LOG:  startup process (PID 12092) was terminated by exception 0xC0000142
2022-12-05 17:47:08.733 IST [1284] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-12-05 17:47:08.733 IST [1284] LOG:  aborting startup due to startup process failure
2022-12-05 17:47:08.735 IST [1284] LOG:  database system is shut down
2022-12-06 01:14:55.431 IST [9168] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-12-06 01:14:55.443 IST [9168] LOG:  listening on IPv6 address "::1", port 5432
2022-12-06 01:14:55.449 IST [9168] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-06 01:14:55.522 IST [11112] LOG:  database system was interrupted; last known up at 2022-12-05 17:22:58 IST
2022-12-06 01:14:55.944 IST [11112] LOG:  database system was not properly shut down; automatic recovery in progress
2022-12-06 01:14:55.954 IST [11112] LOG:  redo starts at 0/19BFBBA8
2022-12-06 01:14:55.954 IST [11112] LOG:  invalid record length at 0/19BFBBE0: wanted 24, got 0
2022-12-06 01:14:55.955 IST [11112] LOG:  redo done at 0/19BFBBA8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-12-06 01:14:56.131 IST [9168] LOG:  database system is ready to accept connections
2022-12-06 11:25:58.894 IST [9156] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-12-06 11:25:58.907 IST [9156] LOG:  listening on IPv6 address "::1", port 5432
2022-12-06 11:25:58.914 IST [9156] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-06 11:25:59.031 IST [19868] LOG:  database system was interrupted; last known up at 2022-12-06 01:14:55 IST
2022-12-06 11:25:59.972 IST [19868] LOG:  database system was not properly shut down; automatic recovery in progress
2022-12-06 11:25:59.980 IST [19868] LOG:  redo starts at 0/19BFBC58
2022-12-06 11:25:59.980 IST [19868] LOG:  invalid record length at 0/19BFBC90: wanted 24, got 0
2022-12-06 11:25:59.980 IST [19868] LOG:  redo done at 0/19BFBC58 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-12-06 11:26:00.094 IST [9156] LOG:  database system is ready to accept connections
2022-12-06 11:26:04.466 IST [15796] ERROR:  relation "sensex" does not exist at character 79
2022-12-06 11:26:04.466 IST [15796] STATEMENT:  create table cte_temp as WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test0,bse WHERE  bse.code = test0.code ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date,test1.sma200,CASE WHEN  test1.close < test1.sma200  THEN 1 ELSE 0END as close_lt_sma200 FROM test1 ORDER BY test1.trade_date desc ) select * from test2 limit 30 offset 0
2022-12-06 13:57:52.127 IST [12340] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-12-06 13:57:52.138 IST [12340] LOG:  listening on IPv6 address "::1", port 5432
2022-12-06 13:57:52.145 IST [12340] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-06 13:57:52.220 IST [1196] LOG:  database system was interrupted; last known up at 2022-12-06 11:26:00 IST
2022-12-06 13:57:53.259 IST [1196] LOG:  database system was not properly shut down; automatic recovery in progress
2022-12-06 13:57:53.265 IST [1196] LOG:  redo starts at 0/19BFBD08
2022-12-06 13:57:53.265 IST [1196] LOG:  invalid record length at 0/19BFBD40: wanted 24, got 0
2022-12-06 13:57:53.265 IST [1196] LOG:  redo done at 0/19BFBD08 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-12-06 13:57:53.374 IST [12340] LOG:  database system is ready to accept connections
2022-12-06 21:51:11.635 IST [12340] LOG:  server process (PID 3160) was terminated by exception 0xC000013A
2022-12-06 21:51:11.635 IST [12340] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-12-06 21:51:11.635 IST [12340] LOG:  terminating any other active server processes
2022-12-06 21:51:11.668 IST [12340] LOG:  all server processes terminated; reinitializing
2022-12-06 21:51:11.693 IST [12340] LOG:  startup process (PID 23520) was terminated by exception 0xC0000142
2022-12-06 21:51:11.693 IST [12340] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-12-06 21:51:11.693 IST [12340] LOG:  aborting startup due to startup process failure
2022-12-06 21:51:11.695 IST [12340] LOG:  database system is shut down
2022-12-16 20:05:14.701 IST [6172] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-12-16 20:05:14.711 IST [6172] LOG:  listening on IPv6 address "::1", port 5432
2022-12-16 20:05:14.716 IST [6172] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-16 20:05:14.763 IST [14920] LOG:  database system was interrupted; last known up at 2022-12-06 14:33:36 IST
2022-12-16 20:05:15.095 IST [14920] LOG:  database system was not properly shut down; automatic recovery in progress
2022-12-16 20:05:15.102 IST [14920] LOG:  redo starts at 0/19FA5AC0
2022-12-16 20:05:15.102 IST [14920] LOG:  invalid record length at 0/19FA5BA8: wanted 24, got 0
2022-12-16 20:05:15.102 IST [14920] LOG:  redo done at 0/19FA5B70 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-12-16 20:05:15.179 IST [6172] LOG:  database system is ready to accept connections
2022-12-16 20:05:29.588 IST [9376] ERROR:  relation "sensex" does not exist at character 79
2022-12-16 20:05:29.588 IST [9376] STATEMENT:  create table cte_temp as WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test0,bse WHERE  bse.code = test0.code ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date,test1.sma200,CASE WHEN  test1.close < test1.sma200  THEN 1 ELSE 0END as close_lt_sma200 FROM test1 ORDER BY test1.trade_date desc ) select * from test2 limit 30 offset 0
2022-12-16 20:08:59.194 IST [9376] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-12-16 20:08:59.194 IST [9376] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-12-16 20:08:59.196 IST [9376] WARNING:  there is no transaction in progress
2022-12-16 20:13:36.979 IST [9376] ERROR:  relation "sensex" does not exist at character 79
2022-12-16 20:13:36.979 IST [9376] STATEMENT:  create table cte_temp as WITH test0 AS ( SELECT  sensex.code,sensex.name FROM sensex ) , test1 as ( SELECT  bse.code,bse.name,bse.close,bse.trade_date, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 199 preceding  AND current Row) as sma200 FROM test0,bse WHERE  bse.code = test0.code ) , test2 as ( SELECT  test1.code,test1.name,test1.close,test1.trade_date,test1.sma200,CASE WHEN  test1.close < test1.sma200  THEN 1 ELSE 0END as close_lt_sma200 FROM test1 ORDER BY test1.trade_date desc ) select * from test2 limit 30 offset 0
2022-12-16 20:20:45.859 IST [9376] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2022-12-16 20:20:45.859 IST [9376] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2022-12-16 20:20:45.864 IST [9376] WARNING:  there is no transaction in progress
2022-12-16 20:41:21.391 IST [10492] ERROR:  canceling statement due to user request
2022-12-16 20:41:21.391 IST [6172] LOG:  received fast shutdown request
2022-12-16 20:41:21.396 IST [6172] LOG:  aborting any active transactions
2022-12-16 20:41:21.396 IST [13276] FATAL:  terminating connection due to administrator command
2022-12-16 20:41:21.396 IST [9376] FATAL:  terminating connection due to administrator command
2022-12-16 20:41:21.397 IST [13984] FATAL:  terminating connection due to administrator command
2022-12-16 20:41:21.413 IST [6172] LOG:  background worker "logical replication launcher" (PID 10492) exited with exit code 1
2022-12-16 20:41:21.432 IST [15036] LOG:  shutting down
2022-12-16 20:41:21.523 IST [6172] LOG:  database system is shut down
2022-12-16 20:41:22.557 IST [6624] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-12-16 20:41:22.565 IST [6624] LOG:  listening on IPv6 address "::1", port 5432
2022-12-16 20:41:22.571 IST [6624] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-16 20:41:22.613 IST [6612] LOG:  database system was shut down at 2022-12-16 20:41:21 IST
2022-12-16 20:41:22.672 IST [6624] LOG:  database system is ready to accept connections
2022-12-16 21:22:02.922 IST [5764] ERROR:  canceling statement due to user request
2022-12-16 21:22:02.922 IST [6624] LOG:  received fast shutdown request
2022-12-16 21:22:02.925 IST [6624] LOG:  aborting any active transactions
2022-12-16 21:22:02.926 IST [7676] FATAL:  terminating connection due to administrator command
2022-12-16 21:22:02.926 IST [10820] FATAL:  terminating connection due to administrator command
2022-12-16 21:22:02.926 IST [6624] LOG:  background worker "logical replication launcher" (PID 5764) exited with exit code 1
2022-12-16 21:22:02.941 IST [6572] LOG:  shutting down
2022-12-16 21:22:03.006 IST [6624] LOG:  database system is shut down
2022-12-19 00:47:03.807 IST [1588] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2022-12-19 00:47:03.816 IST [1588] LOG:  listening on IPv6 address "::1", port 5432
2022-12-19 00:47:03.822 IST [1588] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-12-19 00:47:03.868 IST [10776] LOG:  database system was shut down at 2022-12-16 21:22:02 IST
2022-12-19 00:47:03.948 IST [1588] LOG:  database system is ready to accept connections
2022-12-19 02:25:52.553 IST [1588] LOG:  server process (PID 18044) was terminated by exception 0xC000013A
2022-12-19 02:25:52.553 IST [1588] DETAIL:  Failed process was running: 
	        SELECT column_name, data_type 
	        FROM information_schema.columns
	        WHERE table_name = 'sensex' AND table_schema = 'public';
	    
2022-12-19 02:25:52.553 IST [1588] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-12-19 02:25:52.553 IST [1588] LOG:  terminating any other active server processes
^C2023-01-04 23:09:55.958 IST [18188] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-04 23:09:55.969 IST [18188] LOG:  listening on IPv6 address "::1", port 5432
2023-01-04 23:09:55.976 IST [18188] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-04 23:09:56.061 IST [13892] LOG:  database system was interrupted; last known up at 2022-12-19 02:22:08 IST
2023-01-04 23:09:57.013 IST [13892] LOG:  database system was not properly shut down; automatic recovery in progress
2023-01-04 23:09:57.018 IST [13892] LOG:  redo starts at 0/1A262D18
2023-01-04 23:09:57.018 IST [13892] LOG:  invalid record length at 0/1A264138: wanted 24, got 0
2023-01-04 23:09:57.018 IST [13892] LOG:  redo done at 0/1A264100 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2023-01-04 23:09:57.121 IST [18188] LOG:  database system is ready to accept connections
2023-01-04 23:11:57.934 IST [10252] ERROR:  syntax error at or near ")" at character 100
2023-01-04 23:11:57.934 IST [10252] STATEMENT:  WITH test AS ( SELECT   AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS ) as  FROM sensex,bse) select * from test limit 200 offset 0
2023-01-04 23:12:22.554 IST [10252] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-04 23:12:22.554 IST [10252] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-04 23:12:22.558 IST [10252] WARNING:  there is no transaction in progress
2023-01-04 23:19:19.813 IST [10252] ERROR:  duplicate key value violates unique constraint "cte_name_key"
2023-01-04 23:19:19.813 IST [10252] DETAIL:  Key (name)=(test) already exists.
2023-01-04 23:19:19.813 IST [10252] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('test','[{"parent": "", "name": "test", "from": ["sensex_index", "bse"], "cols": [{"name": "bse.code", "type": "normal"}, {"name": "bse.close", "type": "normal"}, {"name": "bse.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "bse.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.code", "=", "500002"], "order": [], "limit": "2000", "offset": "0"}]','WITH test AS ( SELECT  bse.code,bse.close,bse.name, AVG(bse.close) OVER(PARTITION BY bse.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index,bse WHERE  bse.code = 500002) select * from test limit 2000 offset 0','')
	        
2023-01-04 23:19:37.306 IST [10252] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-04 23:19:37.306 IST [10252] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-04 23:19:37.308 IST [10252] WARNING:  there is no transaction in progress
2023-01-05 00:36:13.390 IST [11316] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 00:36:13.398 IST [11316] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 00:36:13.404 IST [11316] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 00:36:13.457 IST [13936] LOG:  database system was interrupted; last known up at 2023-01-05 00:32:01 IST
2023-01-05 00:36:13.732 IST [13936] LOG:  database system was not properly shut down; automatic recovery in progress
2023-01-05 00:36:13.740 IST [13936] LOG:  redo starts at 0/1AE4E210
2023-01-05 00:36:13.778 IST [13936] LOG:  invalid record length at 0/1B71D788: wanted 24, got 0
2023-01-05 00:36:13.778 IST [13936] LOG:  redo done at 0/1B71D750 system usage: CPU: user: 0.03 s, system: 0.00 s, elapsed: 0.03 s
2023-01-05 00:36:13.921 IST [11316] LOG:  database system is ready to accept connections
2023-01-05 01:24:10.109 IST [17840] ERROR:  canceling statement due to user request
2023-01-05 01:24:10.110 IST [11316] LOG:  received fast shutdown request
2023-01-05 01:24:10.121 IST [11316] LOG:  aborting any active transactions
2023-01-05 01:24:10.122 IST [4000] FATAL:  terminating connection due to administrator command
2023-01-05 01:24:10.122 IST [8608] FATAL:  terminating connection due to administrator command
2023-01-05 01:24:10.126 IST [11316] LOG:  background worker "logical replication launcher" (PID 17840) exited with exit code 1
2023-01-05 01:24:10.143 IST [7404] LOG:  shutting down
2023-01-05 01:24:10.205 IST [11316] LOG:  database system is shut down
2023-01-05 01:24:18.610 IST [13936] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 01:24:18.617 IST [13936] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 01:24:18.623 IST [13936] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 01:24:18.676 IST [14884] LOG:  database system was shut down at 2023-01-05 01:24:10 IST
2023-01-05 01:24:18.712 IST [13936] LOG:  database system is ready to accept connections
2023-01-05 01:26:10.456 IST [17116] ERROR:  syntax error at or near "join" at character 65
2023-01-05 01:26:10.456 IST [17116] STATEMENT:  WITH test AS ( SELECT   FROM sensex_index,bse,sensex_index,left join,bse,on,sensex_index.code,=,bse.code) select * from test limit 200 offset 0
2023-01-05 01:27:23.105 IST [17116] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 01:27:28.276 IST [16636] ERROR:  syntax error at or near "sensex_index" at character 47
2023-01-05 01:27:28.276 IST [16636] STATEMENT:  WITH test AS ( SELECT   FROM sensex_index bse sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code) select * from test limit 200 offset 0
2023-01-05 01:28:15.101 IST [16636] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:28:15.101 IST [16636] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:28:15.103 IST [16636] WARNING:  there is no transaction in progress
2023-01-05 01:28:15.104 IST [16636] ERROR:  syntax error at or near "sensex_index" at character 55
2023-01-05 01:28:15.104 IST [16636] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index bse sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code) select * from test limit 200 offset 0
2023-01-05 01:28:57.956 IST [16636] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:28:57.956 IST [16636] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:28:57.958 IST [16636] WARNING:  there is no transaction in progress
2023-01-05 01:28:57.960 IST [16636] ERROR:  syntax error at or near "sensex_index" at character 55
2023-01-05 01:28:57.960 IST [16636] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index bse sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code) select * from test limit 200 offset 0
2023-01-05 01:29:09.128 IST [16636] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:29:09.128 IST [16636] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:29:09.130 IST [16636] WARNING:  there is no transaction in progress
2023-01-05 01:29:09.131 IST [16636] ERROR:  syntax error at or near "sensex_index" at character 55
2023-01-05 01:29:09.131 IST [16636] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index bse sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code) select * from test limit 200 offset 0
2023-01-05 01:29:47.877 IST [16636] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:29:47.877 IST [16636] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2023-01-05 01:29:47.882 IST [16636] WARNING:  there is no transaction in progress
2023-01-05 01:38:54.907 IST [16636] ERROR:  syntax error at or near "sensex_index" at character 97
2023-01-05 01:38:54.907 IST [16636] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code WHERE  sensex_index.code = 500180) select * from test limit 200 offset 0
2023-01-05 01:39:01.158 IST [16636] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:39:01.158 IST [16636] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:39:01.160 IST [16636] WARNING:  there is no transaction in progress
2023-01-05 01:39:01.162 IST [16636] ERROR:  syntax error at or near "sensex_index" at character 97
2023-01-05 01:39:01.162 IST [16636] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code WHERE  sensex_index.code = 500180) select * from test limit 200 offset 0
2023-01-05 01:40:10.729 IST [16636] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:40:10.729 IST [16636] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:40:10.730 IST [16636] WARNING:  there is no transaction in progress
2023-01-05 01:40:10.732 IST [16636] ERROR:  syntax error at or near "sensex_index" at character 97
2023-01-05 01:40:10.732 IST [16636] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code WHERE  sensex_index.code = 500180) select * from test limit 200 offset 0
2023-01-05 01:40:27.104 IST [16636] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:40:27.104 IST [16636] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:40:27.105 IST [16636] WARNING:  there is no transaction in progress
2023-01-05 01:40:27.107 IST [16636] ERROR:  syntax error at or near "sensex_index" at character 97
2023-01-05 01:40:27.107 IST [16636] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code WHERE  sensex_index.code = 500180) select * from test limit 200 offset 0
2023-01-05 01:40:32.498 IST [13484] ERROR:  canceling statement due to user request
2023-01-05 01:40:32.499 IST [13936] LOG:  received fast shutdown request
2023-01-05 01:40:32.502 IST [13936] LOG:  aborting any active transactions
2023-01-05 01:40:32.502 IST [16636] FATAL:  terminating connection due to administrator command
2023-01-05 01:40:32.502 IST [6172] FATAL:  terminating connection due to administrator command
2023-01-05 01:40:32.513 IST [13936] LOG:  background worker "logical replication launcher" (PID 13484) exited with exit code 1
2023-01-05 01:40:32.531 IST [9976] LOG:  shutting down
2023-01-05 01:40:32.593 IST [13936] LOG:  database system is shut down
2023-01-05 01:40:34.000 IST [1896] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 01:40:34.010 IST [1896] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 01:40:34.016 IST [1896] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 01:40:34.058 IST [11680] LOG:  database system was shut down at 2023-01-05 01:40:32 IST
2023-01-05 01:40:34.104 IST [1896] LOG:  database system is ready to accept connections
2023-01-05 01:40:37.009 IST [8784] ERROR:  syntax error at or near "sensex_index" at character 97
2023-01-05 01:40:37.009 IST [8784] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code WHERE  sensex_index.code = 500180) select * from test limit 200 offset 0
2023-01-05 01:42:35.167 IST [8784] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 01:43:39.439 IST [16640] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 01:43:44.102 IST [7628] ERROR:  syntax error at or near "sensex_index" at character 97
2023-01-05 01:43:44.102 IST [7628] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code WHERE  sensex_index.code = 500180) select * from test limit 200 offset 0
2023-01-05 01:44:26.959 IST [7628] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 01:44:28.457 IST [4456] ERROR:  syntax error at or near "sensex_index" at character 97
2023-01-05 01:44:28.457 IST [4456] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code WHERE  sensex_index.code = 500180) select * from test limit 200 offset 0
2023-01-05 01:44:54.762 IST [4784] ERROR:  canceling statement due to user request
2023-01-05 01:44:54.762 IST [1896] LOG:  received fast shutdown request
2023-01-05 01:44:54.774 IST [1896] LOG:  aborting any active transactions
2023-01-05 01:44:54.774 IST [4456] FATAL:  terminating connection due to administrator command
2023-01-05 01:44:54.775 IST [10648] FATAL:  terminating connection due to administrator command
2023-01-05 01:44:54.775 IST [1896] LOG:  background worker "logical replication launcher" (PID 4784) exited with exit code 1
2023-01-05 01:44:54.775 IST [18276] FATAL:  terminating connection due to administrator command
2023-01-05 01:44:54.805 IST [5096] LOG:  shutting down
2023-01-05 01:44:54.854 IST [1896] LOG:  database system is shut down
2023-01-05 01:44:56.481 IST [8412] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 01:44:56.489 IST [8412] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 01:44:56.495 IST [8412] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 01:44:56.536 IST [15216] LOG:  database system was shut down at 2023-01-05 01:44:54 IST
2023-01-05 01:44:56.612 IST [8412] LOG:  database system is ready to accept connections
2023-01-05 01:45:47.891 IST [11604] ERROR:  syntax error at or near "sensex_index" at character 97
2023-01-05 01:45:47.891 IST [11604] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code WHERE  bse.code = 500410) select * from test limit 200 offset 0
2023-01-05 01:46:35.490 IST [11604] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:46:35.490 IST [11604] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:46:35.492 IST [11604] WARNING:  there is no transaction in progress
2023-01-05 01:46:35.493 IST [11604] ERROR:  syntax error at or near "sensex_index" at character 233
2023-01-05 01:46:35.493 IST [11604] STATEMENT:  WITH test AS ( SELECT  bse.code, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code WHERE  bse.code = 500411) select * from test limit 200 offset 0
2023-01-05 01:46:47.120 IST [11164] ERROR:  canceling statement due to user request
2023-01-05 01:46:47.121 IST [8412] LOG:  received fast shutdown request
2023-01-05 01:46:47.135 IST [8412] LOG:  aborting any active transactions
2023-01-05 01:46:47.135 IST [11604] FATAL:  terminating connection due to administrator command
2023-01-05 01:46:47.136 IST [18260] FATAL:  terminating connection due to administrator command
2023-01-05 01:46:47.138 IST [8412] LOG:  background worker "logical replication launcher" (PID 11164) exited with exit code 1
2023-01-05 01:46:47.155 IST [9972] LOG:  shutting down
2023-01-05 01:46:47.219 IST [8412] LOG:  database system is shut down
2023-01-05 01:46:48.221 IST [13572] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 01:46:48.228 IST [13572] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 01:46:48.234 IST [13572] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 01:46:48.276 IST [2140] LOG:  database system was shut down at 2023-01-05 01:46:47 IST
2023-01-05 01:46:48.345 IST [13572] LOG:  database system is ready to accept connections
2023-01-05 01:46:50.878 IST [1960] ERROR:  syntax error at or near "sensex_index" at character 233
2023-01-05 01:46:50.878 IST [1960] STATEMENT:  WITH test AS ( SELECT  bse.code, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code WHERE  bse.code = 500411) select * from test limit 200 offset 0
2023-01-05 01:47:18.125 IST [1960] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:47:18.125 IST [1960] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:47:18.126 IST [1960] WARNING:  there is no transaction in progress
2023-01-05 01:47:18.129 IST [1960] ERROR:  syntax error at or near "sensex_index" at character 233
2023-01-05 01:47:18.129 IST [1960] STATEMENT:  WITH test AS ( SELECT  bse.code, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code WHERE  bse.code = 500411) select * from test limit 200 offset 0
2023-01-05 01:47:26.652 IST [1960] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:47:26.652 IST [1960] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:47:26.654 IST [1960] WARNING:  there is no transaction in progress
2023-01-05 01:47:26.656 IST [1960] ERROR:  syntax error at or near "sensex_index" at character 233
2023-01-05 01:47:26.656 IST [1960] STATEMENT:  WITH test AS ( SELECT  bse.code, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code sensex_index left join bse on bse.code = sensex_index.code WHERE  bse.code = 500411) select * from test limit 200 offset 0
2023-01-05 01:48:10.435 IST [1960] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:48:10.435 IST [1960] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2023-01-05 01:48:10.438 IST [1960] WARNING:  there is no transaction in progress
2023-01-05 01:49:58.093 IST [1960] ERROR:  syntax error at or near "2017" at character 150
2023-01-05 01:49:58.093 IST [1960] STATEMENT:  WITH myindex AS ( SELECT  bse.code,bse.name,bse.trade_date FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > ''2017-12-11'') select * from myindex limit 200 offset 0
2023-01-05 01:50:20.030 IST [1960] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:50:20.030 IST [1960] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:50:20.032 IST [1960] WARNING:  there is no transaction in progress
2023-01-05 01:50:20.034 IST [1960] ERROR:  syntax error at or near "sensex_index" at character 124
2023-01-05 01:50:20.034 IST [1960] STATEMENT:  WITH myindex AS ( SELECT  bse.code,bse.name,bse.trade_date FROM sensex_index left join bse on sensex_index.code = bse.code sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from myindex limit 200 offset 0
2023-01-05 01:52:52.408 IST [1960] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:52:52.408 IST [1960] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2023-01-05 01:52:52.410 IST [1960] WARNING:  there is no transaction in progress
2023-01-05 01:53:50.013 IST [1960] ERROR:  syntax error at or near "2017" at character 150
2023-01-05 01:53:50.013 IST [1960] STATEMENT:  WITH myindex AS ( SELECT  bse.code,bse.name,bse.trade_date FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > ''2017-12-11'') select * from myindex limit 200 offset 0
2023-01-05 01:54:13.503 IST [1960] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 01:54:13.503 IST [1960] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 01:54:13.505 IST [1960] WARNING:  there is no transaction in progress
2023-01-05 01:54:13.506 IST [1960] ERROR:  operator does not exist: date > integer at character 146
2023-01-05 01:54:13.506 IST [1960] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 01:54:13.506 IST [1960] STATEMENT:  WITH myindex AS ( SELECT  bse.code,bse.name,bse.trade_date FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from myindex limit 200 offset 0
2023-01-05 01:57:50.021 IST [1960] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 01:58:01.759 IST [17424] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 01:58:48.701 IST [1160] ERROR:  syntax error at or near "bse" at character 106
2023-01-05 01:58:48.701 IST [1160] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  ''bse.trade_date''  > ''2017-12-11'' ) select * from test limit 200 offset 0
2023-01-05 02:01:10.669 IST [1160] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:02:06.438 IST [17324] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:02:23.881 IST [14048] ERROR:  syntax error at or near "2017" at character 123
2023-01-05 02:02:23.881 IST [14048] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > ''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:03:28.911 IST [14048] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:03:43.610 IST [10672] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:03:47.615 IST [19400] ERROR:  syntax error at or near "2017" at character 123
2023-01-05 02:03:47.615 IST [19400] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > ''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:05:00.797 IST [19400] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:05:04.433 IST [19336] ERROR:  operator does not exist: date > integer at character 119
2023-01-05 02:05:04.433 IST [19336] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:05:04.433 IST [19336] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:06:49.952 IST [19336] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:06:58.887 IST [4272] ERROR:  syntax error at or near "bse" at character 106
2023-01-05 02:06:58.887 IST [4272] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  ''bse.trade_date'' > ''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:08:32.701 IST [4272] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:08:36.923 IST [15476] ERROR:  syntax error at or near "bse" at character 106
2023-01-05 02:08:36.923 IST [15476] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  ''bse.trade_date'' > ''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:08:49.512 IST [15476] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:08:50.888 IST [11104] ERROR:  syntax error at or near "bse" at character 106
2023-01-05 02:08:50.888 IST [11104] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  ''bse.trade_date'' > ''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:09:02.248 IST [11104] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:09:05.789 IST [12280] ERROR:  syntax error at or near "bse" at character 106
2023-01-05 02:09:05.789 IST [12280] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  ''bse.trade_date'' > ''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:11:27.424 IST [12280] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:12:01.679 IST [1836] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:12:05.205 IST [18636] ERROR:  operator does not exist: date > integer at character 119
2023-01-05 02:12:05.205 IST [18636] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:12:05.205 IST [18636] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:12:14.383 IST [18636] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:12:19.913 IST [17720] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:12:23.925 IST [6824] ERROR:  operator does not exist: date > integer at character 119
2023-01-05 02:12:23.925 IST [6824] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:12:23.925 IST [6824] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:12:51.027 IST [6824] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:12:56.583 IST [4852] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:12:58.982 IST [7628] ERROR:  operator does not exist: date > integer at character 119
2023-01-05 02:12:58.982 IST [7628] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:12:58.982 IST [7628] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:13:21.647 IST [7628] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:13:24.132 IST [12824] ERROR:  operator does not exist: date > integer at character 119
2023-01-05 02:13:24.132 IST [12824] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:13:24.132 IST [12824] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:13:59.313 IST [12824] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:14:01.445 IST [2420] ERROR:  operator does not exist: date > integer at character 119
2023-01-05 02:14:01.445 IST [2420] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:14:01.445 IST [2420] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:14:27.364 IST [2420] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:14:45.193 IST [19256] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:14:48.677 IST [8972] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:14:52.283 IST [18564] ERROR:  syntax error at or near "2017" at character 123
2023-01-05 02:14:52.283 IST [18564] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > ''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:16:14.302 IST [18564] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:16:17.066 IST [14588] ERROR:  operator does not exist: date > integer at character 119
2023-01-05 02:16:17.066 IST [14588] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:16:17.066 IST [14588] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date > 2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:16:22.904 IST [14588] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:17:05.414 IST [15492] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:17:07.615 IST [7160] ERROR:  syntax error at or near "2017" at character 122
2023-01-05 02:17:07.615 IST [7160] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date >''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:17:31.461 IST [7160] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:17:32.504 IST [16028] ERROR:  syntax error at end of input at character 173
2023-01-05 02:17:32.504 IST [16028] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date >--2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:18:31.486 IST [16028] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:18:35.996 IST [4320] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:18:38.474 IST [12216] ERROR:  syntax error at or near "2017" at character 122
2023-01-05 02:18:38.474 IST [12216] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date >''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:18:58.911 IST [12216] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:19:00.326 IST [1932] ERROR:  operator does not exist: date > integer at character 119
2023-01-05 02:19:00.326 IST [1932] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:19:00.326 IST [1932] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE  bse.trade_date >2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:21:16.725 IST [1932] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:21:26.390 IST [14976] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:21:33.341 IST [15408] ERROR:  syntax error at or near "2017" at character 121
2023-01-05 02:21:33.341 IST [15408] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:21:38.152 IST [12548] ERROR:  canceling statement due to user request
2023-01-05 02:21:38.153 IST [13572] LOG:  received fast shutdown request
2023-01-05 02:21:38.156 IST [13572] LOG:  aborting any active transactions
2023-01-05 02:21:38.156 IST [15408] FATAL:  terminating connection due to administrator command
2023-01-05 02:21:38.157 IST [13608] FATAL:  terminating connection due to administrator command
2023-01-05 02:21:38.180 IST [13572] LOG:  background worker "logical replication launcher" (PID 12548) exited with exit code 1
2023-01-05 02:21:38.195 IST [15176] LOG:  shutting down
2023-01-05 02:21:38.262 IST [13572] LOG:  database system is shut down
2023-01-05 02:21:39.197 IST [11212] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 02:21:39.205 IST [11212] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 02:21:39.211 IST [11212] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 02:21:39.252 IST [3288] LOG:  database system was shut down at 2023-01-05 02:21:38 IST
2023-01-05 02:21:39.323 IST [11212] LOG:  database system is ready to accept connections
2023-01-05 02:21:41.394 IST [1132] ERROR:  syntax error at or near "2017" at character 121
2023-01-05 02:21:41.394 IST [1132] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:22:20.194 IST [1132] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:22:22.707 IST [2668] ERROR:  syntax error at or near "2017" at character 121
2023-01-05 02:22:22.707 IST [2668] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:22:31.886 IST [2668] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:22:34.241 IST [18016] ERROR:  operator does not exist: date > integer at character 118
2023-01-05 02:22:34.241 IST [18016] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2023-01-05 02:22:34.241 IST [18016] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >2017-12-11) select * from test limit 200 offset 0
2023-01-05 02:22:42.548 IST [18016] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:24:08.998 IST [6052] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:24:13.454 IST [12696] ERROR:  syntax error at or near "2017" at character 121
2023-01-05 02:24:13.454 IST [12696] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:25:18.150 IST [12696] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:25:22.430 IST [19196] ERROR:  syntax error at or near "2017" at character 121
2023-01-05 02:25:22.430 IST [19196] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:25:44.175 IST [19196] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:25:47.945 IST [16996] ERROR:  column "2017-12-11" does not exist at character 119
2023-01-05 02:25:47.945 IST [16996] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >"2017-12-11") select * from test limit 200 offset 0
2023-01-05 02:26:18.327 IST [16996] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:26:21.919 IST [1836] ERROR:  column "2017-12-11" does not exist at character 119
2023-01-05 02:26:21.919 IST [1836] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >"2017-12-11") select * from test limit 200 offset 0
2023-01-05 02:26:31.016 IST [1836] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:26:32.417 IST [14212] ERROR:  syntax error at or near "2017" at character 121
2023-01-05 02:26:32.417 IST [14212] STATEMENT:  WITH test AS ( SELECT  bse.code FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from test limit 200 offset 0
2023-01-05 02:27:33.091 IST [14212] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:27:50.892 IST [8736] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:30:39.950 IST [16416] ERROR:  syntax error at or near "2017" at character 1014
2023-01-05 02:30:39.950 IST [16416] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('myindex','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "myindex", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','WITH myindex AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >'2017-12-11') select * from myindex limit 2000 offset 0','')
	        
2023-01-05 02:33:29.463 IST [16416] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:33:37.138 IST [13092] ERROR:  syntax error at or near "2017" at character 278
2023-01-05 02:33:37.138 IST [13092] STATEMENT:  WITH myindex AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from myindex limit 2000 offset 0
2023-01-05 02:34:40.530 IST [13092] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:37:25.493 IST [8084] ERROR:  syntax error at or near "2017" at character 1014
2023-01-05 02:37:25.493 IST [8084] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('myindex','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "myindex", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','WITH myindex AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >'2017-12-11') select * from myindex limit 2000 offset 0','')
	        
2023-01-05 02:38:24.144 IST [8084] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:38:27.498 IST [11476] ERROR:  syntax error at or near "2017" at character 1014
2023-01-05 02:38:27.498 IST [11476] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('myindex','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "myindex", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','WITH myindex AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >'2017-12-11') select * from myindex limit 2000 offset 0','')
	        
2023-01-05 02:39:37.247 IST [11476] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:39:39.718 IST [7616] ERROR:  syntax error at or near "2017" at character 1014
2023-01-05 02:39:39.718 IST [7616] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('myindex','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "myindex", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','WITH myindex AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >'2017-12-11') select * from myindex limit 2000 offset 0','')
	        
2023-01-05 02:40:10.417 IST [7616] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:40:12.680 IST [5180] ERROR:  syntax error at or near "2017" at character 1014
2023-01-05 02:40:12.680 IST [5180] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('myindex','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "myindex", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','WITH myindex AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >'2017-12-11') select * from myindex limit 2000 offset 0','')
	        
2023-01-05 02:40:47.666 IST [5180] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:40:49.998 IST [18792] ERROR:  syntax error at or near "2017" at character 1014
2023-01-05 02:40:49.998 IST [18792] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('myindex','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "myindex", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','WITH myindex AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >'2017-12-11') select * from myindex limit 2000 offset 0','')
	        
2023-01-05 02:41:30.071 IST [18792] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:43:37.531 IST [13724] ERROR:  canceling statement due to user request
2023-01-05 02:43:37.531 IST [11212] LOG:  received fast shutdown request
2023-01-05 02:43:37.535 IST [11212] LOG:  aborting any active transactions
2023-01-05 02:43:37.535 IST [6960] FATAL:  terminating connection due to administrator command
2023-01-05 02:43:37.536 IST [3408] FATAL:  terminating connection due to administrator command
2023-01-05 02:43:37.536 IST [10156] FATAL:  terminating connection due to administrator command
2023-01-05 02:43:37.548 IST [11212] LOG:  background worker "logical replication launcher" (PID 13724) exited with exit code 1
2023-01-05 02:43:37.566 IST [17876] LOG:  shutting down
2023-01-05 02:43:37.616 IST [11212] LOG:  database system is shut down
2023-01-05 02:43:39.999 IST [19204] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 02:43:40.007 IST [19204] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 02:43:40.013 IST [19204] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 02:43:40.054 IST [16092] LOG:  database system was shut down at 2023-01-05 02:43:37 IST
2023-01-05 02:43:40.115 IST [19204] LOG:  database system is ready to accept connections
2023-01-05 02:44:51.124 IST [13848] ERROR:  canceling statement due to user request
2023-01-05 02:44:51.124 IST [13848] CONTEXT:  while inserting index tuple (0,17) in relation "cte_name_key"
2023-01-05 02:44:51.124 IST [13848] STATEMENT:  insert into
	            CTE(name,ctejson,ctesql,parent)
	            values('test123','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "test123", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": 
	"rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','WITH test123 AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from test123 limit 2000 offset 0','')
	
2023-01-05 02:53:22.670 IST [16792] ERROR:  canceling statement due to user request
2023-01-05 02:53:22.670 IST [16792] CONTEXT:  while inserting index tuple (0,18) in relation "cte_name_key"
2023-01-05 02:53:22.670 IST [16792] STATEMENT:  insert into
	            CTE(name,ctejson,ctesql,parent)
	            values('test123','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "test123", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": 
	"rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','WITH test123 AS ( SELECT  bse.code,sensex_index.name, AVG(bse.close) OVER(PARTITION BY sensex_index.code ORDER BY bse.trade_date asc ROWS  BETWEEN 200 preceding  AND current Row) as sma200 FROM sensex_index left join bse on sensex_index.code = bse.code WHERE bse.trade_date >''2017-12-11'') select * from test123 limit 2000 offset 0','')
	
2023-01-05 02:53:57.272 IST [5180] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:53:57.273 IST [5180] LOG:  unexpected EOF on client connection with an open transaction
2023-01-05 02:53:57.282 IST [8080] LOG:  could not receive data from client: An established connection was aborted by the software in your host machine.
	
2023-01-05 02:54:02.967 IST [16112] ERROR:  duplicate key value violates unique constraint "cte_name_key"
2023-01-05 02:54:02.967 IST [16112] DETAIL:  Key (name)=(test123) already exists.
2023-01-05 02:54:02.967 IST [16112] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('test123','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "test123", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','','')
	        
2023-01-05 02:54:25.889 IST [16112] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 02:54:25.889 IST [16112] STATEMENT:  
	        create table if not exists CTE(name text unique,ctejson json, ctesql text,parent text)
	    
2023-01-05 02:54:25.890 IST [16112] WARNING:  there is no transaction in progress
2023-01-05 02:54:56.197 IST [16112] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:54:56.197 IST [16112] LOG:  unexpected EOF on client connection with an open transaction
2023-01-05 02:55:15.109 IST [10600] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:55:15.109 IST [10600] LOG:  unexpected EOF on client connection with an open transaction
2023-01-05 02:55:48.403 IST [13972] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:56:44.990 IST [15836] ERROR:  duplicate key value violates unique constraint "cte_name_key"
2023-01-05 02:56:44.990 IST [15836] DETAIL:  Key (name)=(test123) already exists.
2023-01-05 02:56:44.990 IST [15836] STATEMENT:  
	            insert into 
	            CTE(name,ctejson,ctesql,parent) 
	            values('test123','[{"from": ["sensex_index", "left join", "bse", "on", "sensex_index.code", "=", "bse.code"], "parent": "", "name": "test123", "cols": [{"name": "bse.code", "type": "normal"}, {"name": "sensex_index.name", "type": "normal"}, {"name": "sma200", "type": "window_function", "attributes": {"window_func": "AVG", "col": "bse.close", "over": {"partition_by": "sensex_index.code", "order_by": "bse.trade_date", "order_type": "asc", "frame_spec": {"type": "rows"}, "frame_boundaries": {"preceding": "200 preceding", "following": "current Row"}}}}], "where": ["bse.trade_date", "gt", "2017-12-11"], "order": [], "limit": "2000", "offset": "0"}]','','')
	        
2023-01-05 02:57:29.302 IST [15836] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 02:57:49.399 IST [9480] ERROR:  syntax error at end of input at character 26
2023-01-05 02:57:49.399 IST [9480] STATEMENT:  create table cte_temp as 
2023-01-05 02:59:06.868 IST [9480] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 03:02:37.107 IST [4012] ERROR:  canceling statement due to user request
2023-01-05 03:02:37.107 IST [19204] LOG:  received fast shutdown request
2023-01-05 03:02:37.119 IST [19204] LOG:  aborting any active transactions
2023-01-05 03:02:37.119 IST [10616] FATAL:  terminating connection due to administrator command
2023-01-05 03:02:37.119 IST [2288] FATAL:  terminating connection due to administrator command
2023-01-05 03:02:37.127 IST [19204] LOG:  background worker "logical replication launcher" (PID 4012) exited with exit code 1
2023-01-05 03:02:37.143 IST [11660] LOG:  shutting down
2023-01-05 03:02:37.171 IST [19204] LOG:  database system is shut down
2023-01-05 03:02:38.859 IST [15068] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 03:02:38.867 IST [15068] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 03:02:38.872 IST [15068] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 03:02:38.927 IST [3036] LOG:  database system was shut down at 2023-01-05 03:02:37 IST
2023-01-05 03:02:38.997 IST [15068] LOG:  database system is ready to accept connections
2023-01-05 03:02:51.105 IST [15068] LOG:  received fast shutdown request
2023-01-05 03:02:51.108 IST [15068] LOG:  aborting any active transactions
2023-01-05 03:02:51.127 IST [15068] LOG:  background worker "logical replication launcher" (PID 13324) exited with exit code 1
2023-01-05 03:02:51.127 IST [18328] LOG:  shutting down
2023-01-05 03:02:51.158 IST [15068] LOG:  database system is shut down
2023-01-05 03:02:51.393 IST [16088] LOG:  starting PostgreSQL 14.6, compiled by Visual C++ build 1914, 64-bit
2023-01-05 03:02:51.401 IST [16088] LOG:  listening on IPv6 address "::1", port 5432
2023-01-05 03:02:51.406 IST [16088] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2023-01-05 03:02:51.459 IST [13160] LOG:  database system was shut down at 2023-01-05 03:02:51 IST
2023-01-05 03:02:51.538 IST [16088] LOG:  database system is ready to accept connections
2023-01-05 03:04:35.676 IST [16264] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 03:04:49.120 IST [7580] ERROR:  column "code" specified more than once
2023-01-05 03:04:49.120 IST [7580] STATEMENT:  create table cte_temp as WITH test0 AS ( SELECT  bse.code,bse.name,sensex_index.code FROM sensex_index left join bse on sensex_index.code = bse.code) select * from test0 limit 200 offset 0
2023-01-05 03:05:00.972 IST [7580] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2023-01-05 03:05:00.972 IST [7580] STATEMENT:  
	        SELECT * FROM information_schema.tables WHERE table_schema = 'public'
	    
2023-01-05 03:05:00.974 IST [7580] WARNING:  there is no transaction in progress
2023-01-05 03:08:53.072 IST [7580] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 03:08:53.072 IST [7580] LOG:  unexpected EOF on client connection with an open transaction
2023-01-05 03:09:04.688 IST [14804] ERROR:  syntax error at or near "." at character 58
2023-01-05 03:09:04.688 IST [14804] STATEMENT:  WITH test0 AS ( SELECT  sensex_index.code as sensex_index.code,bse.code as bse.code FROM sensex_index left join bse on sensex_index.code = bse.code) select * from test0 limit 200 offset 0
2023-01-05 03:09:36.556 IST [14804] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2023-01-05 03:10:40.050 IST [19232] ERROR:  canceling statement due to user request
2023-01-05 03:10:40.050 IST [16088] LOG:  received fast shutdown request
2023-01-05 03:10:40.053 IST [16088] LOG:  aborting any active transactions
2023-01-05 03:10:40.054 IST [12420] FATAL:  terminating connection due to administrator command
2023-01-05 03:10:40.054 IST [11896] FATAL:  terminating connection due to administrator command
2023-01-05 03:10:40.054 IST [8400] FATAL:  terminating connection due to administrator command
2023-01-05 03:10:40.078 IST [16088] LOG:  background worker "logical replication launcher" (PID 19232) exited with exit code 1
2023-01-05 03:10:40.094 IST [9100] LOG:  shutting down
2023-01-05 03:10:40.206 IST [16088] LOG:  database system is shut down
