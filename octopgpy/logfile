2022-04-25 19:03:57.020 IST [20816] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-04-25 19:03:57.031 IST [20816] LOG:  listening on IPv6 address "::1", port 5432
2022-04-25 19:03:57.038 IST [20816] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-04-25 19:03:57.094 IST [20812] LOG:  database system was shut down at 2022-04-25 19:03:56 IST
2022-04-25 19:03:57.176 IST [20816] LOG:  database system is ready to accept connections
2022-04-25 19:04:05.604 IST [12280] ERROR:  relation "public.dd_test" does not exist at character 15
2022-04-25 19:04:05.604 IST [12280] STATEMENT:  SELECT * FROM public.dd_test
2022-04-25 23:31:56.762 IST [7560] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-04-25 23:31:56.772 IST [7560] LOG:  listening on IPv6 address "::1", port 5432
2022-04-25 23:31:56.778 IST [7560] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-04-25 23:31:56.834 IST [10156] LOG:  database system was interrupted; last known up at 2022-04-25 19:03:57 IST
2022-04-25 23:31:57.233 IST [10156] LOG:  database system was not properly shut down; automatic recovery in progress
2022-04-25 23:31:57.240 IST [10156] LOG:  redo starts at 0/1718ED8
2022-04-25 23:31:57.299 IST [10156] LOG:  invalid record length at 0/17D16C8: wanted 24, got 0
2022-04-25 23:31:57.300 IST [10156] LOG:  redo done at 0/17D1690 system usage: CPU: user: 0.00 s, system: 0.06 s, elapsed: 0.05 s
2022-04-25 23:31:57.885 IST [7560] LOG:  database system is ready to accept connections
2022-04-26 01:59:55.004 IST [1188] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 02:01:51.736 IST [11172] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 02:06:53.827 IST [33168] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:06:53.827 IST [33168] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:16:53.875 IST [10160] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 02:16:55.698 IST [16376] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:16:55.698 IST [16376] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:17:23.154 IST [1756] ERROR:  canceling statement due to user request
2022-04-26 02:17:23.155 IST [7560] LOG:  received fast shutdown request
2022-04-26 02:17:23.167 IST [7560] LOG:  aborting any active transactions
2022-04-26 02:17:23.168 IST [16868] FATAL:  terminating connection due to administrator command
2022-04-26 02:17:23.168 IST [27872] FATAL:  terminating connection due to administrator command
2022-04-26 02:17:23.186 IST [7560] LOG:  background worker "logical replication launcher" (PID 1756) exited with exit code 1
2022-04-26 02:17:23.193 IST [22580] LOG:  shutting down
2022-04-26 02:17:23.265 IST [7560] LOG:  database system is shut down
2022-04-26 02:17:27.506 IST [25572] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-04-26 02:17:27.516 IST [25572] LOG:  listening on IPv6 address "::1", port 5432
2022-04-26 02:17:27.522 IST [25572] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-04-26 02:17:27.591 IST [31792] LOG:  database system was shut down at 2022-04-26 02:17:23 IST
2022-04-26 02:17:27.654 IST [25572] LOG:  database system is ready to accept connections
2022-04-26 02:17:31.299 IST [19644] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:17:31.299 IST [19644] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:20:01.405 IST [26236] ERROR:  type "datetime" does not exist at character 52
2022-04-26 02:20:01.405 IST [26236] STATEMENT:  create table if not exists myapp_stocks(trade_date datetime,name text,close numeric)
2022-04-26 02:22:08.282 IST [5652] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:22:08.282 IST [5652] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:22:38.192 IST [17176] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 02:22:41.697 IST [5024] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:22:41.697 IST [5024] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:22:52.358 IST [9920] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:22:52.358 IST [9920] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:23:48.151 IST [30624] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 02:23:51.100 IST [31436] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:23:51.100 IST [31436] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:25:01.536 IST [31592] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 02:25:06.940 IST [15364] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:25:06.940 IST [15364] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:25:34.921 IST [25120] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 02:25:38.241 IST [20592] ERROR:  syntax error at or near ")" at character 26
2022-04-26 02:25:38.241 IST [20592] STATEMENT:  insert into myapp_stocks() values()
2022-04-26 02:25:50.776 IST [28652] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 02:25:55.842 IST [27524] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-04-26 09:22:35.215 IST [25572] LOG:  server process (PID 18612) was terminated by exception 0xC000013A
2022-04-26 09:22:35.215 IST [25572] DETAIL:  Failed process was running: SELECT "django_migrations"."id", "django_migrations"."app", "django_migrations"."name", "django_migrations"."applied" FROM "django_migrations"
2022-04-26 09:22:35.215 IST [25572] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-04-26 09:22:35.216 IST [25572] LOG:  terminating any other active server processes
2022-04-26 09:22:35.260 IST [25572] LOG:  all server processes terminated; reinitializing
2022-04-26 09:22:35.284 IST [25572] LOG:  startup process (PID 28412) was terminated by exception 0xC0000142
2022-04-26 09:22:35.284 IST [25572] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-04-26 09:22:35.284 IST [25572] LOG:  aborting startup due to startup process failure
2022-04-26 09:22:35.286 IST [25572] LOG:  database system is shut down
2022-04-27 01:07:12.486 IST [34508] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-04-27 01:07:12.498 IST [34508] LOG:  listening on IPv6 address "::1", port 5432
2022-04-27 01:07:12.504 IST [34508] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-04-27 01:07:12.578 IST [34504] LOG:  database system was interrupted; last known up at 2022-04-26 02:27:28 IST
2022-04-27 01:07:13.164 IST [34504] LOG:  database system was not properly shut down; automatic recovery in progress
2022-04-27 01:07:13.171 IST [34504] LOG:  redo starts at 0/183E3C8
2022-04-27 01:07:13.172 IST [34504] LOG:  invalid record length at 0/183E5B8: wanted 24, got 0
2022-04-27 01:07:13.172 IST [34504] LOG:  redo done at 0/183E580 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-04-27 01:07:13.276 IST [34508] LOG:  database system is ready to accept connections
2022-04-27 01:29:29.885 IST [34508] LOG:  server process (PID 5124) was terminated by exception 0xC000013A
2022-04-27 01:29:29.885 IST [34508] DETAIL:  Failed process was running: SELECT "django_migrations"."id", "django_migrations"."app", "django_migrations"."name", "django_migrations"."applied" FROM "django_migrations"
2022-04-27 01:29:29.885 IST [34508] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-04-27 01:29:29.885 IST [34508] LOG:  terminating any other active server processes
2022-04-27 01:29:29.919 IST [34508] LOG:  received fast shutdown request
^C2022-04-27 10:40:04.605 IST [15980] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-04-27 10:40:04.622 IST [15980] LOG:  listening on IPv6 address "::1", port 5432
2022-04-27 10:40:04.629 IST [15980] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-04-27 10:40:04.698 IST [4588] LOG:  database system was interrupted; last known up at 2022-04-27 01:12:13 IST
2022-04-27 10:40:05.102 IST [4588] LOG:  database system was not properly shut down; automatic recovery in progress
2022-04-27 10:40:05.108 IST [4588] LOG:  redo starts at 0/1840618
2022-04-27 10:40:05.108 IST [4588] LOG:  invalid record length at 0/1840700: wanted 24, got 0
2022-04-27 10:40:05.108 IST [4588] LOG:  redo done at 0/18406C8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-04-27 10:40:05.222 IST [15980] LOG:  database system is ready to accept connections
2022-04-27 10:41:00.654 IST [20736] ERROR:  column "INFY" does not exist at character 12
2022-04-27 10:41:00.654 IST [20736] STATEMENT:  
	 select ("INFY") not in (select name from myapp_stocks )
2022-04-27 10:41:15.837 IST [20736] ERROR:  column "INFY" does not exist at character 11
2022-04-27 10:41:15.837 IST [20736] STATEMENT:  
	 select "INFY" not in (select name from myapp_stocks )
2022-04-27 13:41:03.365 IST [8308] ERROR:  canceling statement due to user request
2022-04-27 13:41:03.367 IST [15980] LOG:  received fast shutdown request
2022-04-27 13:41:03.371 IST [15980] LOG:  aborting any active transactions
2022-04-27 13:41:03.371 IST [20736] FATAL:  terminating connection due to administrator command
2022-04-27 13:41:03.397 IST [15980] LOG:  background worker "logical replication launcher" (PID 8308) exited with exit code 1
2022-04-27 13:41:03.404 IST [32800] LOG:  shutting down
2022-04-27 13:41:03.478 IST [15980] LOG:  database system is shut down
2022-05-01 20:54:00.211 IST [22836] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-05-01 20:54:00.222 IST [22836] LOG:  listening on IPv6 address "::1", port 5432
2022-05-01 20:54:00.227 IST [22836] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-05-01 20:54:00.291 IST [23012] LOG:  database system was shut down at 2022-04-27 13:41:03 IST
2022-05-01 20:54:00.374 IST [22836] LOG:  database system is ready to accept connections
2022-05-01 20:57:52.572 IST [21564] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 20:59:31.456 IST [22724] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:00:19.773 IST [20200] ERROR:  relation "bse" does not exist at character 33
2022-05-01 21:00:19.773 IST [20200] STATEMENT:  select distinct(code),name from bse order by name
2022-05-01 21:03:26.471 IST [17704] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:03:26.472 IST [17704] LOG:  unexpected EOF on client connection with an open transaction
2022-05-01 21:03:26.472 IST [2508] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:03:26.472 IST [16728] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:04:21.459 IST [3124] ERROR:  function ema(numeric, numeric) does not exist at character 73
2022-05-01 21:04:21.459 IST [3124] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-05-01 21:04:21.459 IST [3124] STATEMENT:  
	         select
	            trade_date,
	            close,
	            ema(close,0.20) over (order by trade_date asc),
	            name,
	            avg(close) over (
	            order by trade_date asc),
	            min(close) over (
	            order by trade_date asc),
	            open,
	            close,
	            high,
	            low,
	            no_trades,
	            no_of_shrs_net_turnov
	        from
	            bse
	        where
	            code = 500400
	            
	            and trade_date > current_date - interval '300' day order by trade_date desc limit 1
	            
2022-05-01 21:05:16.811 IST [14200] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:05:33.170 IST [7544] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:05:33.170 IST [7836] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:05:33.170 IST [11556] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:05:33.170 IST [7836] LOG:  unexpected EOF on client connection with an open transaction
2022-05-01 21:05:41.202 IST [5976] ERROR:  function ema(numeric, numeric) does not exist at character 73
2022-05-01 21:05:41.202 IST [5976] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-05-01 21:05:41.202 IST [5976] STATEMENT:  
	         select
	            trade_date,
	            close,
	            ema(close,0.20) over (order by trade_date asc),
	            name,
	            avg(close) over (
	            order by trade_date asc),
	            min(close) over (
	            order by trade_date asc),
	            open,
	            close,
	            high,
	            low,
	            no_trades,
	            no_of_shrs_net_turnov
	        from
	            bse
	        where
	            code = 500400
	            
	            and trade_date > current_date - interval '300' day order by trade_date desc limit 1
	            
2022-05-01 21:06:25.132 IST [11600] ERROR:  function ema(numeric, numeric) does not exist at character 73
2022-05-01 21:06:25.132 IST [11600] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-05-01 21:06:25.132 IST [11600] STATEMENT:  
	         select
	            trade_date,
	            close,
	            ema(close,0.20) over (order by trade_date asc),
	            name,
	            avg(close) over (
	            order by trade_date asc),
	            min(close) over (
	            order by trade_date asc),
	            open,
	            close,
	            high,
	            low,
	            no_trades,
	            no_of_shrs_net_turnov
	        from
	            bse
	        where
	            code = 500400
	            
	            and trade_date > current_date - interval '300' day order by trade_date desc limit 1
	            
2022-05-01 21:07:55.040 IST [16560] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:08:24.372 IST [22376] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:08:46.906 IST [16088] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:10:42.552 IST [23092] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:10:46.286 IST [14016] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:10:56.850 IST [15656] ERROR:  relation "sensex" does not exist at character 409
2022-05-01 21:10:56.850 IST [15656] STATEMENT:  
	            SELECT 
	            name,
	            trade_date,
	            close,            
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS sma20 ,
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS sma50,
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200                   
	            FROM sensex 
	            where code = 500400
	            order by t desc
	        
2022-05-01 21:11:14.419 IST [1364] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:11:18.286 IST [4432] ERROR:  column "t" does not exist at character 467
2022-05-01 21:11:18.286 IST [4432] STATEMENT:  
	            SELECT 
	            name,
	            trade_date,
	            close,            
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS sma20 ,
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS sma50,
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200                   
	            FROM bse 
	            where code = 500400
	            order by t desc
	        
2022-05-01 21:11:27.324 IST [14224] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:11:36.016 IST [8644] ERROR:  column "t" does not exist at character 132
2022-05-01 21:11:36.016 IST [8644] STATEMENT:  
	            SELECT 
	            name,
	            trade_date,
	            close,            
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS sma20 ,
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS sma50,
	            AVG(close) OVER(ORDER BY t ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200                   
	            FROM bse 
	            where code = 500400
	            order by trade_date desc
	        
2022-05-01 21:12:10.845 IST [5076] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:12:17.336 IST [20616] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:12:46.005 IST [13200] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:22:40.700 IST [5708] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-05-01 21:22:51.707 IST [18024] ERROR:  canceling statement due to user request
2022-05-01 21:22:51.708 IST [22836] LOG:  received fast shutdown request
2022-05-01 21:22:51.712 IST [22836] LOG:  aborting any active transactions
2022-05-01 21:22:51.713 IST [17560] FATAL:  terminating connection due to administrator command
2022-05-01 21:22:51.715 IST [22836] LOG:  background worker "logical replication launcher" (PID 18024) exited with exit code 1
2022-05-01 21:22:51.745 IST [1712] LOG:  shutting down
2022-05-01 21:22:51.789 IST [22836] LOG:  database system is shut down
2022-06-02 01:34:33.128 IST [9720] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-06-02 01:34:33.142 IST [9720] LOG:  listening on IPv6 address "::1", port 5432
2022-06-02 01:34:33.149 IST [9720] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-06-02 01:34:33.212 IST [13108] LOG:  database system was shut down at 2022-05-01 21:22:51 IST
2022-06-02 01:34:33.304 IST [9720] LOG:  database system is ready to accept connections
2022-06-02 01:41:02.131 IST [8956] ERROR:  LIMIT #,# syntax is not supported at character 18327
2022-06-02 01:41:02.131 IST [8956] HINT:  Use separate LIMIT and OFFSET clauses.
2022-06-02 01:41:02.131 IST [8956] STATEMENT:  
	    with indices(stock_code, stock_name) as (
	    values 
	    (523395,'3M India Ltd'),(524348,'Aarti Drugs Ltd'),(524208,'Aarti Industries Ltd.'),(541988,'AAVAS Financiers Ltd'),(500002,'ABB India Ltd'),(500488,'Abbott India Ltd'),(500410,'ACC Ltd'),(512599,'Adani Enterprises Ltd'),(541450,'Adani Green Energy Ltd'),(532921,'Adani Ports and Special Economic Zone'),(533096,'Adani Power Ltd'),(542066,'Adani Total Gas Limited'),(539254,'Adani Transmission Ltd'),(540691,'Aditya Birla Capital Ltd'),(535755,'Aditya Birla Fashion and Retail Ltd'),(540025,'Advanced Enzyme Technologies Ltd'),(500003,'Aegis Logistics Ltd'),(542752,'Affle (India) Ltd'),(532683,'AIA Engineering Ltd'),(532331,'Ajanta Pharma Ltd'),(500710,'Akzo Nobel India Ltd'),(533573,'Alembic Pharmaceuticals Ltd'),(539523,'Alkem Laboratories Ltd'),(506767,'Alkyl Amines Chemicals Ltd'),(532749,'AllCargo Logistics Ltd'),(521070,'Alok Industries Ltd'),(500008,'Amara Raja Batteries Ltd'),(540902,'Amber Enterprises India Ltd'),(500425,'Ambuja Cements Ltd'),(543235,'Angel One Limited'),(543275,'Anupam Rasayan India Ltd'),(533758,'APL Apollo Tubes Ltd'),(508869,'Apollo Hospitals Enterprise Ltd'),(500877,'Apollo Tyres Ltd'),(515030,'Asahi India Glass Ltd'),(500477,'Ashok Leyland Ltd'),(500820,'Asian Paints Ltd'),(540975,'Aster DM Healthcare Ltd'),(532830,'ASTRAL LIMITED'),(506820,'AstraZeneca Pharm India'),(500027,'Atul Ltd.'),(540611,'AU Small Finance Bank Ltd'),(524804,'Aurobindo Pharma Ltd'),(512573,'Avanti Feeds Ltd'),(540376,'Avenue Supermarts Ltd'),(532215,'Axis Bank Ltd'),(532977,'Bajaj Auto Ltd'),(533229,'Bajaj Consumer Care Ltd'),(500031,'Bajaj Electricals Ltd'),(500034,'Bajaj Finance Ltd'),(532978,'Bajaj Finserv Ltd'),(500490,'Bajaj Holdings and Investment Ltd'),(530999,'Balaji Amines Ltd'),(502355,'Balkrishna Industries Ltd'),(500038,'Balrampur Chini Mills Ltd'),(541153,'Bandhan Bank Ltd'),(532134,'Bank of Baroda'),(532149,'Bank of India'),(532525,'Bank Of Maharashtra'),(500042,'BASF India Limited'),(500043,'Bata India Ltimited'),(506285,'Bayer CropScience Ltd/India'),(500048,'BEML Ltd'),(509480,'Berger Paints India Ltd'),(541143,'Bharat Dynamics Ltd'),(500049,'Bharat Electronics Ltd'),(500493,'Bharat Forge Ltd'),(500103,'Bharat Heavy Electricals Ltd'),(500547,'Bharat Petroleum Corp Ltd'),(532454,'Bharti Airtel Ltd'),(532523,'Biocon Ltd'),(500335,'Birla Corp Ltd'),(532400,'Birlasoft Ltd'),(526612,'Blue Dart Express Ltd'),(500067,'Blue Star Ltd'),(501425,'Bombay Burmah Trading Corp Ltd.'),(500530,'Bosch Ltd'),(532929,'Brigade Enterprises Ltd'),(532368,'Brightcom Group Ltd'),(500825,'Britannia Industries Ltd.'),(511196,'Can Fin Homes Ltd'),(532483,'Canara Bank'),(524742,'Caplin Point Laboratories Ltd'),(531595,'Capri Global Capital  LTD'),(513375,'Carborundum Universal Ltd'),(500870,'Castrol India Ltd'),(519600,'CCL Products (India) Ltd.'),(500878,'CEAT Ltd'),(532885,'Central Bank of India'),(532548,'Century Plyboards India Ltd'),(500040,'Century Textile & Industries Ltd'),(532443,'Cera Sanitaryware Ltd'),(500084,'CESC Ltd'),(542399,'Chalet Hotels Ltd'),(500085,'Chambal Fertilizers & Chemicals Ltd'),(504973,'Cholamandalam Financial Holdings Ltd'),(511243,'Cholamandalam Investment & Finance Co. Ltd.'),(500087,'Cipla Ltd/India'),(532210,'City Union Bank Ltd.'),(533278,'Coal India Ltd'),(540678,'Cochin Shipyard Ltd'),(532541,'Coforge Ltd'),(500830,'Colgate-Palmolive India Ltd'),(543232,'Computer Age Management Services Ltd'),(531344,'Container Corp Of India'),(506395,'Coromandel International Ltd'),(541770,'CreditAccess Grameen Ltd'),(500092,'CRISIL Ltd'),(539876,'Crompton Greaves Consumer Electricals Ltd'),(542867,'CSB Bank Ltd'),(500480,'Cummins India Ltd'),(532175,'Cyient Ltd'),(500096,'Dabur India Ltd'),(542216,'Dalmia Bharat Ltd'),(532772,'DCB Bank Ltd'),(523367,'DCM Shriram Ltd'),(500645,'Deepak Fertilisers & Petrochemicals Corp. Ltd.'),(506401,'Deepak Nitrite Limited'),(532848,'Delta Corp. Ltd.'),(507717,'Dhanuka Agritech Ltd'),(540047,'Dilip Buildcon Ltd'),(540701,'Dishman Carbogen Amics Ltd'),(532488,'Divi''s Laboratories Ltd'),(540699,'Dixon Technologies (India) Ltd'),(532868,'DLF Ltd'),(500124,'Dr Reddy''s Laboratories Ltd'),(539524,'Dr. Lal PathLabs Ltd'),(532927,'eClerx Services Ltd'),(532922,'Edelweiss Financial Services Ltd'),(505200,'Eicher Motors Ltd'),(500125,'EID Parry India Ltd'),(500840,'EIH Ltd'),(522074,'Elgi Equipments Ltd.'),(531162,'Emami Ltd'),(540153,'Endurance Technologies Ltd'),(532178,'Engineers India Ltd'),(500135,'EPL Ltd'),(539844,'Equitas Holdings Ltd'),(543243,'Equitas Small Finance Bank Ltd'),(540596,'Eris Lifesciences Ltd'),(500133,'Esab India Ltd'),(500495,'Escorts Ltd'),(500086,'Exide Industries Ltd'),(531599,'FDC Ltd'),(500469,'Federal Bank Ltd'),(541557,'Fine Organic Industries Ltd'),(500144,'Finolex Cables Ltd'),(500940,'Finolex Industries Ltd'),(532809,'Firstsource Solutions Ltd'),(532843,'Fortis Healthcare Ltd.'),(532155,'Gail India Ltd'),(540935,'Galaxy Surfactants Ltd'),(509557,'Garware Technical Fibres Ltd'),(540755,'General Insurance Corporation of India'),(500171,'GHCL Ltd'),(507815,'Gillette India Ltd'),(543245,'Gland Pharma Ltd'),(500660,'GlaxoSmithKline Pharmaceuticals Ltd'),(532296,'Glenmark Pharmaceuticals Ltd'),(505255,'GMM Pfaudler Limited'),(500163,'Godfrey Phillips India Ltd'),(540743,'Godrej Agrovet Ltd'),(532424,'Godrej Consumer Products Ltd'),(500164,'Godrej Industries Ltd'),(533150,'Godrej Properties Ltd'),(532482,'Granules India Ltd'),(509488,'Graphite India Ltd.'),(500300,'Grasim Industries Ltd'),(500620,'Great Eastern Shipping Co Ltd/The'),(501455,'Greaves Cotton Ltd.'),(506076,'Grindwell Norton Ltd'),(530001,'Gujarat Alkalies & Chemicals Ltd.'),(542812,'Gujarat Fluorochemicals Ltd'),(539336,'Gujarat Gas Ltd'),(500670,'Gujarat Narmada Valley Fertilizers and Chemicals Limited'),(533248,'Gujarat Pipavav Port Ltd'),(500690,'Gujarat State Fertilisers & Chemicals Ltd'),(532702,'Gujarat State Petronet Ltd'),(538567,'Gulf Oil Lubricants India Ltd'),(543227,'Happiest Minds Technologies Ltd'),(533162,'Hathway Cables and Datacom Ltd'),(531531,'Hatsun Agro Products Ltd'),(517354,'Havells India Ltd'),(508486,'HawkiBO Cookers Ltd'),(532281,'HCL Technologies Ltd'),(541729,'HDFC Asset Management Company Ltd'),(500180,'HDFC Bank Ltd'),(540777,'HDFC Life Insurance Company Ltd'),(509631,'HEG Ltd'),(500292,'HeidelbergCement India Ltd.'),(500182,'Hero MotoCorp Ltd'),(500183,'HFCL Ltd'),(524735,'Hikal Ltd.'),(500440,'Hindalco Industries Ltd'),(541154,'Hindustan Aeronautics Ltd'),(513599,'Hindustan Copper'),(500104,'Hindustan Petroleum Corp Ltd'),(500696,'Hindustan Unilever Ltd'),(500188,'Hindustan Zinc Ltd'),(543187,'Hitachi Energy India Ltd'),(517174,'Honeywell Automation India Ltd'),(540530,'Housing and Urban Development Corporation Ltd'),(500010,'Housing Development Finance Corp'),(532174,'ICICI Bank Ltd'),(540716,'ICICI Lombard General Insurance Company Ltd'),(540133,'ICICI Prudential Life Insurance Company Ltd'),(541179,'ICICI Securities Ltd'),(500116,'IDBI Bank Ltd'),(539437,'IDFC First Bank Ltd'),(532659,'IDFC Limited'),(505726,'IFB Industries Ltd'),(532636,'IIFL Finance Ltd'),(542772,'IIFL Wealth Management Ltd'),(530005,'India Cements Ltd'),(532189,'India Tourism Development Corp Ltd'),(535789,'Indiabulls Housing Finance Limited'),(532832,'Indiabulls Real Estate Ltd'),(542726,'Indiamart Intermesh Limited'),(532814,'Indian Bank'),(540750,'Indian Energy Exchange Ltd'),(500850,'Indian Hotels Co Ltd'),(530965,'Indian Oil Corp Ltd'),(532388,'Indian Overseas Bank'),(542830,'Indian Railway Catering and Tourism Corporation Ltd'),(543257,'Indian Railway Finance Corporation Limited'),(543258,'Indigo Paints Ltd'),(532612,'Indoco Remedies Ltd.'),(541336,'Indostar Capital Finance Ltd'),(532514,'Indraprastha Gas Ltd'),(534816,'Indus Towers Ltd'),(532187,'IndusInd Bank Ltd'),(539807,'Infibeam Avenues Ltd'),(532777,'Info Edge (India) Ltd.'),(500209,'Infosys Ltd'),(532706,'Inox Leisure'),(538835,'Intellect Design Arena Ltd.'),(539448,'InterGlobe Aviation Ltd'),(524164,'IOL Chemicals and Pharmaceuticals Ltd'),(524494,'Ipca Laboratories Ltd'),(532947,'IRB Infrastructure Developers Ltd'),(541956,'IRCON International Ltd'),(500875,'ITC Ltd'),(523610,'ITI Ltd'),(530007,'J. K. Tyre Industries Ltd'),(506943,'J.B.Chemicals & Pharmaceuticals Ltd.'),(532644,'J.K. Cement Ltd.'),(520051,'Jamna Auto Industries Ltd'),(500378,'Jindal SAW Ltd'),(539597,'Jindal Stainless (Hisar) Ltd'),(532508,'Jindal Stainless Ltd.'),(532286,'Jindal Steel & Power Ltd'),(500380,'JK Lakshmi Cement Ltd'),(532162,'JK Paper Ltd.'),(523405,'JM Financial Ltd'),(523398,'Johnson Controls -Hitachi Air Conditioning India Ltd'),(533148,'JSW Energy Ltd'),(500228,'JSW Steel Ltd'),(533155,'Jubilant FoodWorks Ltd'),(543271,'Jubilant Ingrevia Limited'),(530019,'Jubilant Pharmova Sciences Ltd'),(535648,'Just Dial Ltd'),(532926,'Jyothy Labs Ltd'),(500233,'Kajaria Ceramics Ltd.'),(522287,'Kalpataru Power Transmission Ltd'),(543278,'Kalyan Jewellers India Ltd'),(500165,'Kansai Nerolac Paints Ltd.'),(532899,'Kaveri Seed Co Ltd'),(532714,'KEC International Ltd/India'),(517569,'KEI Industries Ltd'),(540680,'KIOCL Ltd'),(532942,'KNR Constructions Ltd'),(500247,'Kotak Mahindra Bank Ltd'),(542651,'KPIT Technologies Ltd'),(532889,'KPR Mill Ltd'),(530813,'KRBL Ltd'),(543308,'Krishna Institute of Medical Sciences Ltd'),(500249,'KSB Ltd'),(533519,'L&T Finance Holdings Ltd'),(540115,'L&T Technology Services Ltd'),(526947,'La Opala Rg Ltd.'),(500252,'Lakshmi Machine Works Ltd'),(540005,'Larsen & Toubro Infotech Ltd'),(500510,'Larsen & Toubro Ltd'),(540222,'Laurus Labs Ltd'),(543277,'Laxmi Organic Industries Ltd'),(541233,'Lemon Tree Hotels Ltd'),(500253,'LIC Housing Finance Ltd'),(523457,'Linde India Ltd'),(500257,'Lupin Ltd'),(539542,'Lux Industries Ltd'),(543287,'Macrotech Developers Ltd'),(539957,'Mahanagar Gas Ltd'),(500266,'Maharashtra Scooters Ltd.'),(532720,'Mahindra & Mahindra Financial Services Ltd'),(500520,'Mahindra & Mahindra Ltd'),(532756,'Mahindra CIE Automotive Ltd'),(533088,'Mahindra Holidays & Resorts India Ltd'),(532313,'Mahindra Lifespace Developers Ltd'),(540768,'Mahindra Logistics Ltd'),(531213,'Manappuram Finance Ltd'),(500109,'Mangalore Refinery & Petrochemicals Ltd'),(531642,'Marico Ltd'),(532500,'Maruti Suzuki India Ltd'),(540749,'MAS Financial Services Ltd'),(523704,'Mastek Ltd'),(500271,'Max Financial Services Ltd'),(543220,'Max Healthcare Institute Ltd'),(543237,'Mazagon Dock Shipbuilders Ltd'),(542650,'Metropolis Healthcare Ltd'),(538962,'Minda Corporation Ltd'),(532539,'Minda Industries Ltd'),(532819,'MindTree Ltd'),(541195,'Mishra Dhatu Nigam Ltd'),(513377,'MMTC LTD'),(533286,'MOIL Ltd'),(532892,'Motilal Oswal Financial Services Ltd'),(526299,'MphasiS Ltd'),(500290,'MRF Ltd'),(534091,'Multi Commodity Exchange of India Limited'),(533398,'Muthoot Finance Ltd'),(539551,'Narayana Hrudayalaya Ltd'),(524816,'Natco Pharma Ltd'),(532234,'National Aluminium Co Ltd'),(532504,'Navin Fluorine International Ltd.'),(534309,'NBCC (India) Ltd'),(500294,'NCC Ltd/India'),(505355,'Nesco Ltd.'),(500790,'Nestle India Ltd'),(532798,'Network 18 Media & Investments Ltd'),(533098,'NHPC Ltd'),(523385,'Nilkamal Ltd'),(540767,'Nippon Life India Asset Management Ltd'),(513683,'NLC India Ltd'),(526371,'NMDC Ltd'),(500730,'NOCIL Ltd.'),(532555,'NTPC Ltd'),(533273,'Oberoi Realty Ltd'),(500312,'Oil & Natural Gas Corp Ltd'),(533106,'Oil India Ltd'),(532466,'Oracle Financial Services Software Ltd'),(541301,'Orient Electric Ltd'),(532827,'Page Industries Ltd'),(506590,'PCBL Ltd'),(533179,'Persistent Systems Ltd'),(532522,'Petronet LNG Ltd'),(500680,'Pfizer Ltd (India)'),(503100,'Phoenix Mills Ltd'),(523642,'PI Industries Ltd'),(500331,'Pidilite Industries Ltd'),(500302,'Piramal Enterprises Ltd'),(540173,'PNB Housing Finance Ltd'),(539150,'PNC Infratech Ltd'),(531768,'Poly Medicure Ltd'),(542652,'Polycab India Ltd'),(524000,'Poonawalla Fincorp Ltd'),(532810,'Power Finance Corp Ltd'),(532898,'Power Grid Corp of India Ltd'),(522205,'Praj Industries Ltd'),(533274,'Prestige Estates Projects Ltd'),(542907,'Prince Pipes and Fittings Ltd'),(500338,'Prism Johnson Ltd'),(500126,'Procter & Gamble Health Limited'),(500459,'Procter & Gamble Hygiene & Health Care Ltd'),(532524,'PTC India Ltd'),(533295,'Punjab & Sind Bank'),(532461,'Punjab National Bank'),(532689,'PVR Ltd'),(539978,'Quess Corp Ltd'),(532497,'Radico Khaitan Ltd'),(542649,'Rail Vikas Nigam Ltd'),(500339,'Rain Industries Limited'),(531500,'Rajesh Exports Ltd'),(500355,'Rallis India Ltd'),(500260,'Ramco Cements Ltd'),(524230,'Rashtriya Chemicals & Fertilizers Ltd.'),(520111,'Ratnamani Metals & Tubes Ltd'),(540065,'RBL Bank Ltd'),(532955,'REC Ltd'),(532805,'Redington India Ltd'),(530517,'Relaxo Footwears Ltd'),(500325,'Reliance Industries Ltd'),(505509,'Responsive Industries Ltd.'),(543248,'Restaurant Brands Asia Ltd'),(534076,'Rhi Magnesita India Ltd'),(541556,'RITES Ltd'),(543213,'Rossari Biotech Ltd'),(543228,'Route Mobile Ltd'),(500368,'Ruchi Soya Industries Ltd'),(500674,'Sanofi India Ltd'),(532163,'Saregama India Ltd'),(543066,'SBI Cards and Payment Services Limited'),(540719,'SBI Life Insurance Company Ltd'),(505790,'Schaeffler India Ltd'),(512529,'Sequent Scientific Ltd'),(540203,'Sheela Foam Ltd'),(530549,'Shilpa Medicare Ltd'),(523598,'Shipping Corp of India Ltd'),(500387,'Shree Cement Ltd'),(532498,'Shriram City Union Finance Ltd.'),(511218,'Shriram Transport Finance Co Ltd'),(543299,'Shyam Metalics and Energy Ltd'),(500550,'Siemens India Ltd'),(540673,'SIS Limited'),(533206,'SJVN Ltd'),(500472,'SKF India Ltd'),(532784,'Sobha Limited'),(532725,'Solar Industries India Ltd'),(541540,'Solara Active Pharma Sciences Ltd'),(543300,'Sona BLW Precision Forgings Ltd'),(532221,'Sonata Software Ltd'),(542759,'Spandana Sphoorty Financial Ltd'),(500285,'SpiceJet Ltd.'),(503806,'SRF Ltd'),(540575,'Star Cement Ltd'),(500112,'State Bank of India'),(500113,'Steel Authority of India Ltd'),(542760,'Sterling and Wilson Renewable Energy Ltd'),(532374,'Sterlite Technologies Ltd.'),(532531,'Strides Pharma Science Ltd'),(506655,'Sudarshan Chemical Industries'),(542920,'Sumitomo Chemical India Ltd'),(532872,'Sun Pharma Advanced Research Co Ltd'),(524715,'Sun Pharmaceutical Industries Ltd'),(532733,'Sun TV Network Ltd'),(520056,'Sundaram Clayton Ltd'),(500403,'Sundaram Fastners'),(512179,'Sunteck Realty Ltd'),(509930,'Supreme Industries'),(543064,'Suven Pharmaceuticals Limited'),(532667,'Suzlon Energy Ltd'),(503310,'Swan Energy Ltd.'),(517385,'Symphony Ltd'),(539268,'Syngene International Ltd'),(532790,'Tanla Platforms Ltd'),(519091,'Tasty Bite Eatables Ltd'),(500770,'Tata Chemicals Ltd'),(532301,'Tata Coffee Ltd.'),(500483,'Tata Communications Ltd'),(532540,'Tata Consultancy Services Ltd'),(500800,'Tata Consumer Products Ltd'),(500408,'Tata Elxsi Ltd'),(501301,'Tata Investment Corp Ltd'),(513434,'Tata Metaliks Ltd.'),(500570,'Tata Motors Ltd'),(570001,'Tata Motors Ltd DVR'),(500400,'Tata Power Co Ltd'),(500470,'Tata Steel Ltd'),(532371,'Tata Teleservices Maharashtra Ltd'),(540212,'TCI Express Ltd'),(541700,'TCNS Clothing Co. Ltd'),(539658,'TeamLease Services Ltd'),(532755,'Tech Mahindra Ltd'),(540769,'The New India Assurance Company Ltd'),(500411,'Thermax Ltd'),(539871,'Thyrocare Technologies Ltd'),(522113,'Timken India Ltd.'),(500114,'Titan Co Ltd'),(500420,'Torrent Pharmaceuticals Ltd'),(532779,'Torrent Power Ltd'),(500251,'Trent Ltd.'),(521064,'Trident Ltd.'),(533655,'Triveni Turbine Limited'),(517506,'TTK Prestige Ltd'),(540762,'Tube Investments Of India'),(532800,'TV18 Broadcast Ltd'),(532343,'TVS Motor Co Ltd'),(532505,'UCO Bank'),(500148,'Uflex Ltd'),(542904,'Ujjivan Small Finance Bank Ltd'),(532538,'UltraTech Cement Ltd'),(532477,'Union Bank of India'),(532478,'United Breweries Ltd'),(512070,'UPL Ltd'),(543238,'UTI Asset Management Company Ltd'),(532953,'V-Guard Industries Ltd'),(534976,'V-Mart Retail Limited'),(532156,'Vaibhav Global Ltd'),(511431,'Vakrangee Ltd'),(502986,'Vardhman Textiles Ltd.'),(541578,'Varroc Engineering Ltd'),(540180,'Varun Beverages Ltd'),(500295,'Vedanta Ltd'),(523261,'Venky''s India Ltd'),(524200,'Vinati Organics Ltd'),(507880,'VIP Industries Ltd'),(532822,'Vodafone Idea Ltd'),(500575,'Voltas Ltd'),(509966,'VST Industries Ltd.'),(532144,'Welspun Corp Ltd'),(514162,'Welspun India Ltd.'),(505533,'Westlife Development Ltd'),(500238,'Whirlpool of India Ltd'),(507685,'Wipro Ltd'),(532300,'Wockhardt Ltd'),(532648,'Yes Bank Ltd'),(505537,'Zee Entertainment Enterprises Ltd'),(504067,'Zensar Technologies Ltd'),(533023,'ZF Commercial Vehicle Control Systems India Ltd'),(543320,'Zomato Ltd'),(532321,'Zydus Lifesciences Ltd'),(531335,'Zydus Wellness Ltd')
	    ) 
	    select 
	    stock_code, 
	    stock_name, 
	    (
	        with sma as (
	        SELECT 
	            trade_date, 
	            close, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 19 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma20, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 49 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma50, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 199 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma200 
	        FROM 
	            bse 
	        where 
	            code = indices.stock_code
	        ), 
	        delta as(
	        select 
	            *, 
	            lead(sma200, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma200, 
	            lead(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma50, 
	            lag(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as prev_sma50 
	        from 
	            sma
	        ), 
	        rising as (
	        select 
	            *, 
	            case when next_sma200 - sma200 > 0 then TRUE else FALSE end is_sma200_rising, 
	            case when prev_sma50 < sma200 
	            and next_sma50 > sma200 then TRUE else FALSE end goldencross 
	        from 
	            delta
	        ), 
	        top5 as (
	        select 
	            * 
	        from 
	            rising 
	        order by 
	            trade_date desc 
	        limit 
	            1, 
	            5
	        ) 
	        select 
	        case when sum(is_sma200_rising) = 5 
	        and sum(goldencross) > 0 then TRUE else FALSE end tudor_trading_signal 
	        from 
	        top5
	    ) as tudor_trade 
	    from 
	    indices 
	    where 
	    tudor_trade > 0   
	    
2022-06-02 01:41:35.429 IST [8956] ERROR:  function sum(boolean) does not exist at character 18419
2022-06-02 01:41:35.429 IST [8956] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-06-02 01:41:35.429 IST [8956] STATEMENT:  
	    with indices(stock_code, stock_name) as (
	    values 
	    (523395,'3M India Ltd'),(524348,'Aarti Drugs Ltd'),(524208,'Aarti Industries Ltd.'),(541988,'AAVAS Financiers Ltd'),(500002,'ABB India Ltd'),(500488,'Abbott India Ltd'),(500410,'ACC Ltd'),(512599,'Adani Enterprises Ltd'),(541450,'Adani Green Energy Ltd'),(532921,'Adani Ports and Special Economic Zone'),(533096,'Adani Power Ltd'),(542066,'Adani Total Gas Limited'),(539254,'Adani Transmission Ltd'),(540691,'Aditya Birla Capital Ltd'),(535755,'Aditya Birla Fashion and Retail Ltd'),(540025,'Advanced Enzyme Technologies Ltd'),(500003,'Aegis Logistics Ltd'),(542752,'Affle (India) Ltd'),(532683,'AIA Engineering Ltd'),(532331,'Ajanta Pharma Ltd'),(500710,'Akzo Nobel India Ltd'),(533573,'Alembic Pharmaceuticals Ltd'),(539523,'Alkem Laboratories Ltd'),(506767,'Alkyl Amines Chemicals Ltd'),(532749,'AllCargo Logistics Ltd'),(521070,'Alok Industries Ltd'),(500008,'Amara Raja Batteries Ltd'),(540902,'Amber Enterprises India Ltd'),(500425,'Ambuja Cements Ltd'),(543235,'Angel One Limited'),(543275,'Anupam Rasayan India Ltd'),(533758,'APL Apollo Tubes Ltd'),(508869,'Apollo Hospitals Enterprise Ltd'),(500877,'Apollo Tyres Ltd'),(515030,'Asahi India Glass Ltd'),(500477,'Ashok Leyland Ltd'),(500820,'Asian Paints Ltd'),(540975,'Aster DM Healthcare Ltd'),(532830,'ASTRAL LIMITED'),(506820,'AstraZeneca Pharm India'),(500027,'Atul Ltd.'),(540611,'AU Small Finance Bank Ltd'),(524804,'Aurobindo Pharma Ltd'),(512573,'Avanti Feeds Ltd'),(540376,'Avenue Supermarts Ltd'),(532215,'Axis Bank Ltd'),(532977,'Bajaj Auto Ltd'),(533229,'Bajaj Consumer Care Ltd'),(500031,'Bajaj Electricals Ltd'),(500034,'Bajaj Finance Ltd'),(532978,'Bajaj Finserv Ltd'),(500490,'Bajaj Holdings and Investment Ltd'),(530999,'Balaji Amines Ltd'),(502355,'Balkrishna Industries Ltd'),(500038,'Balrampur Chini Mills Ltd'),(541153,'Bandhan Bank Ltd'),(532134,'Bank of Baroda'),(532149,'Bank of India'),(532525,'Bank Of Maharashtra'),(500042,'BASF India Limited'),(500043,'Bata India Ltimited'),(506285,'Bayer CropScience Ltd/India'),(500048,'BEML Ltd'),(509480,'Berger Paints India Ltd'),(541143,'Bharat Dynamics Ltd'),(500049,'Bharat Electronics Ltd'),(500493,'Bharat Forge Ltd'),(500103,'Bharat Heavy Electricals Ltd'),(500547,'Bharat Petroleum Corp Ltd'),(532454,'Bharti Airtel Ltd'),(532523,'Biocon Ltd'),(500335,'Birla Corp Ltd'),(532400,'Birlasoft Ltd'),(526612,'Blue Dart Express Ltd'),(500067,'Blue Star Ltd'),(501425,'Bombay Burmah Trading Corp Ltd.'),(500530,'Bosch Ltd'),(532929,'Brigade Enterprises Ltd'),(532368,'Brightcom Group Ltd'),(500825,'Britannia Industries Ltd.'),(511196,'Can Fin Homes Ltd'),(532483,'Canara Bank'),(524742,'Caplin Point Laboratories Ltd'),(531595,'Capri Global Capital  LTD'),(513375,'Carborundum Universal Ltd'),(500870,'Castrol India Ltd'),(519600,'CCL Products (India) Ltd.'),(500878,'CEAT Ltd'),(532885,'Central Bank of India'),(532548,'Century Plyboards India Ltd'),(500040,'Century Textile & Industries Ltd'),(532443,'Cera Sanitaryware Ltd'),(500084,'CESC Ltd'),(542399,'Chalet Hotels Ltd'),(500085,'Chambal Fertilizers & Chemicals Ltd'),(504973,'Cholamandalam Financial Holdings Ltd'),(511243,'Cholamandalam Investment & Finance Co. Ltd.'),(500087,'Cipla Ltd/India'),(532210,'City Union Bank Ltd.'),(533278,'Coal India Ltd'),(540678,'Cochin Shipyard Ltd'),(532541,'Coforge Ltd'),(500830,'Colgate-Palmolive India Ltd'),(543232,'Computer Age Management Services Ltd'),(531344,'Container Corp Of India'),(506395,'Coromandel International Ltd'),(541770,'CreditAccess Grameen Ltd'),(500092,'CRISIL Ltd'),(539876,'Crompton Greaves Consumer Electricals Ltd'),(542867,'CSB Bank Ltd'),(500480,'Cummins India Ltd'),(532175,'Cyient Ltd'),(500096,'Dabur India Ltd'),(542216,'Dalmia Bharat Ltd'),(532772,'DCB Bank Ltd'),(523367,'DCM Shriram Ltd'),(500645,'Deepak Fertilisers & Petrochemicals Corp. Ltd.'),(506401,'Deepak Nitrite Limited'),(532848,'Delta Corp. Ltd.'),(507717,'Dhanuka Agritech Ltd'),(540047,'Dilip Buildcon Ltd'),(540701,'Dishman Carbogen Amics Ltd'),(532488,'Divi''s Laboratories Ltd'),(540699,'Dixon Technologies (India) Ltd'),(532868,'DLF Ltd'),(500124,'Dr Reddy''s Laboratories Ltd'),(539524,'Dr. Lal PathLabs Ltd'),(532927,'eClerx Services Ltd'),(532922,'Edelweiss Financial Services Ltd'),(505200,'Eicher Motors Ltd'),(500125,'EID Parry India Ltd'),(500840,'EIH Ltd'),(522074,'Elgi Equipments Ltd.'),(531162,'Emami Ltd'),(540153,'Endurance Technologies Ltd'),(532178,'Engineers India Ltd'),(500135,'EPL Ltd'),(539844,'Equitas Holdings Ltd'),(543243,'Equitas Small Finance Bank Ltd'),(540596,'Eris Lifesciences Ltd'),(500133,'Esab India Ltd'),(500495,'Escorts Ltd'),(500086,'Exide Industries Ltd'),(531599,'FDC Ltd'),(500469,'Federal Bank Ltd'),(541557,'Fine Organic Industries Ltd'),(500144,'Finolex Cables Ltd'),(500940,'Finolex Industries Ltd'),(532809,'Firstsource Solutions Ltd'),(532843,'Fortis Healthcare Ltd.'),(532155,'Gail India Ltd'),(540935,'Galaxy Surfactants Ltd'),(509557,'Garware Technical Fibres Ltd'),(540755,'General Insurance Corporation of India'),(500171,'GHCL Ltd'),(507815,'Gillette India Ltd'),(543245,'Gland Pharma Ltd'),(500660,'GlaxoSmithKline Pharmaceuticals Ltd'),(532296,'Glenmark Pharmaceuticals Ltd'),(505255,'GMM Pfaudler Limited'),(500163,'Godfrey Phillips India Ltd'),(540743,'Godrej Agrovet Ltd'),(532424,'Godrej Consumer Products Ltd'),(500164,'Godrej Industries Ltd'),(533150,'Godrej Properties Ltd'),(532482,'Granules India Ltd'),(509488,'Graphite India Ltd.'),(500300,'Grasim Industries Ltd'),(500620,'Great Eastern Shipping Co Ltd/The'),(501455,'Greaves Cotton Ltd.'),(506076,'Grindwell Norton Ltd'),(530001,'Gujarat Alkalies & Chemicals Ltd.'),(542812,'Gujarat Fluorochemicals Ltd'),(539336,'Gujarat Gas Ltd'),(500670,'Gujarat Narmada Valley Fertilizers and Chemicals Limited'),(533248,'Gujarat Pipavav Port Ltd'),(500690,'Gujarat State Fertilisers & Chemicals Ltd'),(532702,'Gujarat State Petronet Ltd'),(538567,'Gulf Oil Lubricants India Ltd'),(543227,'Happiest Minds Technologies Ltd'),(533162,'Hathway Cables and Datacom Ltd'),(531531,'Hatsun Agro Products Ltd'),(517354,'Havells India Ltd'),(508486,'HawkiBO Cookers Ltd'),(532281,'HCL Technologies Ltd'),(541729,'HDFC Asset Management Company Ltd'),(500180,'HDFC Bank Ltd'),(540777,'HDFC Life Insurance Company Ltd'),(509631,'HEG Ltd'),(500292,'HeidelbergCement India Ltd.'),(500182,'Hero MotoCorp Ltd'),(500183,'HFCL Ltd'),(524735,'Hikal Ltd.'),(500440,'Hindalco Industries Ltd'),(541154,'Hindustan Aeronautics Ltd'),(513599,'Hindustan Copper'),(500104,'Hindustan Petroleum Corp Ltd'),(500696,'Hindustan Unilever Ltd'),(500188,'Hindustan Zinc Ltd'),(543187,'Hitachi Energy India Ltd'),(517174,'Honeywell Automation India Ltd'),(540530,'Housing and Urban Development Corporation Ltd'),(500010,'Housing Development Finance Corp'),(532174,'ICICI Bank Ltd'),(540716,'ICICI Lombard General Insurance Company Ltd'),(540133,'ICICI Prudential Life Insurance Company Ltd'),(541179,'ICICI Securities Ltd'),(500116,'IDBI Bank Ltd'),(539437,'IDFC First Bank Ltd'),(532659,'IDFC Limited'),(505726,'IFB Industries Ltd'),(532636,'IIFL Finance Ltd'),(542772,'IIFL Wealth Management Ltd'),(530005,'India Cements Ltd'),(532189,'India Tourism Development Corp Ltd'),(535789,'Indiabulls Housing Finance Limited'),(532832,'Indiabulls Real Estate Ltd'),(542726,'Indiamart Intermesh Limited'),(532814,'Indian Bank'),(540750,'Indian Energy Exchange Ltd'),(500850,'Indian Hotels Co Ltd'),(530965,'Indian Oil Corp Ltd'),(532388,'Indian Overseas Bank'),(542830,'Indian Railway Catering and Tourism Corporation Ltd'),(543257,'Indian Railway Finance Corporation Limited'),(543258,'Indigo Paints Ltd'),(532612,'Indoco Remedies Ltd.'),(541336,'Indostar Capital Finance Ltd'),(532514,'Indraprastha Gas Ltd'),(534816,'Indus Towers Ltd'),(532187,'IndusInd Bank Ltd'),(539807,'Infibeam Avenues Ltd'),(532777,'Info Edge (India) Ltd.'),(500209,'Infosys Ltd'),(532706,'Inox Leisure'),(538835,'Intellect Design Arena Ltd.'),(539448,'InterGlobe Aviation Ltd'),(524164,'IOL Chemicals and Pharmaceuticals Ltd'),(524494,'Ipca Laboratories Ltd'),(532947,'IRB Infrastructure Developers Ltd'),(541956,'IRCON International Ltd'),(500875,'ITC Ltd'),(523610,'ITI Ltd'),(530007,'J. K. Tyre Industries Ltd'),(506943,'J.B.Chemicals & Pharmaceuticals Ltd.'),(532644,'J.K. Cement Ltd.'),(520051,'Jamna Auto Industries Ltd'),(500378,'Jindal SAW Ltd'),(539597,'Jindal Stainless (Hisar) Ltd'),(532508,'Jindal Stainless Ltd.'),(532286,'Jindal Steel & Power Ltd'),(500380,'JK Lakshmi Cement Ltd'),(532162,'JK Paper Ltd.'),(523405,'JM Financial Ltd'),(523398,'Johnson Controls -Hitachi Air Conditioning India Ltd'),(533148,'JSW Energy Ltd'),(500228,'JSW Steel Ltd'),(533155,'Jubilant FoodWorks Ltd'),(543271,'Jubilant Ingrevia Limited'),(530019,'Jubilant Pharmova Sciences Ltd'),(535648,'Just Dial Ltd'),(532926,'Jyothy Labs Ltd'),(500233,'Kajaria Ceramics Ltd.'),(522287,'Kalpataru Power Transmission Ltd'),(543278,'Kalyan Jewellers India Ltd'),(500165,'Kansai Nerolac Paints Ltd.'),(532899,'Kaveri Seed Co Ltd'),(532714,'KEC International Ltd/India'),(517569,'KEI Industries Ltd'),(540680,'KIOCL Ltd'),(532942,'KNR Constructions Ltd'),(500247,'Kotak Mahindra Bank Ltd'),(542651,'KPIT Technologies Ltd'),(532889,'KPR Mill Ltd'),(530813,'KRBL Ltd'),(543308,'Krishna Institute of Medical Sciences Ltd'),(500249,'KSB Ltd'),(533519,'L&T Finance Holdings Ltd'),(540115,'L&T Technology Services Ltd'),(526947,'La Opala Rg Ltd.'),(500252,'Lakshmi Machine Works Ltd'),(540005,'Larsen & Toubro Infotech Ltd'),(500510,'Larsen & Toubro Ltd'),(540222,'Laurus Labs Ltd'),(543277,'Laxmi Organic Industries Ltd'),(541233,'Lemon Tree Hotels Ltd'),(500253,'LIC Housing Finance Ltd'),(523457,'Linde India Ltd'),(500257,'Lupin Ltd'),(539542,'Lux Industries Ltd'),(543287,'Macrotech Developers Ltd'),(539957,'Mahanagar Gas Ltd'),(500266,'Maharashtra Scooters Ltd.'),(532720,'Mahindra & Mahindra Financial Services Ltd'),(500520,'Mahindra & Mahindra Ltd'),(532756,'Mahindra CIE Automotive Ltd'),(533088,'Mahindra Holidays & Resorts India Ltd'),(532313,'Mahindra Lifespace Developers Ltd'),(540768,'Mahindra Logistics Ltd'),(531213,'Manappuram Finance Ltd'),(500109,'Mangalore Refinery & Petrochemicals Ltd'),(531642,'Marico Ltd'),(532500,'Maruti Suzuki India Ltd'),(540749,'MAS Financial Services Ltd'),(523704,'Mastek Ltd'),(500271,'Max Financial Services Ltd'),(543220,'Max Healthcare Institute Ltd'),(543237,'Mazagon Dock Shipbuilders Ltd'),(542650,'Metropolis Healthcare Ltd'),(538962,'Minda Corporation Ltd'),(532539,'Minda Industries Ltd'),(532819,'MindTree Ltd'),(541195,'Mishra Dhatu Nigam Ltd'),(513377,'MMTC LTD'),(533286,'MOIL Ltd'),(532892,'Motilal Oswal Financial Services Ltd'),(526299,'MphasiS Ltd'),(500290,'MRF Ltd'),(534091,'Multi Commodity Exchange of India Limited'),(533398,'Muthoot Finance Ltd'),(539551,'Narayana Hrudayalaya Ltd'),(524816,'Natco Pharma Ltd'),(532234,'National Aluminium Co Ltd'),(532504,'Navin Fluorine International Ltd.'),(534309,'NBCC (India) Ltd'),(500294,'NCC Ltd/India'),(505355,'Nesco Ltd.'),(500790,'Nestle India Ltd'),(532798,'Network 18 Media & Investments Ltd'),(533098,'NHPC Ltd'),(523385,'Nilkamal Ltd'),(540767,'Nippon Life India Asset Management Ltd'),(513683,'NLC India Ltd'),(526371,'NMDC Ltd'),(500730,'NOCIL Ltd.'),(532555,'NTPC Ltd'),(533273,'Oberoi Realty Ltd'),(500312,'Oil & Natural Gas Corp Ltd'),(533106,'Oil India Ltd'),(532466,'Oracle Financial Services Software Ltd'),(541301,'Orient Electric Ltd'),(532827,'Page Industries Ltd'),(506590,'PCBL Ltd'),(533179,'Persistent Systems Ltd'),(532522,'Petronet LNG Ltd'),(500680,'Pfizer Ltd (India)'),(503100,'Phoenix Mills Ltd'),(523642,'PI Industries Ltd'),(500331,'Pidilite Industries Ltd'),(500302,'Piramal Enterprises Ltd'),(540173,'PNB Housing Finance Ltd'),(539150,'PNC Infratech Ltd'),(531768,'Poly Medicure Ltd'),(542652,'Polycab India Ltd'),(524000,'Poonawalla Fincorp Ltd'),(532810,'Power Finance Corp Ltd'),(532898,'Power Grid Corp of India Ltd'),(522205,'Praj Industries Ltd'),(533274,'Prestige Estates Projects Ltd'),(542907,'Prince Pipes and Fittings Ltd'),(500338,'Prism Johnson Ltd'),(500126,'Procter & Gamble Health Limited'),(500459,'Procter & Gamble Hygiene & Health Care Ltd'),(532524,'PTC India Ltd'),(533295,'Punjab & Sind Bank'),(532461,'Punjab National Bank'),(532689,'PVR Ltd'),(539978,'Quess Corp Ltd'),(532497,'Radico Khaitan Ltd'),(542649,'Rail Vikas Nigam Ltd'),(500339,'Rain Industries Limited'),(531500,'Rajesh Exports Ltd'),(500355,'Rallis India Ltd'),(500260,'Ramco Cements Ltd'),(524230,'Rashtriya Chemicals & Fertilizers Ltd.'),(520111,'Ratnamani Metals & Tubes Ltd'),(540065,'RBL Bank Ltd'),(532955,'REC Ltd'),(532805,'Redington India Ltd'),(530517,'Relaxo Footwears Ltd'),(500325,'Reliance Industries Ltd'),(505509,'Responsive Industries Ltd.'),(543248,'Restaurant Brands Asia Ltd'),(534076,'Rhi Magnesita India Ltd'),(541556,'RITES Ltd'),(543213,'Rossari Biotech Ltd'),(543228,'Route Mobile Ltd'),(500368,'Ruchi Soya Industries Ltd'),(500674,'Sanofi India Ltd'),(532163,'Saregama India Ltd'),(543066,'SBI Cards and Payment Services Limited'),(540719,'SBI Life Insurance Company Ltd'),(505790,'Schaeffler India Ltd'),(512529,'Sequent Scientific Ltd'),(540203,'Sheela Foam Ltd'),(530549,'Shilpa Medicare Ltd'),(523598,'Shipping Corp of India Ltd'),(500387,'Shree Cement Ltd'),(532498,'Shriram City Union Finance Ltd.'),(511218,'Shriram Transport Finance Co Ltd'),(543299,'Shyam Metalics and Energy Ltd'),(500550,'Siemens India Ltd'),(540673,'SIS Limited'),(533206,'SJVN Ltd'),(500472,'SKF India Ltd'),(532784,'Sobha Limited'),(532725,'Solar Industries India Ltd'),(541540,'Solara Active Pharma Sciences Ltd'),(543300,'Sona BLW Precision Forgings Ltd'),(532221,'Sonata Software Ltd'),(542759,'Spandana Sphoorty Financial Ltd'),(500285,'SpiceJet Ltd.'),(503806,'SRF Ltd'),(540575,'Star Cement Ltd'),(500112,'State Bank of India'),(500113,'Steel Authority of India Ltd'),(542760,'Sterling and Wilson Renewable Energy Ltd'),(532374,'Sterlite Technologies Ltd.'),(532531,'Strides Pharma Science Ltd'),(506655,'Sudarshan Chemical Industries'),(542920,'Sumitomo Chemical India Ltd'),(532872,'Sun Pharma Advanced Research Co Ltd'),(524715,'Sun Pharmaceutical Industries Ltd'),(532733,'Sun TV Network Ltd'),(520056,'Sundaram Clayton Ltd'),(500403,'Sundaram Fastners'),(512179,'Sunteck Realty Ltd'),(509930,'Supreme Industries'),(543064,'Suven Pharmaceuticals Limited'),(532667,'Suzlon Energy Ltd'),(503310,'Swan Energy Ltd.'),(517385,'Symphony Ltd'),(539268,'Syngene International Ltd'),(532790,'Tanla Platforms Ltd'),(519091,'Tasty Bite Eatables Ltd'),(500770,'Tata Chemicals Ltd'),(532301,'Tata Coffee Ltd.'),(500483,'Tata Communications Ltd'),(532540,'Tata Consultancy Services Ltd'),(500800,'Tata Consumer Products Ltd'),(500408,'Tata Elxsi Ltd'),(501301,'Tata Investment Corp Ltd'),(513434,'Tata Metaliks Ltd.'),(500570,'Tata Motors Ltd'),(570001,'Tata Motors Ltd DVR'),(500400,'Tata Power Co Ltd'),(500470,'Tata Steel Ltd'),(532371,'Tata Teleservices Maharashtra Ltd'),(540212,'TCI Express Ltd'),(541700,'TCNS Clothing Co. Ltd'),(539658,'TeamLease Services Ltd'),(532755,'Tech Mahindra Ltd'),(540769,'The New India Assurance Company Ltd'),(500411,'Thermax Ltd'),(539871,'Thyrocare Technologies Ltd'),(522113,'Timken India Ltd.'),(500114,'Titan Co Ltd'),(500420,'Torrent Pharmaceuticals Ltd'),(532779,'Torrent Power Ltd'),(500251,'Trent Ltd.'),(521064,'Trident Ltd.'),(533655,'Triveni Turbine Limited'),(517506,'TTK Prestige Ltd'),(540762,'Tube Investments Of India'),(532800,'TV18 Broadcast Ltd'),(532343,'TVS Motor Co Ltd'),(532505,'UCO Bank'),(500148,'Uflex Ltd'),(542904,'Ujjivan Small Finance Bank Ltd'),(532538,'UltraTech Cement Ltd'),(532477,'Union Bank of India'),(532478,'United Breweries Ltd'),(512070,'UPL Ltd'),(543238,'UTI Asset Management Company Ltd'),(532953,'V-Guard Industries Ltd'),(534976,'V-Mart Retail Limited'),(532156,'Vaibhav Global Ltd'),(511431,'Vakrangee Ltd'),(502986,'Vardhman Textiles Ltd.'),(541578,'Varroc Engineering Ltd'),(540180,'Varun Beverages Ltd'),(500295,'Vedanta Ltd'),(523261,'Venky''s India Ltd'),(524200,'Vinati Organics Ltd'),(507880,'VIP Industries Ltd'),(532822,'Vodafone Idea Ltd'),(500575,'Voltas Ltd'),(509966,'VST Industries Ltd.'),(532144,'Welspun Corp Ltd'),(514162,'Welspun India Ltd.'),(505533,'Westlife Development Ltd'),(500238,'Whirlpool of India Ltd'),(507685,'Wipro Ltd'),(532300,'Wockhardt Ltd'),(532648,'Yes Bank Ltd'),(505537,'Zee Entertainment Enterprises Ltd'),(504067,'Zensar Technologies Ltd'),(533023,'ZF Commercial Vehicle Control Systems India Ltd'),(543320,'Zomato Ltd'),(532321,'Zydus Lifesciences Ltd'),(531335,'Zydus Wellness Ltd')
	    ) 
	    select 
	    stock_code, 
	    stock_name, 
	    (
	        with sma as (
	        SELECT 
	            trade_date, 
	            close, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 19 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma20, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 49 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma50, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 199 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma200 
	        FROM 
	            bse 
	        where 
	            code = indices.stock_code
	        ), 
	        delta as(
	        select 
	            *, 
	            lead(sma200, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma200, 
	            lead(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma50, 
	            lag(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as prev_sma50 
	        from 
	            sma
	        ), 
	        rising as (
	        select 
	            *, 
	            case when next_sma200 - sma200 > 0 then TRUE else FALSE end is_sma200_rising, 
	            case when prev_sma50 < sma200 
	            and next_sma50 > sma200 then TRUE else FALSE end goldencross 
	        from 
	            delta
	        ), 
	        top5 as (
	        select 
	            * 
	        from 
	            rising 
	        order by 
	            trade_date desc 
	        limit 
	            1 
	        offset    5
	        ) 
	        select 
	        case when sum(is_sma200_rising) = 5 
	        and sum(goldencross) > 0 then TRUE else FALSE end tudor_trading_signal 
	        from 
	        top5
	    ) as tudor_trade 
	    from 
	    indices 
	    where 
	    tudor_trade > 0   
	    
2022-06-02 01:41:57.204 IST [8956] ERROR:  syntax error at or near "(" at character 18467
2022-06-02 01:41:57.204 IST [8956] STATEMENT:  
	    with indices(stock_code, stock_name) as (
	    values 
	    (523395,'3M India Ltd'),(524348,'Aarti Drugs Ltd'),(524208,'Aarti Industries Ltd.'),(541988,'AAVAS Financiers Ltd'),(500002,'ABB India Ltd'),(500488,'Abbott India Ltd'),(500410,'ACC Ltd'),(512599,'Adani Enterprises Ltd'),(541450,'Adani Green Energy Ltd'),(532921,'Adani Ports and Special Economic Zone'),(533096,'Adani Power Ltd'),(542066,'Adani Total Gas Limited'),(539254,'Adani Transmission Ltd'),(540691,'Aditya Birla Capital Ltd'),(535755,'Aditya Birla Fashion and Retail Ltd'),(540025,'Advanced Enzyme Technologies Ltd'),(500003,'Aegis Logistics Ltd'),(542752,'Affle (India) Ltd'),(532683,'AIA Engineering Ltd'),(532331,'Ajanta Pharma Ltd'),(500710,'Akzo Nobel India Ltd'),(533573,'Alembic Pharmaceuticals Ltd'),(539523,'Alkem Laboratories Ltd'),(506767,'Alkyl Amines Chemicals Ltd'),(532749,'AllCargo Logistics Ltd'),(521070,'Alok Industries Ltd'),(500008,'Amara Raja Batteries Ltd'),(540902,'Amber Enterprises India Ltd'),(500425,'Ambuja Cements Ltd'),(543235,'Angel One Limited'),(543275,'Anupam Rasayan India Ltd'),(533758,'APL Apollo Tubes Ltd'),(508869,'Apollo Hospitals Enterprise Ltd'),(500877,'Apollo Tyres Ltd'),(515030,'Asahi India Glass Ltd'),(500477,'Ashok Leyland Ltd'),(500820,'Asian Paints Ltd'),(540975,'Aster DM Healthcare Ltd'),(532830,'ASTRAL LIMITED'),(506820,'AstraZeneca Pharm India'),(500027,'Atul Ltd.'),(540611,'AU Small Finance Bank Ltd'),(524804,'Aurobindo Pharma Ltd'),(512573,'Avanti Feeds Ltd'),(540376,'Avenue Supermarts Ltd'),(532215,'Axis Bank Ltd'),(532977,'Bajaj Auto Ltd'),(533229,'Bajaj Consumer Care Ltd'),(500031,'Bajaj Electricals Ltd'),(500034,'Bajaj Finance Ltd'),(532978,'Bajaj Finserv Ltd'),(500490,'Bajaj Holdings and Investment Ltd'),(530999,'Balaji Amines Ltd'),(502355,'Balkrishna Industries Ltd'),(500038,'Balrampur Chini Mills Ltd'),(541153,'Bandhan Bank Ltd'),(532134,'Bank of Baroda'),(532149,'Bank of India'),(532525,'Bank Of Maharashtra'),(500042,'BASF India Limited'),(500043,'Bata India Ltimited'),(506285,'Bayer CropScience Ltd/India'),(500048,'BEML Ltd'),(509480,'Berger Paints India Ltd'),(541143,'Bharat Dynamics Ltd'),(500049,'Bharat Electronics Ltd'),(500493,'Bharat Forge Ltd'),(500103,'Bharat Heavy Electricals Ltd'),(500547,'Bharat Petroleum Corp Ltd'),(532454,'Bharti Airtel Ltd'),(532523,'Biocon Ltd'),(500335,'Birla Corp Ltd'),(532400,'Birlasoft Ltd'),(526612,'Blue Dart Express Ltd'),(500067,'Blue Star Ltd'),(501425,'Bombay Burmah Trading Corp Ltd.'),(500530,'Bosch Ltd'),(532929,'Brigade Enterprises Ltd'),(532368,'Brightcom Group Ltd'),(500825,'Britannia Industries Ltd.'),(511196,'Can Fin Homes Ltd'),(532483,'Canara Bank'),(524742,'Caplin Point Laboratories Ltd'),(531595,'Capri Global Capital  LTD'),(513375,'Carborundum Universal Ltd'),(500870,'Castrol India Ltd'),(519600,'CCL Products (India) Ltd.'),(500878,'CEAT Ltd'),(532885,'Central Bank of India'),(532548,'Century Plyboards India Ltd'),(500040,'Century Textile & Industries Ltd'),(532443,'Cera Sanitaryware Ltd'),(500084,'CESC Ltd'),(542399,'Chalet Hotels Ltd'),(500085,'Chambal Fertilizers & Chemicals Ltd'),(504973,'Cholamandalam Financial Holdings Ltd'),(511243,'Cholamandalam Investment & Finance Co. Ltd.'),(500087,'Cipla Ltd/India'),(532210,'City Union Bank Ltd.'),(533278,'Coal India Ltd'),(540678,'Cochin Shipyard Ltd'),(532541,'Coforge Ltd'),(500830,'Colgate-Palmolive India Ltd'),(543232,'Computer Age Management Services Ltd'),(531344,'Container Corp Of India'),(506395,'Coromandel International Ltd'),(541770,'CreditAccess Grameen Ltd'),(500092,'CRISIL Ltd'),(539876,'Crompton Greaves Consumer Electricals Ltd'),(542867,'CSB Bank Ltd'),(500480,'Cummins India Ltd'),(532175,'Cyient Ltd'),(500096,'Dabur India Ltd'),(542216,'Dalmia Bharat Ltd'),(532772,'DCB Bank Ltd'),(523367,'DCM Shriram Ltd'),(500645,'Deepak Fertilisers & Petrochemicals Corp. Ltd.'),(506401,'Deepak Nitrite Limited'),(532848,'Delta Corp. Ltd.'),(507717,'Dhanuka Agritech Ltd'),(540047,'Dilip Buildcon Ltd'),(540701,'Dishman Carbogen Amics Ltd'),(532488,'Divi''s Laboratories Ltd'),(540699,'Dixon Technologies (India) Ltd'),(532868,'DLF Ltd'),(500124,'Dr Reddy''s Laboratories Ltd'),(539524,'Dr. Lal PathLabs Ltd'),(532927,'eClerx Services Ltd'),(532922,'Edelweiss Financial Services Ltd'),(505200,'Eicher Motors Ltd'),(500125,'EID Parry India Ltd'),(500840,'EIH Ltd'),(522074,'Elgi Equipments Ltd.'),(531162,'Emami Ltd'),(540153,'Endurance Technologies Ltd'),(532178,'Engineers India Ltd'),(500135,'EPL Ltd'),(539844,'Equitas Holdings Ltd'),(543243,'Equitas Small Finance Bank Ltd'),(540596,'Eris Lifesciences Ltd'),(500133,'Esab India Ltd'),(500495,'Escorts Ltd'),(500086,'Exide Industries Ltd'),(531599,'FDC Ltd'),(500469,'Federal Bank Ltd'),(541557,'Fine Organic Industries Ltd'),(500144,'Finolex Cables Ltd'),(500940,'Finolex Industries Ltd'),(532809,'Firstsource Solutions Ltd'),(532843,'Fortis Healthcare Ltd.'),(532155,'Gail India Ltd'),(540935,'Galaxy Surfactants Ltd'),(509557,'Garware Technical Fibres Ltd'),(540755,'General Insurance Corporation of India'),(500171,'GHCL Ltd'),(507815,'Gillette India Ltd'),(543245,'Gland Pharma Ltd'),(500660,'GlaxoSmithKline Pharmaceuticals Ltd'),(532296,'Glenmark Pharmaceuticals Ltd'),(505255,'GMM Pfaudler Limited'),(500163,'Godfrey Phillips India Ltd'),(540743,'Godrej Agrovet Ltd'),(532424,'Godrej Consumer Products Ltd'),(500164,'Godrej Industries Ltd'),(533150,'Godrej Properties Ltd'),(532482,'Granules India Ltd'),(509488,'Graphite India Ltd.'),(500300,'Grasim Industries Ltd'),(500620,'Great Eastern Shipping Co Ltd/The'),(501455,'Greaves Cotton Ltd.'),(506076,'Grindwell Norton Ltd'),(530001,'Gujarat Alkalies & Chemicals Ltd.'),(542812,'Gujarat Fluorochemicals Ltd'),(539336,'Gujarat Gas Ltd'),(500670,'Gujarat Narmada Valley Fertilizers and Chemicals Limited'),(533248,'Gujarat Pipavav Port Ltd'),(500690,'Gujarat State Fertilisers & Chemicals Ltd'),(532702,'Gujarat State Petronet Ltd'),(538567,'Gulf Oil Lubricants India Ltd'),(543227,'Happiest Minds Technologies Ltd'),(533162,'Hathway Cables and Datacom Ltd'),(531531,'Hatsun Agro Products Ltd'),(517354,'Havells India Ltd'),(508486,'HawkiBO Cookers Ltd'),(532281,'HCL Technologies Ltd'),(541729,'HDFC Asset Management Company Ltd'),(500180,'HDFC Bank Ltd'),(540777,'HDFC Life Insurance Company Ltd'),(509631,'HEG Ltd'),(500292,'HeidelbergCement India Ltd.'),(500182,'Hero MotoCorp Ltd'),(500183,'HFCL Ltd'),(524735,'Hikal Ltd.'),(500440,'Hindalco Industries Ltd'),(541154,'Hindustan Aeronautics Ltd'),(513599,'Hindustan Copper'),(500104,'Hindustan Petroleum Corp Ltd'),(500696,'Hindustan Unilever Ltd'),(500188,'Hindustan Zinc Ltd'),(543187,'Hitachi Energy India Ltd'),(517174,'Honeywell Automation India Ltd'),(540530,'Housing and Urban Development Corporation Ltd'),(500010,'Housing Development Finance Corp'),(532174,'ICICI Bank Ltd'),(540716,'ICICI Lombard General Insurance Company Ltd'),(540133,'ICICI Prudential Life Insurance Company Ltd'),(541179,'ICICI Securities Ltd'),(500116,'IDBI Bank Ltd'),(539437,'IDFC First Bank Ltd'),(532659,'IDFC Limited'),(505726,'IFB Industries Ltd'),(532636,'IIFL Finance Ltd'),(542772,'IIFL Wealth Management Ltd'),(530005,'India Cements Ltd'),(532189,'India Tourism Development Corp Ltd'),(535789,'Indiabulls Housing Finance Limited'),(532832,'Indiabulls Real Estate Ltd'),(542726,'Indiamart Intermesh Limited'),(532814,'Indian Bank'),(540750,'Indian Energy Exchange Ltd'),(500850,'Indian Hotels Co Ltd'),(530965,'Indian Oil Corp Ltd'),(532388,'Indian Overseas Bank'),(542830,'Indian Railway Catering and Tourism Corporation Ltd'),(543257,'Indian Railway Finance Corporation Limited'),(543258,'Indigo Paints Ltd'),(532612,'Indoco Remedies Ltd.'),(541336,'Indostar Capital Finance Ltd'),(532514,'Indraprastha Gas Ltd'),(534816,'Indus Towers Ltd'),(532187,'IndusInd Bank Ltd'),(539807,'Infibeam Avenues Ltd'),(532777,'Info Edge (India) Ltd.'),(500209,'Infosys Ltd'),(532706,'Inox Leisure'),(538835,'Intellect Design Arena Ltd.'),(539448,'InterGlobe Aviation Ltd'),(524164,'IOL Chemicals and Pharmaceuticals Ltd'),(524494,'Ipca Laboratories Ltd'),(532947,'IRB Infrastructure Developers Ltd'),(541956,'IRCON International Ltd'),(500875,'ITC Ltd'),(523610,'ITI Ltd'),(530007,'J. K. Tyre Industries Ltd'),(506943,'J.B.Chemicals & Pharmaceuticals Ltd.'),(532644,'J.K. Cement Ltd.'),(520051,'Jamna Auto Industries Ltd'),(500378,'Jindal SAW Ltd'),(539597,'Jindal Stainless (Hisar) Ltd'),(532508,'Jindal Stainless Ltd.'),(532286,'Jindal Steel & Power Ltd'),(500380,'JK Lakshmi Cement Ltd'),(532162,'JK Paper Ltd.'),(523405,'JM Financial Ltd'),(523398,'Johnson Controls -Hitachi Air Conditioning India Ltd'),(533148,'JSW Energy Ltd'),(500228,'JSW Steel Ltd'),(533155,'Jubilant FoodWorks Ltd'),(543271,'Jubilant Ingrevia Limited'),(530019,'Jubilant Pharmova Sciences Ltd'),(535648,'Just Dial Ltd'),(532926,'Jyothy Labs Ltd'),(500233,'Kajaria Ceramics Ltd.'),(522287,'Kalpataru Power Transmission Ltd'),(543278,'Kalyan Jewellers India Ltd'),(500165,'Kansai Nerolac Paints Ltd.'),(532899,'Kaveri Seed Co Ltd'),(532714,'KEC International Ltd/India'),(517569,'KEI Industries Ltd'),(540680,'KIOCL Ltd'),(532942,'KNR Constructions Ltd'),(500247,'Kotak Mahindra Bank Ltd'),(542651,'KPIT Technologies Ltd'),(532889,'KPR Mill Ltd'),(530813,'KRBL Ltd'),(543308,'Krishna Institute of Medical Sciences Ltd'),(500249,'KSB Ltd'),(533519,'L&T Finance Holdings Ltd'),(540115,'L&T Technology Services Ltd'),(526947,'La Opala Rg Ltd.'),(500252,'Lakshmi Machine Works Ltd'),(540005,'Larsen & Toubro Infotech Ltd'),(500510,'Larsen & Toubro Ltd'),(540222,'Laurus Labs Ltd'),(543277,'Laxmi Organic Industries Ltd'),(541233,'Lemon Tree Hotels Ltd'),(500253,'LIC Housing Finance Ltd'),(523457,'Linde India Ltd'),(500257,'Lupin Ltd'),(539542,'Lux Industries Ltd'),(543287,'Macrotech Developers Ltd'),(539957,'Mahanagar Gas Ltd'),(500266,'Maharashtra Scooters Ltd.'),(532720,'Mahindra & Mahindra Financial Services Ltd'),(500520,'Mahindra & Mahindra Ltd'),(532756,'Mahindra CIE Automotive Ltd'),(533088,'Mahindra Holidays & Resorts India Ltd'),(532313,'Mahindra Lifespace Developers Ltd'),(540768,'Mahindra Logistics Ltd'),(531213,'Manappuram Finance Ltd'),(500109,'Mangalore Refinery & Petrochemicals Ltd'),(531642,'Marico Ltd'),(532500,'Maruti Suzuki India Ltd'),(540749,'MAS Financial Services Ltd'),(523704,'Mastek Ltd'),(500271,'Max Financial Services Ltd'),(543220,'Max Healthcare Institute Ltd'),(543237,'Mazagon Dock Shipbuilders Ltd'),(542650,'Metropolis Healthcare Ltd'),(538962,'Minda Corporation Ltd'),(532539,'Minda Industries Ltd'),(532819,'MindTree Ltd'),(541195,'Mishra Dhatu Nigam Ltd'),(513377,'MMTC LTD'),(533286,'MOIL Ltd'),(532892,'Motilal Oswal Financial Services Ltd'),(526299,'MphasiS Ltd'),(500290,'MRF Ltd'),(534091,'Multi Commodity Exchange of India Limited'),(533398,'Muthoot Finance Ltd'),(539551,'Narayana Hrudayalaya Ltd'),(524816,'Natco Pharma Ltd'),(532234,'National Aluminium Co Ltd'),(532504,'Navin Fluorine International Ltd.'),(534309,'NBCC (India) Ltd'),(500294,'NCC Ltd/India'),(505355,'Nesco Ltd.'),(500790,'Nestle India Ltd'),(532798,'Network 18 Media & Investments Ltd'),(533098,'NHPC Ltd'),(523385,'Nilkamal Ltd'),(540767,'Nippon Life India Asset Management Ltd'),(513683,'NLC India Ltd'),(526371,'NMDC Ltd'),(500730,'NOCIL Ltd.'),(532555,'NTPC Ltd'),(533273,'Oberoi Realty Ltd'),(500312,'Oil & Natural Gas Corp Ltd'),(533106,'Oil India Ltd'),(532466,'Oracle Financial Services Software Ltd'),(541301,'Orient Electric Ltd'),(532827,'Page Industries Ltd'),(506590,'PCBL Ltd'),(533179,'Persistent Systems Ltd'),(532522,'Petronet LNG Ltd'),(500680,'Pfizer Ltd (India)'),(503100,'Phoenix Mills Ltd'),(523642,'PI Industries Ltd'),(500331,'Pidilite Industries Ltd'),(500302,'Piramal Enterprises Ltd'),(540173,'PNB Housing Finance Ltd'),(539150,'PNC Infratech Ltd'),(531768,'Poly Medicure Ltd'),(542652,'Polycab India Ltd'),(524000,'Poonawalla Fincorp Ltd'),(532810,'Power Finance Corp Ltd'),(532898,'Power Grid Corp of India Ltd'),(522205,'Praj Industries Ltd'),(533274,'Prestige Estates Projects Ltd'),(542907,'Prince Pipes and Fittings Ltd'),(500338,'Prism Johnson Ltd'),(500126,'Procter & Gamble Health Limited'),(500459,'Procter & Gamble Hygiene & Health Care Ltd'),(532524,'PTC India Ltd'),(533295,'Punjab & Sind Bank'),(532461,'Punjab National Bank'),(532689,'PVR Ltd'),(539978,'Quess Corp Ltd'),(532497,'Radico Khaitan Ltd'),(542649,'Rail Vikas Nigam Ltd'),(500339,'Rain Industries Limited'),(531500,'Rajesh Exports Ltd'),(500355,'Rallis India Ltd'),(500260,'Ramco Cements Ltd'),(524230,'Rashtriya Chemicals & Fertilizers Ltd.'),(520111,'Ratnamani Metals & Tubes Ltd'),(540065,'RBL Bank Ltd'),(532955,'REC Ltd'),(532805,'Redington India Ltd'),(530517,'Relaxo Footwears Ltd'),(500325,'Reliance Industries Ltd'),(505509,'Responsive Industries Ltd.'),(543248,'Restaurant Brands Asia Ltd'),(534076,'Rhi Magnesita India Ltd'),(541556,'RITES Ltd'),(543213,'Rossari Biotech Ltd'),(543228,'Route Mobile Ltd'),(500368,'Ruchi Soya Industries Ltd'),(500674,'Sanofi India Ltd'),(532163,'Saregama India Ltd'),(543066,'SBI Cards and Payment Services Limited'),(540719,'SBI Life Insurance Company Ltd'),(505790,'Schaeffler India Ltd'),(512529,'Sequent Scientific Ltd'),(540203,'Sheela Foam Ltd'),(530549,'Shilpa Medicare Ltd'),(523598,'Shipping Corp of India Ltd'),(500387,'Shree Cement Ltd'),(532498,'Shriram City Union Finance Ltd.'),(511218,'Shriram Transport Finance Co Ltd'),(543299,'Shyam Metalics and Energy Ltd'),(500550,'Siemens India Ltd'),(540673,'SIS Limited'),(533206,'SJVN Ltd'),(500472,'SKF India Ltd'),(532784,'Sobha Limited'),(532725,'Solar Industries India Ltd'),(541540,'Solara Active Pharma Sciences Ltd'),(543300,'Sona BLW Precision Forgings Ltd'),(532221,'Sonata Software Ltd'),(542759,'Spandana Sphoorty Financial Ltd'),(500285,'SpiceJet Ltd.'),(503806,'SRF Ltd'),(540575,'Star Cement Ltd'),(500112,'State Bank of India'),(500113,'Steel Authority of India Ltd'),(542760,'Sterling and Wilson Renewable Energy Ltd'),(532374,'Sterlite Technologies Ltd.'),(532531,'Strides Pharma Science Ltd'),(506655,'Sudarshan Chemical Industries'),(542920,'Sumitomo Chemical India Ltd'),(532872,'Sun Pharma Advanced Research Co Ltd'),(524715,'Sun Pharmaceutical Industries Ltd'),(532733,'Sun TV Network Ltd'),(520056,'Sundaram Clayton Ltd'),(500403,'Sundaram Fastners'),(512179,'Sunteck Realty Ltd'),(509930,'Supreme Industries'),(543064,'Suven Pharmaceuticals Limited'),(532667,'Suzlon Energy Ltd'),(503310,'Swan Energy Ltd.'),(517385,'Symphony Ltd'),(539268,'Syngene International Ltd'),(532790,'Tanla Platforms Ltd'),(519091,'Tasty Bite Eatables Ltd'),(500770,'Tata Chemicals Ltd'),(532301,'Tata Coffee Ltd.'),(500483,'Tata Communications Ltd'),(532540,'Tata Consultancy Services Ltd'),(500800,'Tata Consumer Products Ltd'),(500408,'Tata Elxsi Ltd'),(501301,'Tata Investment Corp Ltd'),(513434,'Tata Metaliks Ltd.'),(500570,'Tata Motors Ltd'),(570001,'Tata Motors Ltd DVR'),(500400,'Tata Power Co Ltd'),(500470,'Tata Steel Ltd'),(532371,'Tata Teleservices Maharashtra Ltd'),(540212,'TCI Express Ltd'),(541700,'TCNS Clothing Co. Ltd'),(539658,'TeamLease Services Ltd'),(532755,'Tech Mahindra Ltd'),(540769,'The New India Assurance Company Ltd'),(500411,'Thermax Ltd'),(539871,'Thyrocare Technologies Ltd'),(522113,'Timken India Ltd.'),(500114,'Titan Co Ltd'),(500420,'Torrent Pharmaceuticals Ltd'),(532779,'Torrent Power Ltd'),(500251,'Trent Ltd.'),(521064,'Trident Ltd.'),(533655,'Triveni Turbine Limited'),(517506,'TTK Prestige Ltd'),(540762,'Tube Investments Of India'),(532800,'TV18 Broadcast Ltd'),(532343,'TVS Motor Co Ltd'),(532505,'UCO Bank'),(500148,'Uflex Ltd'),(542904,'Ujjivan Small Finance Bank Ltd'),(532538,'UltraTech Cement Ltd'),(532477,'Union Bank of India'),(532478,'United Breweries Ltd'),(512070,'UPL Ltd'),(543238,'UTI Asset Management Company Ltd'),(532953,'V-Guard Industries Ltd'),(534976,'V-Mart Retail Limited'),(532156,'Vaibhav Global Ltd'),(511431,'Vakrangee Ltd'),(502986,'Vardhman Textiles Ltd.'),(541578,'Varroc Engineering Ltd'),(540180,'Varun Beverages Ltd'),(500295,'Vedanta Ltd'),(523261,'Venky''s India Ltd'),(524200,'Vinati Organics Ltd'),(507880,'VIP Industries Ltd'),(532822,'Vodafone Idea Ltd'),(500575,'Voltas Ltd'),(509966,'VST Industries Ltd.'),(532144,'Welspun Corp Ltd'),(514162,'Welspun India Ltd.'),(505533,'Westlife Development Ltd'),(500238,'Whirlpool of India Ltd'),(507685,'Wipro Ltd'),(532300,'Wockhardt Ltd'),(532648,'Yes Bank Ltd'),(505537,'Zee Entertainment Enterprises Ltd'),(504067,'Zensar Technologies Ltd'),(533023,'ZF Commercial Vehicle Control Systems India Ltd'),(543320,'Zomato Ltd'),(532321,'Zydus Lifesciences Ltd'),(531335,'Zydus Wellness Ltd')
	    ) 
	    select 
	    stock_code, 
	    stock_name, 
	    (
	        with sma as (
	        SELECT 
	            trade_date, 
	            close, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 19 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma20, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 49 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma50, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 199 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma200 
	        FROM 
	            bse 
	        where 
	            code = indices.stock_code
	        ), 
	        delta as(
	        select 
	            *, 
	            lead(sma200, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma200, 
	            lead(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma50, 
	            lag(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as prev_sma50 
	        from 
	            sma
	        ), 
	        rising as (
	        select 
	            *, 
	            case when next_sma200 - sma200 > 0 then TRUE else FALSE end is_sma200_rising, 
	            case when prev_sma50 < sma200 
	            and next_sma50 > sma200 then TRUE else FALSE end goldencross 
	        from 
	            delta
	        ), 
	        top5 as (
	        select 
	            * 
	        from 
	            rising 
	        order by 
	            trade_date desc 
	        limit 
	            1 
	        offset    5
	        ) 
	        select 
	        case when sum(is_sma200_rising) = 5 
	        and sum((int(goldencross)) > 0 then TRUE else FALSE end tudor_trading_signal 
	        from 
	        top5
	    ) as tudor_trade 
	    from 
	    indices 
	    where 
	    tudor_trade > 0   
	    
2022-06-02 01:43:03.983 IST [8956] ERROR:  function sum(boolean) does not exist at character 18419
2022-06-02 01:43:03.983 IST [8956] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-06-02 01:43:03.983 IST [8956] STATEMENT:  
	    with indices(stock_code, stock_name) as (
	    values 
	    (523395,'3M India Ltd'),(524348,'Aarti Drugs Ltd'),(524208,'Aarti Industries Ltd.'),(541988,'AAVAS Financiers Ltd'),(500002,'ABB India Ltd'),(500488,'Abbott India Ltd'),(500410,'ACC Ltd'),(512599,'Adani Enterprises Ltd'),(541450,'Adani Green Energy Ltd'),(532921,'Adani Ports and Special Economic Zone'),(533096,'Adani Power Ltd'),(542066,'Adani Total Gas Limited'),(539254,'Adani Transmission Ltd'),(540691,'Aditya Birla Capital Ltd'),(535755,'Aditya Birla Fashion and Retail Ltd'),(540025,'Advanced Enzyme Technologies Ltd'),(500003,'Aegis Logistics Ltd'),(542752,'Affle (India) Ltd'),(532683,'AIA Engineering Ltd'),(532331,'Ajanta Pharma Ltd'),(500710,'Akzo Nobel India Ltd'),(533573,'Alembic Pharmaceuticals Ltd'),(539523,'Alkem Laboratories Ltd'),(506767,'Alkyl Amines Chemicals Ltd'),(532749,'AllCargo Logistics Ltd'),(521070,'Alok Industries Ltd'),(500008,'Amara Raja Batteries Ltd'),(540902,'Amber Enterprises India Ltd'),(500425,'Ambuja Cements Ltd'),(543235,'Angel One Limited'),(543275,'Anupam Rasayan India Ltd'),(533758,'APL Apollo Tubes Ltd'),(508869,'Apollo Hospitals Enterprise Ltd'),(500877,'Apollo Tyres Ltd'),(515030,'Asahi India Glass Ltd'),(500477,'Ashok Leyland Ltd'),(500820,'Asian Paints Ltd'),(540975,'Aster DM Healthcare Ltd'),(532830,'ASTRAL LIMITED'),(506820,'AstraZeneca Pharm India'),(500027,'Atul Ltd.'),(540611,'AU Small Finance Bank Ltd'),(524804,'Aurobindo Pharma Ltd'),(512573,'Avanti Feeds Ltd'),(540376,'Avenue Supermarts Ltd'),(532215,'Axis Bank Ltd'),(532977,'Bajaj Auto Ltd'),(533229,'Bajaj Consumer Care Ltd'),(500031,'Bajaj Electricals Ltd'),(500034,'Bajaj Finance Ltd'),(532978,'Bajaj Finserv Ltd'),(500490,'Bajaj Holdings and Investment Ltd'),(530999,'Balaji Amines Ltd'),(502355,'Balkrishna Industries Ltd'),(500038,'Balrampur Chini Mills Ltd'),(541153,'Bandhan Bank Ltd'),(532134,'Bank of Baroda'),(532149,'Bank of India'),(532525,'Bank Of Maharashtra'),(500042,'BASF India Limited'),(500043,'Bata India Ltimited'),(506285,'Bayer CropScience Ltd/India'),(500048,'BEML Ltd'),(509480,'Berger Paints India Ltd'),(541143,'Bharat Dynamics Ltd'),(500049,'Bharat Electronics Ltd'),(500493,'Bharat Forge Ltd'),(500103,'Bharat Heavy Electricals Ltd'),(500547,'Bharat Petroleum Corp Ltd'),(532454,'Bharti Airtel Ltd'),(532523,'Biocon Ltd'),(500335,'Birla Corp Ltd'),(532400,'Birlasoft Ltd'),(526612,'Blue Dart Express Ltd'),(500067,'Blue Star Ltd'),(501425,'Bombay Burmah Trading Corp Ltd.'),(500530,'Bosch Ltd'),(532929,'Brigade Enterprises Ltd'),(532368,'Brightcom Group Ltd'),(500825,'Britannia Industries Ltd.'),(511196,'Can Fin Homes Ltd'),(532483,'Canara Bank'),(524742,'Caplin Point Laboratories Ltd'),(531595,'Capri Global Capital  LTD'),(513375,'Carborundum Universal Ltd'),(500870,'Castrol India Ltd'),(519600,'CCL Products (India) Ltd.'),(500878,'CEAT Ltd'),(532885,'Central Bank of India'),(532548,'Century Plyboards India Ltd'),(500040,'Century Textile & Industries Ltd'),(532443,'Cera Sanitaryware Ltd'),(500084,'CESC Ltd'),(542399,'Chalet Hotels Ltd'),(500085,'Chambal Fertilizers & Chemicals Ltd'),(504973,'Cholamandalam Financial Holdings Ltd'),(511243,'Cholamandalam Investment & Finance Co. Ltd.'),(500087,'Cipla Ltd/India'),(532210,'City Union Bank Ltd.'),(533278,'Coal India Ltd'),(540678,'Cochin Shipyard Ltd'),(532541,'Coforge Ltd'),(500830,'Colgate-Palmolive India Ltd'),(543232,'Computer Age Management Services Ltd'),(531344,'Container Corp Of India'),(506395,'Coromandel International Ltd'),(541770,'CreditAccess Grameen Ltd'),(500092,'CRISIL Ltd'),(539876,'Crompton Greaves Consumer Electricals Ltd'),(542867,'CSB Bank Ltd'),(500480,'Cummins India Ltd'),(532175,'Cyient Ltd'),(500096,'Dabur India Ltd'),(542216,'Dalmia Bharat Ltd'),(532772,'DCB Bank Ltd'),(523367,'DCM Shriram Ltd'),(500645,'Deepak Fertilisers & Petrochemicals Corp. Ltd.'),(506401,'Deepak Nitrite Limited'),(532848,'Delta Corp. Ltd.'),(507717,'Dhanuka Agritech Ltd'),(540047,'Dilip Buildcon Ltd'),(540701,'Dishman Carbogen Amics Ltd'),(532488,'Divi''s Laboratories Ltd'),(540699,'Dixon Technologies (India) Ltd'),(532868,'DLF Ltd'),(500124,'Dr Reddy''s Laboratories Ltd'),(539524,'Dr. Lal PathLabs Ltd'),(532927,'eClerx Services Ltd'),(532922,'Edelweiss Financial Services Ltd'),(505200,'Eicher Motors Ltd'),(500125,'EID Parry India Ltd'),(500840,'EIH Ltd'),(522074,'Elgi Equipments Ltd.'),(531162,'Emami Ltd'),(540153,'Endurance Technologies Ltd'),(532178,'Engineers India Ltd'),(500135,'EPL Ltd'),(539844,'Equitas Holdings Ltd'),(543243,'Equitas Small Finance Bank Ltd'),(540596,'Eris Lifesciences Ltd'),(500133,'Esab India Ltd'),(500495,'Escorts Ltd'),(500086,'Exide Industries Ltd'),(531599,'FDC Ltd'),(500469,'Federal Bank Ltd'),(541557,'Fine Organic Industries Ltd'),(500144,'Finolex Cables Ltd'),(500940,'Finolex Industries Ltd'),(532809,'Firstsource Solutions Ltd'),(532843,'Fortis Healthcare Ltd.'),(532155,'Gail India Ltd'),(540935,'Galaxy Surfactants Ltd'),(509557,'Garware Technical Fibres Ltd'),(540755,'General Insurance Corporation of India'),(500171,'GHCL Ltd'),(507815,'Gillette India Ltd'),(543245,'Gland Pharma Ltd'),(500660,'GlaxoSmithKline Pharmaceuticals Ltd'),(532296,'Glenmark Pharmaceuticals Ltd'),(505255,'GMM Pfaudler Limited'),(500163,'Godfrey Phillips India Ltd'),(540743,'Godrej Agrovet Ltd'),(532424,'Godrej Consumer Products Ltd'),(500164,'Godrej Industries Ltd'),(533150,'Godrej Properties Ltd'),(532482,'Granules India Ltd'),(509488,'Graphite India Ltd.'),(500300,'Grasim Industries Ltd'),(500620,'Great Eastern Shipping Co Ltd/The'),(501455,'Greaves Cotton Ltd.'),(506076,'Grindwell Norton Ltd'),(530001,'Gujarat Alkalies & Chemicals Ltd.'),(542812,'Gujarat Fluorochemicals Ltd'),(539336,'Gujarat Gas Ltd'),(500670,'Gujarat Narmada Valley Fertilizers and Chemicals Limited'),(533248,'Gujarat Pipavav Port Ltd'),(500690,'Gujarat State Fertilisers & Chemicals Ltd'),(532702,'Gujarat State Petronet Ltd'),(538567,'Gulf Oil Lubricants India Ltd'),(543227,'Happiest Minds Technologies Ltd'),(533162,'Hathway Cables and Datacom Ltd'),(531531,'Hatsun Agro Products Ltd'),(517354,'Havells India Ltd'),(508486,'HawkiBO Cookers Ltd'),(532281,'HCL Technologies Ltd'),(541729,'HDFC Asset Management Company Ltd'),(500180,'HDFC Bank Ltd'),(540777,'HDFC Life Insurance Company Ltd'),(509631,'HEG Ltd'),(500292,'HeidelbergCement India Ltd.'),(500182,'Hero MotoCorp Ltd'),(500183,'HFCL Ltd'),(524735,'Hikal Ltd.'),(500440,'Hindalco Industries Ltd'),(541154,'Hindustan Aeronautics Ltd'),(513599,'Hindustan Copper'),(500104,'Hindustan Petroleum Corp Ltd'),(500696,'Hindustan Unilever Ltd'),(500188,'Hindustan Zinc Ltd'),(543187,'Hitachi Energy India Ltd'),(517174,'Honeywell Automation India Ltd'),(540530,'Housing and Urban Development Corporation Ltd'),(500010,'Housing Development Finance Corp'),(532174,'ICICI Bank Ltd'),(540716,'ICICI Lombard General Insurance Company Ltd'),(540133,'ICICI Prudential Life Insurance Company Ltd'),(541179,'ICICI Securities Ltd'),(500116,'IDBI Bank Ltd'),(539437,'IDFC First Bank Ltd'),(532659,'IDFC Limited'),(505726,'IFB Industries Ltd'),(532636,'IIFL Finance Ltd'),(542772,'IIFL Wealth Management Ltd'),(530005,'India Cements Ltd'),(532189,'India Tourism Development Corp Ltd'),(535789,'Indiabulls Housing Finance Limited'),(532832,'Indiabulls Real Estate Ltd'),(542726,'Indiamart Intermesh Limited'),(532814,'Indian Bank'),(540750,'Indian Energy Exchange Ltd'),(500850,'Indian Hotels Co Ltd'),(530965,'Indian Oil Corp Ltd'),(532388,'Indian Overseas Bank'),(542830,'Indian Railway Catering and Tourism Corporation Ltd'),(543257,'Indian Railway Finance Corporation Limited'),(543258,'Indigo Paints Ltd'),(532612,'Indoco Remedies Ltd.'),(541336,'Indostar Capital Finance Ltd'),(532514,'Indraprastha Gas Ltd'),(534816,'Indus Towers Ltd'),(532187,'IndusInd Bank Ltd'),(539807,'Infibeam Avenues Ltd'),(532777,'Info Edge (India) Ltd.'),(500209,'Infosys Ltd'),(532706,'Inox Leisure'),(538835,'Intellect Design Arena Ltd.'),(539448,'InterGlobe Aviation Ltd'),(524164,'IOL Chemicals and Pharmaceuticals Ltd'),(524494,'Ipca Laboratories Ltd'),(532947,'IRB Infrastructure Developers Ltd'),(541956,'IRCON International Ltd'),(500875,'ITC Ltd'),(523610,'ITI Ltd'),(530007,'J. K. Tyre Industries Ltd'),(506943,'J.B.Chemicals & Pharmaceuticals Ltd.'),(532644,'J.K. Cement Ltd.'),(520051,'Jamna Auto Industries Ltd'),(500378,'Jindal SAW Ltd'),(539597,'Jindal Stainless (Hisar) Ltd'),(532508,'Jindal Stainless Ltd.'),(532286,'Jindal Steel & Power Ltd'),(500380,'JK Lakshmi Cement Ltd'),(532162,'JK Paper Ltd.'),(523405,'JM Financial Ltd'),(523398,'Johnson Controls -Hitachi Air Conditioning India Ltd'),(533148,'JSW Energy Ltd'),(500228,'JSW Steel Ltd'),(533155,'Jubilant FoodWorks Ltd'),(543271,'Jubilant Ingrevia Limited'),(530019,'Jubilant Pharmova Sciences Ltd'),(535648,'Just Dial Ltd'),(532926,'Jyothy Labs Ltd'),(500233,'Kajaria Ceramics Ltd.'),(522287,'Kalpataru Power Transmission Ltd'),(543278,'Kalyan Jewellers India Ltd'),(500165,'Kansai Nerolac Paints Ltd.'),(532899,'Kaveri Seed Co Ltd'),(532714,'KEC International Ltd/India'),(517569,'KEI Industries Ltd'),(540680,'KIOCL Ltd'),(532942,'KNR Constructions Ltd'),(500247,'Kotak Mahindra Bank Ltd'),(542651,'KPIT Technologies Ltd'),(532889,'KPR Mill Ltd'),(530813,'KRBL Ltd'),(543308,'Krishna Institute of Medical Sciences Ltd'),(500249,'KSB Ltd'),(533519,'L&T Finance Holdings Ltd'),(540115,'L&T Technology Services Ltd'),(526947,'La Opala Rg Ltd.'),(500252,'Lakshmi Machine Works Ltd'),(540005,'Larsen & Toubro Infotech Ltd'),(500510,'Larsen & Toubro Ltd'),(540222,'Laurus Labs Ltd'),(543277,'Laxmi Organic Industries Ltd'),(541233,'Lemon Tree Hotels Ltd'),(500253,'LIC Housing Finance Ltd'),(523457,'Linde India Ltd'),(500257,'Lupin Ltd'),(539542,'Lux Industries Ltd'),(543287,'Macrotech Developers Ltd'),(539957,'Mahanagar Gas Ltd'),(500266,'Maharashtra Scooters Ltd.'),(532720,'Mahindra & Mahindra Financial Services Ltd'),(500520,'Mahindra & Mahindra Ltd'),(532756,'Mahindra CIE Automotive Ltd'),(533088,'Mahindra Holidays & Resorts India Ltd'),(532313,'Mahindra Lifespace Developers Ltd'),(540768,'Mahindra Logistics Ltd'),(531213,'Manappuram Finance Ltd'),(500109,'Mangalore Refinery & Petrochemicals Ltd'),(531642,'Marico Ltd'),(532500,'Maruti Suzuki India Ltd'),(540749,'MAS Financial Services Ltd'),(523704,'Mastek Ltd'),(500271,'Max Financial Services Ltd'),(543220,'Max Healthcare Institute Ltd'),(543237,'Mazagon Dock Shipbuilders Ltd'),(542650,'Metropolis Healthcare Ltd'),(538962,'Minda Corporation Ltd'),(532539,'Minda Industries Ltd'),(532819,'MindTree Ltd'),(541195,'Mishra Dhatu Nigam Ltd'),(513377,'MMTC LTD'),(533286,'MOIL Ltd'),(532892,'Motilal Oswal Financial Services Ltd'),(526299,'MphasiS Ltd'),(500290,'MRF Ltd'),(534091,'Multi Commodity Exchange of India Limited'),(533398,'Muthoot Finance Ltd'),(539551,'Narayana Hrudayalaya Ltd'),(524816,'Natco Pharma Ltd'),(532234,'National Aluminium Co Ltd'),(532504,'Navin Fluorine International Ltd.'),(534309,'NBCC (India) Ltd'),(500294,'NCC Ltd/India'),(505355,'Nesco Ltd.'),(500790,'Nestle India Ltd'),(532798,'Network 18 Media & Investments Ltd'),(533098,'NHPC Ltd'),(523385,'Nilkamal Ltd'),(540767,'Nippon Life India Asset Management Ltd'),(513683,'NLC India Ltd'),(526371,'NMDC Ltd'),(500730,'NOCIL Ltd.'),(532555,'NTPC Ltd'),(533273,'Oberoi Realty Ltd'),(500312,'Oil & Natural Gas Corp Ltd'),(533106,'Oil India Ltd'),(532466,'Oracle Financial Services Software Ltd'),(541301,'Orient Electric Ltd'),(532827,'Page Industries Ltd'),(506590,'PCBL Ltd'),(533179,'Persistent Systems Ltd'),(532522,'Petronet LNG Ltd'),(500680,'Pfizer Ltd (India)'),(503100,'Phoenix Mills Ltd'),(523642,'PI Industries Ltd'),(500331,'Pidilite Industries Ltd'),(500302,'Piramal Enterprises Ltd'),(540173,'PNB Housing Finance Ltd'),(539150,'PNC Infratech Ltd'),(531768,'Poly Medicure Ltd'),(542652,'Polycab India Ltd'),(524000,'Poonawalla Fincorp Ltd'),(532810,'Power Finance Corp Ltd'),(532898,'Power Grid Corp of India Ltd'),(522205,'Praj Industries Ltd'),(533274,'Prestige Estates Projects Ltd'),(542907,'Prince Pipes and Fittings Ltd'),(500338,'Prism Johnson Ltd'),(500126,'Procter & Gamble Health Limited'),(500459,'Procter & Gamble Hygiene & Health Care Ltd'),(532524,'PTC India Ltd'),(533295,'Punjab & Sind Bank'),(532461,'Punjab National Bank'),(532689,'PVR Ltd'),(539978,'Quess Corp Ltd'),(532497,'Radico Khaitan Ltd'),(542649,'Rail Vikas Nigam Ltd'),(500339,'Rain Industries Limited'),(531500,'Rajesh Exports Ltd'),(500355,'Rallis India Ltd'),(500260,'Ramco Cements Ltd'),(524230,'Rashtriya Chemicals & Fertilizers Ltd.'),(520111,'Ratnamani Metals & Tubes Ltd'),(540065,'RBL Bank Ltd'),(532955,'REC Ltd'),(532805,'Redington India Ltd'),(530517,'Relaxo Footwears Ltd'),(500325,'Reliance Industries Ltd'),(505509,'Responsive Industries Ltd.'),(543248,'Restaurant Brands Asia Ltd'),(534076,'Rhi Magnesita India Ltd'),(541556,'RITES Ltd'),(543213,'Rossari Biotech Ltd'),(543228,'Route Mobile Ltd'),(500368,'Ruchi Soya Industries Ltd'),(500674,'Sanofi India Ltd'),(532163,'Saregama India Ltd'),(543066,'SBI Cards and Payment Services Limited'),(540719,'SBI Life Insurance Company Ltd'),(505790,'Schaeffler India Ltd'),(512529,'Sequent Scientific Ltd'),(540203,'Sheela Foam Ltd'),(530549,'Shilpa Medicare Ltd'),(523598,'Shipping Corp of India Ltd'),(500387,'Shree Cement Ltd'),(532498,'Shriram City Union Finance Ltd.'),(511218,'Shriram Transport Finance Co Ltd'),(543299,'Shyam Metalics and Energy Ltd'),(500550,'Siemens India Ltd'),(540673,'SIS Limited'),(533206,'SJVN Ltd'),(500472,'SKF India Ltd'),(532784,'Sobha Limited'),(532725,'Solar Industries India Ltd'),(541540,'Solara Active Pharma Sciences Ltd'),(543300,'Sona BLW Precision Forgings Ltd'),(532221,'Sonata Software Ltd'),(542759,'Spandana Sphoorty Financial Ltd'),(500285,'SpiceJet Ltd.'),(503806,'SRF Ltd'),(540575,'Star Cement Ltd'),(500112,'State Bank of India'),(500113,'Steel Authority of India Ltd'),(542760,'Sterling and Wilson Renewable Energy Ltd'),(532374,'Sterlite Technologies Ltd.'),(532531,'Strides Pharma Science Ltd'),(506655,'Sudarshan Chemical Industries'),(542920,'Sumitomo Chemical India Ltd'),(532872,'Sun Pharma Advanced Research Co Ltd'),(524715,'Sun Pharmaceutical Industries Ltd'),(532733,'Sun TV Network Ltd'),(520056,'Sundaram Clayton Ltd'),(500403,'Sundaram Fastners'),(512179,'Sunteck Realty Ltd'),(509930,'Supreme Industries'),(543064,'Suven Pharmaceuticals Limited'),(532667,'Suzlon Energy Ltd'),(503310,'Swan Energy Ltd.'),(517385,'Symphony Ltd'),(539268,'Syngene International Ltd'),(532790,'Tanla Platforms Ltd'),(519091,'Tasty Bite Eatables Ltd'),(500770,'Tata Chemicals Ltd'),(532301,'Tata Coffee Ltd.'),(500483,'Tata Communications Ltd'),(532540,'Tata Consultancy Services Ltd'),(500800,'Tata Consumer Products Ltd'),(500408,'Tata Elxsi Ltd'),(501301,'Tata Investment Corp Ltd'),(513434,'Tata Metaliks Ltd.'),(500570,'Tata Motors Ltd'),(570001,'Tata Motors Ltd DVR'),(500400,'Tata Power Co Ltd'),(500470,'Tata Steel Ltd'),(532371,'Tata Teleservices Maharashtra Ltd'),(540212,'TCI Express Ltd'),(541700,'TCNS Clothing Co. Ltd'),(539658,'TeamLease Services Ltd'),(532755,'Tech Mahindra Ltd'),(540769,'The New India Assurance Company Ltd'),(500411,'Thermax Ltd'),(539871,'Thyrocare Technologies Ltd'),(522113,'Timken India Ltd.'),(500114,'Titan Co Ltd'),(500420,'Torrent Pharmaceuticals Ltd'),(532779,'Torrent Power Ltd'),(500251,'Trent Ltd.'),(521064,'Trident Ltd.'),(533655,'Triveni Turbine Limited'),(517506,'TTK Prestige Ltd'),(540762,'Tube Investments Of India'),(532800,'TV18 Broadcast Ltd'),(532343,'TVS Motor Co Ltd'),(532505,'UCO Bank'),(500148,'Uflex Ltd'),(542904,'Ujjivan Small Finance Bank Ltd'),(532538,'UltraTech Cement Ltd'),(532477,'Union Bank of India'),(532478,'United Breweries Ltd'),(512070,'UPL Ltd'),(543238,'UTI Asset Management Company Ltd'),(532953,'V-Guard Industries Ltd'),(534976,'V-Mart Retail Limited'),(532156,'Vaibhav Global Ltd'),(511431,'Vakrangee Ltd'),(502986,'Vardhman Textiles Ltd.'),(541578,'Varroc Engineering Ltd'),(540180,'Varun Beverages Ltd'),(500295,'Vedanta Ltd'),(523261,'Venky''s India Ltd'),(524200,'Vinati Organics Ltd'),(507880,'VIP Industries Ltd'),(532822,'Vodafone Idea Ltd'),(500575,'Voltas Ltd'),(509966,'VST Industries Ltd.'),(532144,'Welspun Corp Ltd'),(514162,'Welspun India Ltd.'),(505533,'Westlife Development Ltd'),(500238,'Whirlpool of India Ltd'),(507685,'Wipro Ltd'),(532300,'Wockhardt Ltd'),(532648,'Yes Bank Ltd'),(505537,'Zee Entertainment Enterprises Ltd'),(504067,'Zensar Technologies Ltd'),(533023,'ZF Commercial Vehicle Control Systems India Ltd'),(543320,'Zomato Ltd'),(532321,'Zydus Lifesciences Ltd'),(531335,'Zydus Wellness Ltd')
	    ) 
	    select 
	    stock_code, 
	    stock_name, 
	    (
	        with sma as (
	        SELECT 
	            trade_date, 
	            close, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 19 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma20, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 49 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma50, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 199 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma200 
	        FROM 
	            bse 
	        where 
	            code = indices.stock_code
	        ), 
	        delta as(
	        select 
	            *, 
	            lead(sma200, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma200, 
	            lead(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma50, 
	            lag(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as prev_sma50 
	        from 
	            sma
	        ), 
	        rising as (
	        select 
	            *, 
	            case when next_sma200 - sma200 > 0 then TRUE else FALSE end is_sma200_rising, 
	            case when prev_sma50 < sma200 
	            and next_sma50 > sma200 then TRUE else FALSE end goldencross 
	        from 
	            delta
	        ), 
	        top5 as (
	        select 
	            * 
	        from 
	            rising 
	        order by 
	            trade_date desc 
	        limit 
	            1 
	        offset    5
	        ) 
	        select 
	        case when sum(is_sma200_rising) = 5 
	        and sum(goldencross::int) > 0 then TRUE else FALSE end tudor_trading_signal 
	        from 
	        top5
	    ) as tudor_trade 
	    from 
	    indices 
	    where 
	    tudor_trade > 0   
	    
2022-06-02 01:43:15.379 IST [8956] ERROR:  column "tudor_trade" does not exist at character 18631
2022-06-02 01:43:15.379 IST [8956] STATEMENT:  
	    with indices(stock_code, stock_name) as (
	    values 
	    (523395,'3M India Ltd'),(524348,'Aarti Drugs Ltd'),(524208,'Aarti Industries Ltd.'),(541988,'AAVAS Financiers Ltd'),(500002,'ABB India Ltd'),(500488,'Abbott India Ltd'),(500410,'ACC Ltd'),(512599,'Adani Enterprises Ltd'),(541450,'Adani Green Energy Ltd'),(532921,'Adani Ports and Special Economic Zone'),(533096,'Adani Power Ltd'),(542066,'Adani Total Gas Limited'),(539254,'Adani Transmission Ltd'),(540691,'Aditya Birla Capital Ltd'),(535755,'Aditya Birla Fashion and Retail Ltd'),(540025,'Advanced Enzyme Technologies Ltd'),(500003,'Aegis Logistics Ltd'),(542752,'Affle (India) Ltd'),(532683,'AIA Engineering Ltd'),(532331,'Ajanta Pharma Ltd'),(500710,'Akzo Nobel India Ltd'),(533573,'Alembic Pharmaceuticals Ltd'),(539523,'Alkem Laboratories Ltd'),(506767,'Alkyl Amines Chemicals Ltd'),(532749,'AllCargo Logistics Ltd'),(521070,'Alok Industries Ltd'),(500008,'Amara Raja Batteries Ltd'),(540902,'Amber Enterprises India Ltd'),(500425,'Ambuja Cements Ltd'),(543235,'Angel One Limited'),(543275,'Anupam Rasayan India Ltd'),(533758,'APL Apollo Tubes Ltd'),(508869,'Apollo Hospitals Enterprise Ltd'),(500877,'Apollo Tyres Ltd'),(515030,'Asahi India Glass Ltd'),(500477,'Ashok Leyland Ltd'),(500820,'Asian Paints Ltd'),(540975,'Aster DM Healthcare Ltd'),(532830,'ASTRAL LIMITED'),(506820,'AstraZeneca Pharm India'),(500027,'Atul Ltd.'),(540611,'AU Small Finance Bank Ltd'),(524804,'Aurobindo Pharma Ltd'),(512573,'Avanti Feeds Ltd'),(540376,'Avenue Supermarts Ltd'),(532215,'Axis Bank Ltd'),(532977,'Bajaj Auto Ltd'),(533229,'Bajaj Consumer Care Ltd'),(500031,'Bajaj Electricals Ltd'),(500034,'Bajaj Finance Ltd'),(532978,'Bajaj Finserv Ltd'),(500490,'Bajaj Holdings and Investment Ltd'),(530999,'Balaji Amines Ltd'),(502355,'Balkrishna Industries Ltd'),(500038,'Balrampur Chini Mills Ltd'),(541153,'Bandhan Bank Ltd'),(532134,'Bank of Baroda'),(532149,'Bank of India'),(532525,'Bank Of Maharashtra'),(500042,'BASF India Limited'),(500043,'Bata India Ltimited'),(506285,'Bayer CropScience Ltd/India'),(500048,'BEML Ltd'),(509480,'Berger Paints India Ltd'),(541143,'Bharat Dynamics Ltd'),(500049,'Bharat Electronics Ltd'),(500493,'Bharat Forge Ltd'),(500103,'Bharat Heavy Electricals Ltd'),(500547,'Bharat Petroleum Corp Ltd'),(532454,'Bharti Airtel Ltd'),(532523,'Biocon Ltd'),(500335,'Birla Corp Ltd'),(532400,'Birlasoft Ltd'),(526612,'Blue Dart Express Ltd'),(500067,'Blue Star Ltd'),(501425,'Bombay Burmah Trading Corp Ltd.'),(500530,'Bosch Ltd'),(532929,'Brigade Enterprises Ltd'),(532368,'Brightcom Group Ltd'),(500825,'Britannia Industries Ltd.'),(511196,'Can Fin Homes Ltd'),(532483,'Canara Bank'),(524742,'Caplin Point Laboratories Ltd'),(531595,'Capri Global Capital  LTD'),(513375,'Carborundum Universal Ltd'),(500870,'Castrol India Ltd'),(519600,'CCL Products (India) Ltd.'),(500878,'CEAT Ltd'),(532885,'Central Bank of India'),(532548,'Century Plyboards India Ltd'),(500040,'Century Textile & Industries Ltd'),(532443,'Cera Sanitaryware Ltd'),(500084,'CESC Ltd'),(542399,'Chalet Hotels Ltd'),(500085,'Chambal Fertilizers & Chemicals Ltd'),(504973,'Cholamandalam Financial Holdings Ltd'),(511243,'Cholamandalam Investment & Finance Co. Ltd.'),(500087,'Cipla Ltd/India'),(532210,'City Union Bank Ltd.'),(533278,'Coal India Ltd'),(540678,'Cochin Shipyard Ltd'),(532541,'Coforge Ltd'),(500830,'Colgate-Palmolive India Ltd'),(543232,'Computer Age Management Services Ltd'),(531344,'Container Corp Of India'),(506395,'Coromandel International Ltd'),(541770,'CreditAccess Grameen Ltd'),(500092,'CRISIL Ltd'),(539876,'Crompton Greaves Consumer Electricals Ltd'),(542867,'CSB Bank Ltd'),(500480,'Cummins India Ltd'),(532175,'Cyient Ltd'),(500096,'Dabur India Ltd'),(542216,'Dalmia Bharat Ltd'),(532772,'DCB Bank Ltd'),(523367,'DCM Shriram Ltd'),(500645,'Deepak Fertilisers & Petrochemicals Corp. Ltd.'),(506401,'Deepak Nitrite Limited'),(532848,'Delta Corp. Ltd.'),(507717,'Dhanuka Agritech Ltd'),(540047,'Dilip Buildcon Ltd'),(540701,'Dishman Carbogen Amics Ltd'),(532488,'Divi''s Laboratories Ltd'),(540699,'Dixon Technologies (India) Ltd'),(532868,'DLF Ltd'),(500124,'Dr Reddy''s Laboratories Ltd'),(539524,'Dr. Lal PathLabs Ltd'),(532927,'eClerx Services Ltd'),(532922,'Edelweiss Financial Services Ltd'),(505200,'Eicher Motors Ltd'),(500125,'EID Parry India Ltd'),(500840,'EIH Ltd'),(522074,'Elgi Equipments Ltd.'),(531162,'Emami Ltd'),(540153,'Endurance Technologies Ltd'),(532178,'Engineers India Ltd'),(500135,'EPL Ltd'),(539844,'Equitas Holdings Ltd'),(543243,'Equitas Small Finance Bank Ltd'),(540596,'Eris Lifesciences Ltd'),(500133,'Esab India Ltd'),(500495,'Escorts Ltd'),(500086,'Exide Industries Ltd'),(531599,'FDC Ltd'),(500469,'Federal Bank Ltd'),(541557,'Fine Organic Industries Ltd'),(500144,'Finolex Cables Ltd'),(500940,'Finolex Industries Ltd'),(532809,'Firstsource Solutions Ltd'),(532843,'Fortis Healthcare Ltd.'),(532155,'Gail India Ltd'),(540935,'Galaxy Surfactants Ltd'),(509557,'Garware Technical Fibres Ltd'),(540755,'General Insurance Corporation of India'),(500171,'GHCL Ltd'),(507815,'Gillette India Ltd'),(543245,'Gland Pharma Ltd'),(500660,'GlaxoSmithKline Pharmaceuticals Ltd'),(532296,'Glenmark Pharmaceuticals Ltd'),(505255,'GMM Pfaudler Limited'),(500163,'Godfrey Phillips India Ltd'),(540743,'Godrej Agrovet Ltd'),(532424,'Godrej Consumer Products Ltd'),(500164,'Godrej Industries Ltd'),(533150,'Godrej Properties Ltd'),(532482,'Granules India Ltd'),(509488,'Graphite India Ltd.'),(500300,'Grasim Industries Ltd'),(500620,'Great Eastern Shipping Co Ltd/The'),(501455,'Greaves Cotton Ltd.'),(506076,'Grindwell Norton Ltd'),(530001,'Gujarat Alkalies & Chemicals Ltd.'),(542812,'Gujarat Fluorochemicals Ltd'),(539336,'Gujarat Gas Ltd'),(500670,'Gujarat Narmada Valley Fertilizers and Chemicals Limited'),(533248,'Gujarat Pipavav Port Ltd'),(500690,'Gujarat State Fertilisers & Chemicals Ltd'),(532702,'Gujarat State Petronet Ltd'),(538567,'Gulf Oil Lubricants India Ltd'),(543227,'Happiest Minds Technologies Ltd'),(533162,'Hathway Cables and Datacom Ltd'),(531531,'Hatsun Agro Products Ltd'),(517354,'Havells India Ltd'),(508486,'HawkiBO Cookers Ltd'),(532281,'HCL Technologies Ltd'),(541729,'HDFC Asset Management Company Ltd'),(500180,'HDFC Bank Ltd'),(540777,'HDFC Life Insurance Company Ltd'),(509631,'HEG Ltd'),(500292,'HeidelbergCement India Ltd.'),(500182,'Hero MotoCorp Ltd'),(500183,'HFCL Ltd'),(524735,'Hikal Ltd.'),(500440,'Hindalco Industries Ltd'),(541154,'Hindustan Aeronautics Ltd'),(513599,'Hindustan Copper'),(500104,'Hindustan Petroleum Corp Ltd'),(500696,'Hindustan Unilever Ltd'),(500188,'Hindustan Zinc Ltd'),(543187,'Hitachi Energy India Ltd'),(517174,'Honeywell Automation India Ltd'),(540530,'Housing and Urban Development Corporation Ltd'),(500010,'Housing Development Finance Corp'),(532174,'ICICI Bank Ltd'),(540716,'ICICI Lombard General Insurance Company Ltd'),(540133,'ICICI Prudential Life Insurance Company Ltd'),(541179,'ICICI Securities Ltd'),(500116,'IDBI Bank Ltd'),(539437,'IDFC First Bank Ltd'),(532659,'IDFC Limited'),(505726,'IFB Industries Ltd'),(532636,'IIFL Finance Ltd'),(542772,'IIFL Wealth Management Ltd'),(530005,'India Cements Ltd'),(532189,'India Tourism Development Corp Ltd'),(535789,'Indiabulls Housing Finance Limited'),(532832,'Indiabulls Real Estate Ltd'),(542726,'Indiamart Intermesh Limited'),(532814,'Indian Bank'),(540750,'Indian Energy Exchange Ltd'),(500850,'Indian Hotels Co Ltd'),(530965,'Indian Oil Corp Ltd'),(532388,'Indian Overseas Bank'),(542830,'Indian Railway Catering and Tourism Corporation Ltd'),(543257,'Indian Railway Finance Corporation Limited'),(543258,'Indigo Paints Ltd'),(532612,'Indoco Remedies Ltd.'),(541336,'Indostar Capital Finance Ltd'),(532514,'Indraprastha Gas Ltd'),(534816,'Indus Towers Ltd'),(532187,'IndusInd Bank Ltd'),(539807,'Infibeam Avenues Ltd'),(532777,'Info Edge (India) Ltd.'),(500209,'Infosys Ltd'),(532706,'Inox Leisure'),(538835,'Intellect Design Arena Ltd.'),(539448,'InterGlobe Aviation Ltd'),(524164,'IOL Chemicals and Pharmaceuticals Ltd'),(524494,'Ipca Laboratories Ltd'),(532947,'IRB Infrastructure Developers Ltd'),(541956,'IRCON International Ltd'),(500875,'ITC Ltd'),(523610,'ITI Ltd'),(530007,'J. K. Tyre Industries Ltd'),(506943,'J.B.Chemicals & Pharmaceuticals Ltd.'),(532644,'J.K. Cement Ltd.'),(520051,'Jamna Auto Industries Ltd'),(500378,'Jindal SAW Ltd'),(539597,'Jindal Stainless (Hisar) Ltd'),(532508,'Jindal Stainless Ltd.'),(532286,'Jindal Steel & Power Ltd'),(500380,'JK Lakshmi Cement Ltd'),(532162,'JK Paper Ltd.'),(523405,'JM Financial Ltd'),(523398,'Johnson Controls -Hitachi Air Conditioning India Ltd'),(533148,'JSW Energy Ltd'),(500228,'JSW Steel Ltd'),(533155,'Jubilant FoodWorks Ltd'),(543271,'Jubilant Ingrevia Limited'),(530019,'Jubilant Pharmova Sciences Ltd'),(535648,'Just Dial Ltd'),(532926,'Jyothy Labs Ltd'),(500233,'Kajaria Ceramics Ltd.'),(522287,'Kalpataru Power Transmission Ltd'),(543278,'Kalyan Jewellers India Ltd'),(500165,'Kansai Nerolac Paints Ltd.'),(532899,'Kaveri Seed Co Ltd'),(532714,'KEC International Ltd/India'),(517569,'KEI Industries Ltd'),(540680,'KIOCL Ltd'),(532942,'KNR Constructions Ltd'),(500247,'Kotak Mahindra Bank Ltd'),(542651,'KPIT Technologies Ltd'),(532889,'KPR Mill Ltd'),(530813,'KRBL Ltd'),(543308,'Krishna Institute of Medical Sciences Ltd'),(500249,'KSB Ltd'),(533519,'L&T Finance Holdings Ltd'),(540115,'L&T Technology Services Ltd'),(526947,'La Opala Rg Ltd.'),(500252,'Lakshmi Machine Works Ltd'),(540005,'Larsen & Toubro Infotech Ltd'),(500510,'Larsen & Toubro Ltd'),(540222,'Laurus Labs Ltd'),(543277,'Laxmi Organic Industries Ltd'),(541233,'Lemon Tree Hotels Ltd'),(500253,'LIC Housing Finance Ltd'),(523457,'Linde India Ltd'),(500257,'Lupin Ltd'),(539542,'Lux Industries Ltd'),(543287,'Macrotech Developers Ltd'),(539957,'Mahanagar Gas Ltd'),(500266,'Maharashtra Scooters Ltd.'),(532720,'Mahindra & Mahindra Financial Services Ltd'),(500520,'Mahindra & Mahindra Ltd'),(532756,'Mahindra CIE Automotive Ltd'),(533088,'Mahindra Holidays & Resorts India Ltd'),(532313,'Mahindra Lifespace Developers Ltd'),(540768,'Mahindra Logistics Ltd'),(531213,'Manappuram Finance Ltd'),(500109,'Mangalore Refinery & Petrochemicals Ltd'),(531642,'Marico Ltd'),(532500,'Maruti Suzuki India Ltd'),(540749,'MAS Financial Services Ltd'),(523704,'Mastek Ltd'),(500271,'Max Financial Services Ltd'),(543220,'Max Healthcare Institute Ltd'),(543237,'Mazagon Dock Shipbuilders Ltd'),(542650,'Metropolis Healthcare Ltd'),(538962,'Minda Corporation Ltd'),(532539,'Minda Industries Ltd'),(532819,'MindTree Ltd'),(541195,'Mishra Dhatu Nigam Ltd'),(513377,'MMTC LTD'),(533286,'MOIL Ltd'),(532892,'Motilal Oswal Financial Services Ltd'),(526299,'MphasiS Ltd'),(500290,'MRF Ltd'),(534091,'Multi Commodity Exchange of India Limited'),(533398,'Muthoot Finance Ltd'),(539551,'Narayana Hrudayalaya Ltd'),(524816,'Natco Pharma Ltd'),(532234,'National Aluminium Co Ltd'),(532504,'Navin Fluorine International Ltd.'),(534309,'NBCC (India) Ltd'),(500294,'NCC Ltd/India'),(505355,'Nesco Ltd.'),(500790,'Nestle India Ltd'),(532798,'Network 18 Media & Investments Ltd'),(533098,'NHPC Ltd'),(523385,'Nilkamal Ltd'),(540767,'Nippon Life India Asset Management Ltd'),(513683,'NLC India Ltd'),(526371,'NMDC Ltd'),(500730,'NOCIL Ltd.'),(532555,'NTPC Ltd'),(533273,'Oberoi Realty Ltd'),(500312,'Oil & Natural Gas Corp Ltd'),(533106,'Oil India Ltd'),(532466,'Oracle Financial Services Software Ltd'),(541301,'Orient Electric Ltd'),(532827,'Page Industries Ltd'),(506590,'PCBL Ltd'),(533179,'Persistent Systems Ltd'),(532522,'Petronet LNG Ltd'),(500680,'Pfizer Ltd (India)'),(503100,'Phoenix Mills Ltd'),(523642,'PI Industries Ltd'),(500331,'Pidilite Industries Ltd'),(500302,'Piramal Enterprises Ltd'),(540173,'PNB Housing Finance Ltd'),(539150,'PNC Infratech Ltd'),(531768,'Poly Medicure Ltd'),(542652,'Polycab India Ltd'),(524000,'Poonawalla Fincorp Ltd'),(532810,'Power Finance Corp Ltd'),(532898,'Power Grid Corp of India Ltd'),(522205,'Praj Industries Ltd'),(533274,'Prestige Estates Projects Ltd'),(542907,'Prince Pipes and Fittings Ltd'),(500338,'Prism Johnson Ltd'),(500126,'Procter & Gamble Health Limited'),(500459,'Procter & Gamble Hygiene & Health Care Ltd'),(532524,'PTC India Ltd'),(533295,'Punjab & Sind Bank'),(532461,'Punjab National Bank'),(532689,'PVR Ltd'),(539978,'Quess Corp Ltd'),(532497,'Radico Khaitan Ltd'),(542649,'Rail Vikas Nigam Ltd'),(500339,'Rain Industries Limited'),(531500,'Rajesh Exports Ltd'),(500355,'Rallis India Ltd'),(500260,'Ramco Cements Ltd'),(524230,'Rashtriya Chemicals & Fertilizers Ltd.'),(520111,'Ratnamani Metals & Tubes Ltd'),(540065,'RBL Bank Ltd'),(532955,'REC Ltd'),(532805,'Redington India Ltd'),(530517,'Relaxo Footwears Ltd'),(500325,'Reliance Industries Ltd'),(505509,'Responsive Industries Ltd.'),(543248,'Restaurant Brands Asia Ltd'),(534076,'Rhi Magnesita India Ltd'),(541556,'RITES Ltd'),(543213,'Rossari Biotech Ltd'),(543228,'Route Mobile Ltd'),(500368,'Ruchi Soya Industries Ltd'),(500674,'Sanofi India Ltd'),(532163,'Saregama India Ltd'),(543066,'SBI Cards and Payment Services Limited'),(540719,'SBI Life Insurance Company Ltd'),(505790,'Schaeffler India Ltd'),(512529,'Sequent Scientific Ltd'),(540203,'Sheela Foam Ltd'),(530549,'Shilpa Medicare Ltd'),(523598,'Shipping Corp of India Ltd'),(500387,'Shree Cement Ltd'),(532498,'Shriram City Union Finance Ltd.'),(511218,'Shriram Transport Finance Co Ltd'),(543299,'Shyam Metalics and Energy Ltd'),(500550,'Siemens India Ltd'),(540673,'SIS Limited'),(533206,'SJVN Ltd'),(500472,'SKF India Ltd'),(532784,'Sobha Limited'),(532725,'Solar Industries India Ltd'),(541540,'Solara Active Pharma Sciences Ltd'),(543300,'Sona BLW Precision Forgings Ltd'),(532221,'Sonata Software Ltd'),(542759,'Spandana Sphoorty Financial Ltd'),(500285,'SpiceJet Ltd.'),(503806,'SRF Ltd'),(540575,'Star Cement Ltd'),(500112,'State Bank of India'),(500113,'Steel Authority of India Ltd'),(542760,'Sterling and Wilson Renewable Energy Ltd'),(532374,'Sterlite Technologies Ltd.'),(532531,'Strides Pharma Science Ltd'),(506655,'Sudarshan Chemical Industries'),(542920,'Sumitomo Chemical India Ltd'),(532872,'Sun Pharma Advanced Research Co Ltd'),(524715,'Sun Pharmaceutical Industries Ltd'),(532733,'Sun TV Network Ltd'),(520056,'Sundaram Clayton Ltd'),(500403,'Sundaram Fastners'),(512179,'Sunteck Realty Ltd'),(509930,'Supreme Industries'),(543064,'Suven Pharmaceuticals Limited'),(532667,'Suzlon Energy Ltd'),(503310,'Swan Energy Ltd.'),(517385,'Symphony Ltd'),(539268,'Syngene International Ltd'),(532790,'Tanla Platforms Ltd'),(519091,'Tasty Bite Eatables Ltd'),(500770,'Tata Chemicals Ltd'),(532301,'Tata Coffee Ltd.'),(500483,'Tata Communications Ltd'),(532540,'Tata Consultancy Services Ltd'),(500800,'Tata Consumer Products Ltd'),(500408,'Tata Elxsi Ltd'),(501301,'Tata Investment Corp Ltd'),(513434,'Tata Metaliks Ltd.'),(500570,'Tata Motors Ltd'),(570001,'Tata Motors Ltd DVR'),(500400,'Tata Power Co Ltd'),(500470,'Tata Steel Ltd'),(532371,'Tata Teleservices Maharashtra Ltd'),(540212,'TCI Express Ltd'),(541700,'TCNS Clothing Co. Ltd'),(539658,'TeamLease Services Ltd'),(532755,'Tech Mahindra Ltd'),(540769,'The New India Assurance Company Ltd'),(500411,'Thermax Ltd'),(539871,'Thyrocare Technologies Ltd'),(522113,'Timken India Ltd.'),(500114,'Titan Co Ltd'),(500420,'Torrent Pharmaceuticals Ltd'),(532779,'Torrent Power Ltd'),(500251,'Trent Ltd.'),(521064,'Trident Ltd.'),(533655,'Triveni Turbine Limited'),(517506,'TTK Prestige Ltd'),(540762,'Tube Investments Of India'),(532800,'TV18 Broadcast Ltd'),(532343,'TVS Motor Co Ltd'),(532505,'UCO Bank'),(500148,'Uflex Ltd'),(542904,'Ujjivan Small Finance Bank Ltd'),(532538,'UltraTech Cement Ltd'),(532477,'Union Bank of India'),(532478,'United Breweries Ltd'),(512070,'UPL Ltd'),(543238,'UTI Asset Management Company Ltd'),(532953,'V-Guard Industries Ltd'),(534976,'V-Mart Retail Limited'),(532156,'Vaibhav Global Ltd'),(511431,'Vakrangee Ltd'),(502986,'Vardhman Textiles Ltd.'),(541578,'Varroc Engineering Ltd'),(540180,'Varun Beverages Ltd'),(500295,'Vedanta Ltd'),(523261,'Venky''s India Ltd'),(524200,'Vinati Organics Ltd'),(507880,'VIP Industries Ltd'),(532822,'Vodafone Idea Ltd'),(500575,'Voltas Ltd'),(509966,'VST Industries Ltd.'),(532144,'Welspun Corp Ltd'),(514162,'Welspun India Ltd.'),(505533,'Westlife Development Ltd'),(500238,'Whirlpool of India Ltd'),(507685,'Wipro Ltd'),(532300,'Wockhardt Ltd'),(532648,'Yes Bank Ltd'),(505537,'Zee Entertainment Enterprises Ltd'),(504067,'Zensar Technologies Ltd'),(533023,'ZF Commercial Vehicle Control Systems India Ltd'),(543320,'Zomato Ltd'),(532321,'Zydus Lifesciences Ltd'),(531335,'Zydus Wellness Ltd')
	    ) 
	    select 
	    stock_code, 
	    stock_name, 
	    (
	        with sma as (
	        SELECT 
	            trade_date, 
	            close, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 19 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma20, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 49 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma50, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 199 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma200 
	        FROM 
	            bse 
	        where 
	            code = indices.stock_code
	        ), 
	        delta as(
	        select 
	            *, 
	            lead(sma200, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma200, 
	            lead(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma50, 
	            lag(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as prev_sma50 
	        from 
	            sma
	        ), 
	        rising as (
	        select 
	            *, 
	            case when next_sma200 - sma200 > 0 then TRUE else FALSE end is_sma200_rising, 
	            case when prev_sma50 < sma200 
	            and next_sma50 > sma200 then TRUE else FALSE end goldencross 
	        from 
	            delta
	        ), 
	        top5 as (
	        select 
	            * 
	        from 
	            rising 
	        order by 
	            trade_date desc 
	        limit 
	            1 
	        offset    5
	        ) 
	        select 
	        case when sum(is_sma200_rising::int) = 5 
	        and sum(goldencross::int) > 0 then TRUE else FALSE end tudor_trading_signal 
	        from 
	        top5
	    ) as tudor_trade 
	    from 
	    indices 
	    where 
	    tudor_trade > 0   
	    
2022-06-02 01:44:07.950 IST [8956] ERROR:  canceling statement due to user request
2022-06-02 01:44:07.950 IST [8956] STATEMENT:  
	    with indices(stock_code, stock_name) as (
	    values 
	    (523395,'3M India Ltd'),(524348,'Aarti Drugs Ltd'),(524208,'Aarti Industries Ltd.'),(541988,'AAVAS Financiers Ltd'),(500002,'ABB India Ltd'),(500488,'Abbott India Ltd'),(500410,'ACC Ltd'),(512599,'Adani Enterprises Ltd'),(541450,'Adani Green Energy Ltd'),(532921,'Adani Ports and Special Economic Zone'),(533096,'Adani Power Ltd'),(542066,'Adani Total Gas Limited'),(539254,'Adani Transmission Ltd'),(540691,'Aditya Birla Capital Ltd'),(535755,'Aditya Birla Fashion and Retail Ltd'),(540025,'Advanced Enzyme Technologies Ltd'),(500003,'Aegis Logistics Ltd'),(542752,'Affle (India) Ltd'),(532683,'AIA Engineering Ltd'),(532331,'Ajanta Pharma Ltd'),(500710,'Akzo Nobel India Ltd'),(533573,'Alembic Pharmaceuticals Ltd'),(539523,'Alkem Laboratories Ltd'),(506767,'Alkyl Amines Chemicals Ltd'),(532749,'AllCargo Logistics Ltd'),(521070,'Alok Industries Ltd'),(500008,'Amara Raja Batteries Ltd'),(540902,'Amber Enterprises India Ltd'),(500425,'Ambuja Cements Ltd'),(543235,'Angel One Limited'),(543275,'Anupam Rasayan India Ltd'),(533758,'APL Apollo Tubes Ltd'),(508869,'Apollo Hospitals Enterprise Ltd'),(500877,'Apollo Tyres Ltd'),(515030,'Asahi India Glass Ltd'),(500477,'Ashok Leyland Ltd'),(500820,'Asian Paints Ltd'),(540975,'Aster DM Healthcare Ltd'),(532830,'ASTRAL LIMITED'),(506820,'AstraZeneca Pharm India'),(500027,'Atul Ltd.'),(540611,'AU Small Finance Bank Ltd'),(524804,'Aurobindo Pharma Ltd'),(512573,'Avanti Feeds Ltd'),(540376,'Avenue Supermarts Ltd'),(532215,'Axis Bank Ltd'),(532977,'Bajaj Auto Ltd'),(533229,'Bajaj Consumer Care Ltd'),(500031,'Bajaj Electricals Ltd'),(500034,'Bajaj Finance Ltd'),(532978,'Bajaj Finserv Ltd'),(500490,'Bajaj Holdings and Investment Ltd'),(530999,'Balaji Amines Ltd'),(502355,'Balkrishna Industries Ltd'),(500038,'Balrampur Chini Mills Ltd'),(541153,'Bandhan Bank Ltd'),(532134,'Bank of Baroda'),(532149,'Bank of India'),(532525,'Bank Of Maharashtra'),(500042,'BASF India Limited'),(500043,'Bata India Ltimited'),(506285,'Bayer CropScience Ltd/India'),(500048,'BEML Ltd'),(509480,'Berger Paints India Ltd'),(541143,'Bharat Dynamics Ltd'),(500049,'Bharat Electronics Ltd'),(500493,'Bharat Forge Ltd'),(500103,'Bharat Heavy Electricals Ltd'),(500547,'Bharat Petroleum Corp Ltd'),(532454,'Bharti Airtel Ltd'),(532523,'Biocon Ltd'),(500335,'Birla Corp Ltd'),(532400,'Birlasoft Ltd'),(526612,'Blue Dart Express Ltd'),(500067,'Blue Star Ltd'),(501425,'Bombay Burmah Trading Corp Ltd.'),(500530,'Bosch Ltd'),(532929,'Brigade Enterprises Ltd'),(532368,'Brightcom Group Ltd'),(500825,'Britannia Industries Ltd.'),(511196,'Can Fin Homes Ltd'),(532483,'Canara Bank'),(524742,'Caplin Point Laboratories Ltd'),(531595,'Capri Global Capital  LTD'),(513375,'Carborundum Universal Ltd'),(500870,'Castrol India Ltd'),(519600,'CCL Products (India) Ltd.'),(500878,'CEAT Ltd'),(532885,'Central Bank of India'),(532548,'Century Plyboards India Ltd'),(500040,'Century Textile & Industries Ltd'),(532443,'Cera Sanitaryware Ltd'),(500084,'CESC Ltd'),(542399,'Chalet Hotels Ltd'),(500085,'Chambal Fertilizers & Chemicals Ltd'),(504973,'Cholamandalam Financial Holdings Ltd'),(511243,'Cholamandalam Investment & Finance Co. Ltd.'),(500087,'Cipla Ltd/India'),(532210,'City Union Bank Ltd.'),(533278,'Coal India Ltd'),(540678,'Cochin Shipyard Ltd'),(532541,'Coforge Ltd'),(500830,'Colgate-Palmolive India Ltd'),(543232,'Computer Age Management Services Ltd'),(531344,'Container Corp Of India'),(506395,'Coromandel International Ltd'),(541770,'CreditAccess Grameen Ltd'),(500092,'CRISIL Ltd'),(539876,'Crompton Greaves Consumer Electricals Ltd'),(542867,'CSB Bank Ltd'),(500480,'Cummins India Ltd'),(532175,'Cyient Ltd'),(500096,'Dabur India Ltd'),(542216,'Dalmia Bharat Ltd'),(532772,'DCB Bank Ltd'),(523367,'DCM Shriram Ltd'),(500645,'Deepak Fertilisers & Petrochemicals Corp. Ltd.'),(506401,'Deepak Nitrite Limited'),(532848,'Delta Corp. Ltd.'),(507717,'Dhanuka Agritech Ltd'),(540047,'Dilip Buildcon Ltd'),(540701,'Dishman Carbogen Amics Ltd'),(532488,'Divi''s Laboratories Ltd'),(540699,'Dixon Technologies (India) Ltd'),(532868,'DLF Ltd'),(500124,'Dr Reddy''s Laboratories Ltd'),(539524,'Dr. Lal PathLabs Ltd'),(532927,'eClerx Services Ltd'),(532922,'Edelweiss Financial Services Ltd'),(505200,'Eicher Motors Ltd'),(500125,'EID Parry India Ltd'),(500840,'EIH Ltd'),(522074,'Elgi Equipments Ltd.'),(531162,'Emami Ltd'),(540153,'Endurance Technologies Ltd'),(532178,'Engineers India Ltd'),(500135,'EPL Ltd'),(539844,'Equitas Holdings Ltd'),(543243,'Equitas Small Finance Bank Ltd'),(540596,'Eris Lifesciences Ltd'),(500133,'Esab India Ltd'),(500495,'Escorts Ltd'),(500086,'Exide Industries Ltd'),(531599,'FDC Ltd'),(500469,'Federal Bank Ltd'),(541557,'Fine Organic Industries Ltd'),(500144,'Finolex Cables Ltd'),(500940,'Finolex Industries Ltd'),(532809,'Firstsource Solutions Ltd'),(532843,'Fortis Healthcare Ltd.'),(532155,'Gail India Ltd'),(540935,'Galaxy Surfactants Ltd'),(509557,'Garware Technical Fibres Ltd'),(540755,'General Insurance Corporation of India'),(500171,'GHCL Ltd'),(507815,'Gillette India Ltd'),(543245,'Gland Pharma Ltd'),(500660,'GlaxoSmithKline Pharmaceuticals Ltd'),(532296,'Glenmark Pharmaceuticals Ltd'),(505255,'GMM Pfaudler Limited'),(500163,'Godfrey Phillips India Ltd'),(540743,'Godrej Agrovet Ltd'),(532424,'Godrej Consumer Products Ltd'),(500164,'Godrej Industries Ltd'),(533150,'Godrej Properties Ltd'),(532482,'Granules India Ltd'),(509488,'Graphite India Ltd.'),(500300,'Grasim Industries Ltd'),(500620,'Great Eastern Shipping Co Ltd/The'),(501455,'Greaves Cotton Ltd.'),(506076,'Grindwell Norton Ltd'),(530001,'Gujarat Alkalies & Chemicals Ltd.'),(542812,'Gujarat Fluorochemicals Ltd'),(539336,'Gujarat Gas Ltd'),(500670,'Gujarat Narmada Valley Fertilizers and Chemicals Limited'),(533248,'Gujarat Pipavav Port Ltd'),(500690,'Gujarat State Fertilisers & Chemicals Ltd'),(532702,'Gujarat State Petronet Ltd'),(538567,'Gulf Oil Lubricants India Ltd'),(543227,'Happiest Minds Technologies Ltd'),(533162,'Hathway Cables and Datacom Ltd'),(531531,'Hatsun Agro Products Ltd'),(517354,'Havells India Ltd'),(508486,'HawkiBO Cookers Ltd'),(532281,'HCL Technologies Ltd'),(541729,'HDFC Asset Management Company Ltd'),(500180,'HDFC Bank Ltd'),(540777,'HDFC Life Insurance Company Ltd'),(509631,'HEG Ltd'),(500292,'HeidelbergCement India Ltd.'),(500182,'Hero MotoCorp Ltd'),(500183,'HFCL Ltd'),(524735,'Hikal Ltd.'),(500440,'Hindalco Industries Ltd'),(541154,'Hindustan Aeronautics Ltd'),(513599,'Hindustan Copper'),(500104,'Hindustan Petroleum Corp Ltd'),(500696,'Hindustan Unilever Ltd'),(500188,'Hindustan Zinc Ltd'),(543187,'Hitachi Energy India Ltd'),(517174,'Honeywell Automation India Ltd'),(540530,'Housing and Urban Development Corporation Ltd'),(500010,'Housing Development Finance Corp'),(532174,'ICICI Bank Ltd'),(540716,'ICICI Lombard General Insurance Company Ltd'),(540133,'ICICI Prudential Life Insurance Company Ltd'),(541179,'ICICI Securities Ltd'),(500116,'IDBI Bank Ltd'),(539437,'IDFC First Bank Ltd'),(532659,'IDFC Limited'),(505726,'IFB Industries Ltd'),(532636,'IIFL Finance Ltd'),(542772,'IIFL Wealth Management Ltd'),(530005,'India Cements Ltd'),(532189,'India Tourism Development Corp Ltd'),(535789,'Indiabulls Housing Finance Limited'),(532832,'Indiabulls Real Estate Ltd'),(542726,'Indiamart Intermesh Limited'),(532814,'Indian Bank'),(540750,'Indian Energy Exchange Ltd'),(500850,'Indian Hotels Co Ltd'),(530965,'Indian Oil Corp Ltd'),(532388,'Indian Overseas Bank'),(542830,'Indian Railway Catering and Tourism Corporation Ltd'),(543257,'Indian Railway Finance Corporation Limited'),(543258,'Indigo Paints Ltd'),(532612,'Indoco Remedies Ltd.'),(541336,'Indostar Capital Finance Ltd'),(532514,'Indraprastha Gas Ltd'),(534816,'Indus Towers Ltd'),(532187,'IndusInd Bank Ltd'),(539807,'Infibeam Avenues Ltd'),(532777,'Info Edge (India) Ltd.'),(500209,'Infosys Ltd'),(532706,'Inox Leisure'),(538835,'Intellect Design Arena Ltd.'),(539448,'InterGlobe Aviation Ltd'),(524164,'IOL Chemicals and Pharmaceuticals Ltd'),(524494,'Ipca Laboratories Ltd'),(532947,'IRB Infrastructure Developers Ltd'),(541956,'IRCON International Ltd'),(500875,'ITC Ltd'),(523610,'ITI Ltd'),(530007,'J. K. Tyre Industries Ltd'),(506943,'J.B.Chemicals & Pharmaceuticals Ltd.'),(532644,'J.K. Cement Ltd.'),(520051,'Jamna Auto Industries Ltd'),(500378,'Jindal SAW Ltd'),(539597,'Jindal Stainless (Hisar) Ltd'),(532508,'Jindal Stainless Ltd.'),(532286,'Jindal Steel & Power Ltd'),(500380,'JK Lakshmi Cement Ltd'),(532162,'JK Paper Ltd.'),(523405,'JM Financial Ltd'),(523398,'Johnson Controls -Hitachi Air Conditioning India Ltd'),(533148,'JSW Energy Ltd'),(500228,'JSW Steel Ltd'),(533155,'Jubilant FoodWorks Ltd'),(543271,'Jubilant Ingrevia Limited'),(530019,'Jubilant Pharmova Sciences Ltd'),(535648,'Just Dial Ltd'),(532926,'Jyothy Labs Ltd'),(500233,'Kajaria Ceramics Ltd.'),(522287,'Kalpataru Power Transmission Ltd'),(543278,'Kalyan Jewellers India Ltd'),(500165,'Kansai Nerolac Paints Ltd.'),(532899,'Kaveri Seed Co Ltd'),(532714,'KEC International Ltd/India'),(517569,'KEI Industries Ltd'),(540680,'KIOCL Ltd'),(532942,'KNR Constructions Ltd'),(500247,'Kotak Mahindra Bank Ltd'),(542651,'KPIT Technologies Ltd'),(532889,'KPR Mill Ltd'),(530813,'KRBL Ltd'),(543308,'Krishna Institute of Medical Sciences Ltd'),(500249,'KSB Ltd'),(533519,'L&T Finance Holdings Ltd'),(540115,'L&T Technology Services Ltd'),(526947,'La Opala Rg Ltd.'),(500252,'Lakshmi Machine Works Ltd'),(540005,'Larsen & Toubro Infotech Ltd'),(500510,'Larsen & Toubro Ltd'),(540222,'Laurus Labs Ltd'),(543277,'Laxmi Organic Industries Ltd'),(541233,'Lemon Tree Hotels Ltd'),(500253,'LIC Housing Finance Ltd'),(523457,'Linde India Ltd'),(500257,'Lupin Ltd'),(539542,'Lux Industries Ltd'),(543287,'Macrotech Developers Ltd'),(539957,'Mahanagar Gas Ltd'),(500266,'Maharashtra Scooters Ltd.'),(532720,'Mahindra & Mahindra Financial Services Ltd'),(500520,'Mahindra & Mahindra Ltd'),(532756,'Mahindra CIE Automotive Ltd'),(533088,'Mahindra Holidays & Resorts India Ltd'),(532313,'Mahindra Lifespace Developers Ltd'),(540768,'Mahindra Logistics Ltd'),(531213,'Manappuram Finance Ltd'),(500109,'Mangalore Refinery & Petrochemicals Ltd'),(531642,'Marico Ltd'),(532500,'Maruti Suzuki India Ltd'),(540749,'MAS Financial Services Ltd'),(523704,'Mastek Ltd'),(500271,'Max Financial Services Ltd'),(543220,'Max Healthcare Institute Ltd'),(543237,'Mazagon Dock Shipbuilders Ltd'),(542650,'Metropolis Healthcare Ltd'),(538962,'Minda Corporation Ltd'),(532539,'Minda Industries Ltd'),(532819,'MindTree Ltd'),(541195,'Mishra Dhatu Nigam Ltd'),(513377,'MMTC LTD'),(533286,'MOIL Ltd'),(532892,'Motilal Oswal Financial Services Ltd'),(526299,'MphasiS Ltd'),(500290,'MRF Ltd'),(534091,'Multi Commodity Exchange of India Limited'),(533398,'Muthoot Finance Ltd'),(539551,'Narayana Hrudayalaya Ltd'),(524816,'Natco Pharma Ltd'),(532234,'National Aluminium Co Ltd'),(532504,'Navin Fluorine International Ltd.'),(534309,'NBCC (India) Ltd'),(500294,'NCC Ltd/India'),(505355,'Nesco Ltd.'),(500790,'Nestle India Ltd'),(532798,'Network 18 Media & Investments Ltd'),(533098,'NHPC Ltd'),(523385,'Nilkamal Ltd'),(540767,'Nippon Life India Asset Management Ltd'),(513683,'NLC India Ltd'),(526371,'NMDC Ltd'),(500730,'NOCIL Ltd.'),(532555,'NTPC Ltd'),(533273,'Oberoi Realty Ltd'),(500312,'Oil & Natural Gas Corp Ltd'),(533106,'Oil India Ltd'),(532466,'Oracle Financial Services Software Ltd'),(541301,'Orient Electric Ltd'),(532827,'Page Industries Ltd'),(506590,'PCBL Ltd'),(533179,'Persistent Systems Ltd'),(532522,'Petronet LNG Ltd'),(500680,'Pfizer Ltd (India)'),(503100,'Phoenix Mills Ltd'),(523642,'PI Industries Ltd'),(500331,'Pidilite Industries Ltd'),(500302,'Piramal Enterprises Ltd'),(540173,'PNB Housing Finance Ltd'),(539150,'PNC Infratech Ltd'),(531768,'Poly Medicure Ltd'),(542652,'Polycab India Ltd'),(524000,'Poonawalla Fincorp Ltd'),(532810,'Power Finance Corp Ltd'),(532898,'Power Grid Corp of India Ltd'),(522205,'Praj Industries Ltd'),(533274,'Prestige Estates Projects Ltd'),(542907,'Prince Pipes and Fittings Ltd'),(500338,'Prism Johnson Ltd'),(500126,'Procter & Gamble Health Limited'),(500459,'Procter & Gamble Hygiene & Health Care Ltd'),(532524,'PTC India Ltd'),(533295,'Punjab & Sind Bank'),(532461,'Punjab National Bank'),(532689,'PVR Ltd'),(539978,'Quess Corp Ltd'),(532497,'Radico Khaitan Ltd'),(542649,'Rail Vikas Nigam Ltd'),(500339,'Rain Industries Limited'),(531500,'Rajesh Exports Ltd'),(500355,'Rallis India Ltd'),(500260,'Ramco Cements Ltd'),(524230,'Rashtriya Chemicals & Fertilizers Ltd.'),(520111,'Ratnamani Metals & Tubes Ltd'),(540065,'RBL Bank Ltd'),(532955,'REC Ltd'),(532805,'Redington India Ltd'),(530517,'Relaxo Footwears Ltd'),(500325,'Reliance Industries Ltd'),(505509,'Responsive Industries Ltd.'),(543248,'Restaurant Brands Asia Ltd'),(534076,'Rhi Magnesita India Ltd'),(541556,'RITES Ltd'),(543213,'Rossari Biotech Ltd'),(543228,'Route Mobile Ltd'),(500368,'Ruchi Soya Industries Ltd'),(500674,'Sanofi India Ltd'),(532163,'Saregama India Ltd'),(543066,'SBI Cards and Payment Services Limited'),(540719,'SBI Life Insurance Company Ltd'),(505790,'Schaeffler India Ltd'),(512529,'Sequent Scientific Ltd'),(540203,'Sheela Foam Ltd'),(530549,'Shilpa Medicare Ltd'),(523598,'Shipping Corp of India Ltd'),(500387,'Shree Cement Ltd'),(532498,'Shriram City Union Finance Ltd.'),(511218,'Shriram Transport Finance Co Ltd'),(543299,'Shyam Metalics and Energy Ltd'),(500550,'Siemens India Ltd'),(540673,'SIS Limited'),(533206,'SJVN Ltd'),(500472,'SKF India Ltd'),(532784,'Sobha Limited'),(532725,'Solar Industries India Ltd'),(541540,'Solara Active Pharma Sciences Ltd'),(543300,'Sona BLW Precision Forgings Ltd'),(532221,'Sonata Software Ltd'),(542759,'Spandana Sphoorty Financial Ltd'),(500285,'SpiceJet Ltd.'),(503806,'SRF Ltd'),(540575,'Star Cement Ltd'),(500112,'State Bank of India'),(500113,'Steel Authority of India Ltd'),(542760,'Sterling and Wilson Renewable Energy Ltd'),(532374,'Sterlite Technologies Ltd.'),(532531,'Strides Pharma Science Ltd'),(506655,'Sudarshan Chemical Industries'),(542920,'Sumitomo Chemical India Ltd'),(532872,'Sun Pharma Advanced Research Co Ltd'),(524715,'Sun Pharmaceutical Industries Ltd'),(532733,'Sun TV Network Ltd'),(520056,'Sundaram Clayton Ltd'),(500403,'Sundaram Fastners'),(512179,'Sunteck Realty Ltd'),(509930,'Supreme Industries'),(543064,'Suven Pharmaceuticals Limited'),(532667,'Suzlon Energy Ltd'),(503310,'Swan Energy Ltd.'),(517385,'Symphony Ltd'),(539268,'Syngene International Ltd'),(532790,'Tanla Platforms Ltd'),(519091,'Tasty Bite Eatables Ltd'),(500770,'Tata Chemicals Ltd'),(532301,'Tata Coffee Ltd.'),(500483,'Tata Communications Ltd'),(532540,'Tata Consultancy Services Ltd'),(500800,'Tata Consumer Products Ltd'),(500408,'Tata Elxsi Ltd'),(501301,'Tata Investment Corp Ltd'),(513434,'Tata Metaliks Ltd.'),(500570,'Tata Motors Ltd'),(570001,'Tata Motors Ltd DVR'),(500400,'Tata Power Co Ltd'),(500470,'Tata Steel Ltd'),(532371,'Tata Teleservices Maharashtra Ltd'),(540212,'TCI Express Ltd'),(541700,'TCNS Clothing Co. Ltd'),(539658,'TeamLease Services Ltd'),(532755,'Tech Mahindra Ltd'),(540769,'The New India Assurance Company Ltd'),(500411,'Thermax Ltd'),(539871,'Thyrocare Technologies Ltd'),(522113,'Timken India Ltd.'),(500114,'Titan Co Ltd'),(500420,'Torrent Pharmaceuticals Ltd'),(532779,'Torrent Power Ltd'),(500251,'Trent Ltd.'),(521064,'Trident Ltd.'),(533655,'Triveni Turbine Limited'),(517506,'TTK Prestige Ltd'),(540762,'Tube Investments Of India'),(532800,'TV18 Broadcast Ltd'),(532343,'TVS Motor Co Ltd'),(532505,'UCO Bank'),(500148,'Uflex Ltd'),(542904,'Ujjivan Small Finance Bank Ltd'),(532538,'UltraTech Cement Ltd'),(532477,'Union Bank of India'),(532478,'United Breweries Ltd'),(512070,'UPL Ltd'),(543238,'UTI Asset Management Company Ltd'),(532953,'V-Guard Industries Ltd'),(534976,'V-Mart Retail Limited'),(532156,'Vaibhav Global Ltd'),(511431,'Vakrangee Ltd'),(502986,'Vardhman Textiles Ltd.'),(541578,'Varroc Engineering Ltd'),(540180,'Varun Beverages Ltd'),(500295,'Vedanta Ltd'),(523261,'Venky''s India Ltd'),(524200,'Vinati Organics Ltd'),(507880,'VIP Industries Ltd'),(532822,'Vodafone Idea Ltd'),(500575,'Voltas Ltd'),(509966,'VST Industries Ltd.'),(532144,'Welspun Corp Ltd'),(514162,'Welspun India Ltd.'),(505533,'Westlife Development Ltd'),(500238,'Whirlpool of India Ltd'),(507685,'Wipro Ltd'),(532300,'Wockhardt Ltd'),(532648,'Yes Bank Ltd'),(505537,'Zee Entertainment Enterprises Ltd'),(504067,'Zensar Technologies Ltd'),(533023,'ZF Commercial Vehicle Control Systems India Ltd'),(543320,'Zomato Ltd'),(532321,'Zydus Lifesciences Ltd'),(531335,'Zydus Wellness Ltd')
	    ) 
	    select 
	    stock_code, 
	    stock_name, 
	    (
	        with sma as (
	        SELECT 
	            trade_date, 
	            close, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 19 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma20, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 49 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma50, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 199 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma200 
	        FROM 
	            bse 
	        where 
	            code = indices.stock_code
	        ), 
	        delta as(
	        select 
	            *, 
	            lead(sma200, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma200, 
	            lead(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma50, 
	            lag(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as prev_sma50 
	        from 
	            sma
	        ), 
	        rising as (
	        select 
	            *, 
	            case when next_sma200 - sma200 > 0 then TRUE else FALSE end is_sma200_rising, 
	            case when prev_sma50 < sma200 
	            and next_sma50 > sma200 then TRUE else FALSE end goldencross 
	        from 
	            delta
	        ), 
	        top5 as (
	        select 
	            * 
	        from 
	            rising 
	        order by 
	            trade_date desc 
	        limit 
	            1 
	        offset    5
	        ) 
	        select 
	        case when sum(is_sma200_rising::int) = 5 
	        and sum(goldencross::int) > 0 then TRUE else FALSE end tudor_trading_signal 
	        from 
	        top5
	    ) as tudor_trade 
	    from 
	    indices 
	  
	    
2022-06-02 01:48:49.634 IST [8956] ERROR:  syntax error at end of input at character 2117
2022-06-02 01:48:49.634 IST [8956] STATEMENT:  
	    with indices(stock_code, stock_name) as (
	    values 
	(533023,'ZF Commercial Vehicle Control Systems India Ltd'),(543320,'Zomato Ltd'),(532321,'Zydus Lifesciences Ltd'),(531335,'Zydus Wellness Ltd')
	    ) 
	    select 
	    stock_code, 
	    stock_name, 
	    (
	        with sma as (
	        SELECT 
	            trade_date, 
	            close, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 19 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma20, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 49 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma50, 
	            AVG(close) OVER(
	            ORDER BY 
	                trade_date ROWS BETWEEN 199 PRECEDING 
	                AND CURRENT ROW
	            ) AS sma200 
	        FROM 
	            bse 
	        where 
	            code = indices.stock_code
	        ), 
	        delta as(
	        select 
	            *, 
	            lead(sma200, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma200, 
	            lead(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as next_sma50, 
	            lag(sma50, 1, 0) over (
	            order by 
	                trade_date
	            ) as prev_sma50 
	        from 
	            sma
	        ), 
	        rising as (
	        select 
	            *, 
	            case when next_sma200 - sma200 > 0 then TRUE else FALSE end is_sma200_rising, 
	            case when prev_sma50 < sma200 
	            and next_sma50 > sma200 then TRUE else FALSE end goldencross 
	        from 
	            delta
	        ), 
	        top5 as (
	        select 
	            * 
	        from 
	            rising 
	        order by 
	            trade_date desc 
	        limit 
	            1 
	        offset    5
	        ) 
	        select 
	        case when sum(is_sma200_rising::int) = 5 
	        and sum(goldencross::int) > 0 then TRUE else FALSE end tudor_trading_signal 
	        from 
	        top5
2022-06-02 01:50:55.365 IST [9720] LOG:  received fast shutdown request
2022-06-02 01:50:55.374 IST [9720] LOG:  aborting any active transactions
2022-06-02 01:50:55.400 IST [9720] LOG:  background worker "logical replication launcher" (PID 26440) exited with exit code 1
2022-06-02 01:50:55.412 IST [16940] LOG:  shutting down
2022-06-02 01:50:55.630 IST [9720] LOG:  database system is shut down
2022-07-08 19:05:56.047 IST [2940] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-08 19:05:56.058 IST [2940] LOG:  listening on IPv6 address "::1", port 5432
2022-07-08 19:05:56.064 IST [2940] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-08 19:05:56.131 IST [21456] LOG:  database system was shut down at 2022-06-02 01:50:55 IST
2022-07-08 19:05:56.263 IST [2940] LOG:  database system is ready to accept connections
2022-07-08 19:05:58.641 IST [2940] LOG:  received fast shutdown request
2022-07-08 19:05:58.645 IST [2940] LOG:  aborting any active transactions
2022-07-08 19:05:58.665 IST [2940] LOG:  background worker "logical replication launcher" (PID 9976) exited with exit code 1
2022-07-08 19:05:58.666 IST [14900] LOG:  shutting down
2022-07-08 19:05:58.758 IST [2940] LOG:  database system is shut down
2022-07-08 19:05:59.365 IST [22492] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-08 19:05:59.376 IST [22492] LOG:  listening on IPv6 address "::1", port 5432
2022-07-08 19:05:59.382 IST [22492] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-08 19:05:59.447 IST [20920] LOG:  database system was shut down at 2022-07-08 19:05:58 IST
2022-07-08 19:05:59.587 IST [22492] LOG:  database system is ready to accept connections
2022-07-08 19:07:46.596 IST [16988] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-08 19:07:46.608 IST [16988] LOG:  listening on IPv6 address "::1", port 5432
2022-07-08 19:07:46.614 IST [16988] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-08 19:07:46.682 IST [11936] LOG:  database system was interrupted; last known up at 2022-07-08 19:05:59 IST
2022-07-08 19:07:47.138 IST [11936] LOG:  database system was not properly shut down; automatic recovery in progress
2022-07-08 19:07:47.143 IST [11936] LOG:  redo starts at 0/2AB9F0F8
2022-07-08 19:07:47.143 IST [11936] LOG:  invalid record length at 0/2AB9F130: wanted 24, got 0
2022-07-08 19:07:47.143 IST [11936] LOG:  redo done at 0/2AB9F0F8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-07-08 19:07:47.296 IST [16988] LOG:  database system is ready to accept connections
2022-07-08 19:07:51.244 IST [16988] LOG:  received fast shutdown request
2022-07-08 19:07:51.255 IST [16988] LOG:  aborting any active transactions
2022-07-08 19:07:51.262 IST [16988] LOG:  background worker "logical replication launcher" (PID 24920) exited with exit code 1
2022-07-08 19:07:51.284 IST [12160] LOG:  shutting down
2022-07-08 19:07:51.362 IST [16988] LOG:  database system is shut down
2022-07-08 19:07:51.972 IST [1164] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-08 19:07:51.984 IST [1164] LOG:  listening on IPv6 address "::1", port 5432
2022-07-08 19:07:51.990 IST [1164] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-08 19:07:52.054 IST [25072] LOG:  database system was shut down at 2022-07-08 19:07:51 IST
2022-07-08 19:07:52.160 IST [1164] LOG:  database system is ready to accept connections
2022-07-09 16:24:02.368 IST [8764] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-09 16:24:02.381 IST [8764] LOG:  listening on IPv6 address "::1", port 5432
2022-07-09 16:24:02.387 IST [8764] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-09 16:24:02.445 IST [24464] LOG:  database system was interrupted; last known up at 2022-07-08 19:30:36 IST
2022-07-09 16:24:02.869 IST [24464] LOG:  database system was not properly shut down; automatic recovery in progress
2022-07-09 16:24:02.877 IST [24464] LOG:  redo starts at 0/2AB9F478
2022-07-09 16:24:02.878 IST [24464] LOG:  invalid record length at 0/2AB9F560: wanted 24, got 0
2022-07-09 16:24:02.878 IST [24464] LOG:  redo done at 0/2AB9F528 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-07-09 16:24:02.998 IST [8764] LOG:  database system is ready to accept connections
2022-07-14 15:15:51.471 IST [2572] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 15:15:51.482 IST [2572] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 15:15:51.488 IST [2572] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 15:15:51.596 IST [3224] LOG:  database system was interrupted; last known up at 2022-07-09 16:29:03 IST
2022-07-14 15:15:56.082 IST [3224] LOG:  database system was not properly shut down; automatic recovery in progress
2022-07-14 15:15:56.086 IST [3224] LOG:  redo starts at 0/2AB9FA68
2022-07-14 15:15:56.087 IST [3224] LOG:  invalid record length at 0/2AB9FB50: wanted 24, got 0
2022-07-14 15:15:56.087 IST [3224] LOG:  redo done at 0/2AB9FB18 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-07-14 15:15:56.198 IST [2572] LOG:  database system is ready to accept connections
2022-07-14 16:09:27.497 IST [23028] ERROR:  syntax error at end of input at character 20
2022-07-14 16:09:27.497 IST [23028] STATEMENT:  create table test
	
2022-07-14 16:09:54.660 IST [23028] ERROR:  syntax error at end of input at character 20
2022-07-14 16:09:54.660 IST [23028] STATEMENT:  create table test
	
2022-07-14 16:10:11.947 IST [23028] ERROR:  relation "test" already exists
2022-07-14 16:10:11.947 IST [23028] STATEMENT:  create table test()
2022-07-14 16:10:21.637 IST [23028] ERROR:  syntax error at or near "if" at character 8
2022-07-14 16:10:21.637 IST [23028] STATEMENT:  create if not exists table test()
2022-07-14 16:10:29.955 IST [23028] ERROR:  syntax error at or near "text" at character 34
2022-07-14 16:10:29.955 IST [23028] STATEMENT:  
	alter table test add col1 type text
2022-07-14 16:10:36.860 IST [23028] ERROR:  syntax error at or near "text" at character 34
2022-07-14 16:10:36.860 IST [23028] STATEMENT:  
	alter table test add col1 type text
2022-07-14 16:10:48.025 IST [23028] ERROR:  column "col1" of relation "test" already exists
2022-07-14 16:10:48.025 IST [23028] STATEMENT:  
	alter table test add col1 text
2022-07-14 16:10:50.357 IST [23028] ERROR:  column "col1" of relation "test" already exists
2022-07-14 16:10:50.357 IST [23028] STATEMENT:  
	alter table test add col1 text
2022-07-14 16:11:44.756 IST [22392] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:12:28.699 IST [5292] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:12:46.602 IST [24520] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:13:15.967 IST [8188] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:13:32.842 IST [11840] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:14:01.057 IST [22732] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:14:15.768 IST [2692] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:14:46.168 IST [18864] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:16:27.918 IST [8520] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 16:19:01.068 IST [23028] ERROR:  syntax error at end of input at character 150
2022-07-14 16:19:01.068 IST [23028] STATEMENT:  Create function double_close(close numeric)  
	returns numeric  
	language plpgsql  
	as  
	$$  
	Declare  
	 
	Begin  
	 	return 2 * close
	End;  
	$$  
2022-07-14 16:20:21.878 IST [23028] ERROR:  language "plpythonu" does not exist
2022-07-14 16:20:21.878 IST [23028] HINT:  Use CREATE EXTENSION to load the language into the database.
2022-07-14 16:20:21.878 IST [23028] STATEMENT:  CREATE FUNCTION double_close (close numeric)
	  RETURNS numeric
	AS $$
	return 2 * close
	$$ LANGUAGE plpythonu
2022-07-14 16:20:27.460 IST [23028] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-14.2-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-07-14 16:20:27.460 IST [23028] STATEMENT:  
	CREATE FUNCTION double_close (close numeric)
	  RETURNS numeric
	AS $$
	return 2 * close
	$$ LANGUAGE plpython3u
2022-07-14 16:22:25.296 IST [23028] ERROR:  extension "plpython3u" already exists
2022-07-14 16:22:25.296 IST [23028] STATEMENT:  
	create extension plpython3u
2022-07-14 16:22:33.472 IST [23028] ERROR:  could not load library "C:/Users/pranjan24/Downloads/postgresql-14.2-2-windows-x64-binaries/pgsql/lib/plpython3.dll": The specified module could not be found.
	
2022-07-14 16:22:33.472 IST [23028] STATEMENT:  CREATE FUNCTION double_close (close numeric)
	  RETURNS numeric
	AS $$
	return 2 * close
	$$ LANGUAGE plpython3u
	
2022-07-14 16:24:55.015 IST [18120] ERROR:  canceling statement due to user request
2022-07-14 16:24:55.016 IST [2572] LOG:  received fast shutdown request
2022-07-14 16:24:55.031 IST [2572] LOG:  aborting any active transactions
2022-07-14 16:24:55.032 IST [23028] FATAL:  terminating connection due to administrator command
2022-07-14 16:24:55.032 IST [7156] FATAL:  terminating connection due to administrator command
2022-07-14 16:24:55.042 IST [2572] LOG:  background worker "logical replication launcher" (PID 18120) exited with exit code 1
2022-07-14 16:24:55.073 IST [23004] LOG:  shutting down
2022-07-14 16:24:55.152 IST [2572] LOG:  database system is shut down
2022-07-14 16:24:58.124 IST [26840] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 16:24:58.135 IST [26840] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 16:24:58.141 IST [26840] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 16:24:58.312 IST [15784] LOG:  database system was shut down at 2022-07-14 16:24:55 IST
2022-07-14 16:24:58.398 IST [26840] LOG:  database system is ready to accept connections
2022-07-14 16:25:03.813 IST [26840] LOG:  received fast shutdown request
2022-07-14 16:25:03.816 IST [26840] LOG:  aborting any active transactions
2022-07-14 16:25:03.848 IST [26840] LOG:  background worker "logical replication launcher" (PID 22900) exited with exit code 1
2022-07-14 16:25:03.849 IST [12216] LOG:  shutting down
2022-07-14 16:25:03.926 IST [26840] LOG:  database system is shut down
2022-07-14 16:26:18.489 IST [10748] LOG:  starting PostgreSQL 14.4, compiled by Visual C++ build 1914, 64-bit
2022-07-14 16:26:18.501 IST [10748] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 16:26:18.508 IST [10748] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 16:26:18.590 IST [6352] LOG:  database system was shut down at 2022-07-14 16:25:03 IST
2022-07-14 16:26:18.683 IST [10748] LOG:  database system is ready to accept connections
2022-07-14 16:40:34.987 IST [10748] LOG:  received fast shutdown request
2022-07-14 16:40:34.990 IST [10748] LOG:  aborting any active transactions
2022-07-14 16:40:35.008 IST [10748] LOG:  background worker "logical replication launcher" (PID 17952) exited with exit code 1
2022-07-14 16:40:35.011 IST [6848] LOG:  shutting down
2022-07-14 16:40:35.103 IST [10748] LOG:  database system is shut down
2022-07-14 16:40:35.698 IST [11576] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 16:40:35.709 IST [11576] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 16:40:35.715 IST [11576] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 16:40:35.879 IST [252] LOG:  database system was shut down at 2022-07-14 16:40:35 IST
2022-07-14 16:40:35.962 IST [11576] LOG:  database system is ready to accept connections
2022-07-14 16:50:13.686 IST [11576] LOG:  server process (PID 14648) was terminated by exception 0xC000013A
2022-07-14 16:50:13.686 IST [11576] DETAIL:  Failed process was running: 
	select * from double_close(20)
2022-07-14 16:50:13.686 IST [11576] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-07-14 16:50:13.686 IST [11576] LOG:  terminating any other active server processes
2022-07-14 16:50:13.722 IST [11576] LOG:  statistics collector process (PID 11692) was terminated by exception 0xC000013A
2022-07-14 16:50:13.722 IST [11576] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-07-14 16:50:13.723 IST [11576] LOG:  all server processes terminated; reinitializing
^C2022-07-14 17:11:51.910 IST [10540] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 17:11:51.922 IST [10540] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 17:11:51.929 IST [10540] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 17:11:51.986 IST [9340] LOG:  database system was shut down at 2022-07-14 17:11:16 IST
2022-07-14 17:11:52.063 IST [10540] LOG:  database system is ready to accept connections
2022-07-14 17:12:13.463 IST [10496] ERROR:  canceling statement due to user request
2022-07-14 17:12:13.467 IST [10540] LOG:  received fast shutdown request
2022-07-14 17:12:13.472 IST [10540] LOG:  aborting any active transactions
2022-07-14 17:12:13.473 IST [9384] FATAL:  terminating connection due to administrator command
2022-07-14 17:12:13.483 IST [10540] LOG:  background worker "logical replication launcher" (PID 10496) exited with exit code 1
2022-07-14 17:12:13.499 IST [21700] LOG:  shutting down
2022-07-14 17:12:13.566 IST [10540] LOG:  database system is shut down
2022-07-14 17:12:22.553 IST [25732] LOG:  starting PostgreSQL 14.4, compiled by Visual C++ build 1914, 64-bit
2022-07-14 17:12:22.565 IST [25732] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 17:12:22.571 IST [25732] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 17:12:22.645 IST [19848] LOG:  database system was shut down at 2022-07-14 17:12:13 IST
2022-07-14 17:12:22.717 IST [25732] LOG:  database system is ready to accept connections
2022-07-14 17:12:35.174 IST [25732] LOG:  received fast shutdown request
2022-07-14 17:12:35.178 IST [25732] LOG:  aborting any active transactions
2022-07-14 17:12:35.199 IST [25732] LOG:  background worker "logical replication launcher" (PID 22744) exited with exit code 1
2022-07-14 17:12:35.199 IST [3880] LOG:  shutting down
2022-07-14 17:12:35.268 IST [25732] LOG:  database system is shut down
2022-07-14 17:12:35.762 IST [11472] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 17:12:35.772 IST [11472] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 17:12:35.779 IST [11472] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 17:12:35.836 IST [26940] LOG:  database system was shut down at 2022-07-14 17:12:35 IST
2022-07-14 17:12:35.928 IST [11472] LOG:  database system is ready to accept connections
2022-07-14 17:12:40.868 IST [11472] LOG:  received fast shutdown request
2022-07-14 17:12:40.871 IST [11472] LOG:  aborting any active transactions
2022-07-14 17:12:40.880 IST [11472] LOG:  background worker "logical replication launcher" (PID 13632) exited with exit code 1
2022-07-14 17:12:40.889 IST [11904] LOG:  shutting down
2022-07-14 17:12:40.951 IST [11472] LOG:  database system is shut down
2022-07-14 17:12:41.514 IST [8784] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 17:12:41.525 IST [8784] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 17:12:41.531 IST [8784] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 17:12:41.588 IST [23072] LOG:  database system was shut down at 2022-07-14 17:12:40 IST
2022-07-14 17:12:41.669 IST [8784] LOG:  database system is ready to accept connections
2022-07-14 17:14:48.935 IST [20564] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 17:18:51.524 IST [25608] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 17:19:02.258 IST [11412] ERROR:  generation expression is not immutable
2022-07-14 17:19:02.258 IST [11412] STATEMENT:  alter table myapp_stocks  add if not exists trade_date date;alter table myapp_stocks  add if not exists name text;alter table myapp_stocks  add if not exists close numeric;alter table myapp_stocks  add if not exists double_close numeric GENERATED ALWAYS AS (double_close(close)) stored
2022-07-14 17:19:36.847 IST [26168] ERROR:  function "double_close" already exists with same argument types
2022-07-14 17:19:36.847 IST [26168] STATEMENT:  CREATE FUNCTION double_close (close numeric)
	  RETURNS numeric
	AS $$
	return 2 * close
	$$ LANGUAGE plpython3u immutable
	
2022-07-14 17:36:31.258 IST [27092] ERROR:  column "matplotlib_test" is of type bytea but default expression is of type text
2022-07-14 17:36:31.258 IST [27092] HINT:  You will need to rewrite or cast the expression.
2022-07-14 17:36:31.258 IST [27092] STATEMENT:  alter table myapp_stocks  add if not exists trade_date date;alter table myapp_stocks  add if not exists name text;alter table myapp_stocks  add if not exists close numeric;alter table myapp_stocks  add if not exists double_close numeric GENERATED ALWAYS AS (double_close(close)) stored;alter table myapp_stocks  add if not exists matplotlib_test bytea GENERATED ALWAYS AS (matplotlib_test(close)) stored
2022-07-14 18:45:57.610 IST [25232] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 18:57:44.637 IST [2444] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 18:57:44.647 IST [2444] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 18:57:44.653 IST [2444] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 18:57:44.710 IST [12948] LOG:  database system was interrupted; last known up at 2022-07-14 18:28:10 IST
2022-07-14 18:57:45.117 IST [12948] LOG:  database system was not properly shut down; automatic recovery in progress
2022-07-14 18:57:45.127 IST [12948] LOG:  redo starts at 0/2AD0AA88
2022-07-14 18:57:45.127 IST [12948] LOG:  invalid record length at 0/2AD0AB70: wanted 24, got 0
2022-07-14 18:57:45.128 IST [12948] LOG:  redo done at 0/2AD0AB38 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-07-14 18:57:45.244 IST [2444] LOG:  database system is ready to accept connections
2022-07-14 18:58:17.641 IST [20400] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 18:58:28.040 IST [25564] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:07:01.614 IST [14108] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:07:45.862 IST [26352] ERROR:  canceling statement due to user request
2022-07-14 19:07:45.864 IST [2444] LOG:  received fast shutdown request
2022-07-14 19:07:45.867 IST [2444] LOG:  aborting any active transactions
2022-07-14 19:07:45.894 IST [2444] LOG:  background worker "logical replication launcher" (PID 26352) exited with exit code 1
2022-07-14 19:07:45.909 IST [13460] LOG:  shutting down
2022-07-14 19:07:45.973 IST [2444] LOG:  database system is shut down
2022-07-14 19:07:47.757 IST [21620] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 19:07:47.767 IST [21620] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 19:07:47.773 IST [21620] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 19:07:47.829 IST [13800] LOG:  database system was shut down at 2022-07-14 19:07:45 IST
2022-07-14 19:07:47.903 IST [21620] LOG:  database system is ready to accept connections
2022-07-14 19:09:48.557 IST [25476] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:12:07.735 IST [2052] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:12:32.895 IST [19760] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:12:45.312 IST [14240] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:12:59.807 IST [4332] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:13:35.976 IST [25744] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:14:25.871 IST [12856] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:16:11.034 IST [18316] ERROR:  canceling statement due to user request
2022-07-14 19:16:11.035 IST [21620] LOG:  received fast shutdown request
2022-07-14 19:16:11.046 IST [21620] LOG:  aborting any active transactions
2022-07-14 19:16:11.047 IST [6392] FATAL:  terminating connection due to administrator command
2022-07-14 19:16:11.057 IST [21620] LOG:  background worker "logical replication launcher" (PID 18316) exited with exit code 1
2022-07-14 19:16:11.091 IST [6356] LOG:  shutting down
2022-07-14 19:16:11.135 IST [21620] LOG:  database system is shut down
2022-07-14 19:16:12.456 IST [17808] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 19:16:12.468 IST [17808] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 19:16:12.474 IST [17808] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 19:16:12.653 IST [22240] LOG:  database system was shut down at 2022-07-14 19:16:11 IST
2022-07-14 19:16:12.749 IST [17808] LOG:  database system is ready to accept connections
2022-07-14 19:16:41.480 IST [11624] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:16:55.921 IST [21036] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:17:54.721 IST [14176] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:18:20.797 IST [26208] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:18:32.168 IST [14136] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:19:00.270 IST [21928] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:24:10.620 IST [4016] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 19:25:29.715 IST [25504] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:28:04.262 IST [18688] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:28:25.179 IST [25008] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:28:28.306 IST [14608] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:30:13.546 IST [18092] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:31:21.787 IST [9240] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:32:36.183 IST [20912] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:39:44.061 IST [8804] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:40:02.790 IST [11848] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:42:26.064 IST [17748] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:44:24.383 IST [1308] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 21:44:46.515 IST [19848] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:09:16.309 IST [13112] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:11:08.987 IST [8456] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:13:50.127 IST [5112] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:14:13.376 IST [2572] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:14:38.236 IST [16664] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:15:05.207 IST [12044] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:15:25.153 IST [11524] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:15:27.440 IST [6352] ERROR:  null value in column "is_calculated" of relation "octopgpyapp_field" violates not-null constraint
2022-07-14 22:15:27.440 IST [6352] DETAIL:  Failing row contains (6, SC_CODE, null, null, null, null, 1).
2022-07-14 22:15:27.440 IST [6352] STATEMENT:  INSERT INTO "octopgpyapp_field" ("name", "type", "document_id", "is_calculated", "calculation_func", "calculation_func_args") VALUES ('SC_CODE', NULL, 1, NULL, NULL, NULL) RETURNING "octopgpyapp_field"."id"
2022-07-14 22:15:42.578 IST [22144] ERROR:  null value in column "is_calculated" of relation "octopgpyapp_field" violates not-null constraint
2022-07-14 22:15:42.578 IST [22144] DETAIL:  Failing row contains (7, SC_CODE, null, null, null, null, 1).
2022-07-14 22:15:42.578 IST [22144] STATEMENT:  INSERT INTO "octopgpyapp_field" ("name", "type", "document_id", "is_calculated", "calculation_func", "calculation_func_args") VALUES ('SC_CODE', NULL, 1, NULL, NULL, NULL) RETURNING "octopgpyapp_field"."id"
2022-07-14 22:16:20.808 IST [16712] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:17:12.043 IST [19248] ERROR:  syntax error at or near "None" at character 456
2022-07-14 22:17:12.043 IST [19248] STATEMENT:  alter table myapp_stocks  add if not exists trade_date date;alter table myapp_stocks  add if not exists name text;alter table myapp_stocks  add if not exists close numeric;alter table myapp_stocks  add if not exists double_close numeric GENERATED ALWAYS AS (double_close(close)) stored;alter table myapp_stocks  add if not exists matplotlib_test text GENERATED ALWAYS AS (matplotlib_test(close)) stored;alter table myapp_stocks  add if not exists SC_CODE None;alter table myapp_stocks  add if not exists SC_NAME None;alter table myapp_stocks  add if not exists SC_GROUP None;alter table myapp_stocks  add if not exists SC_TYPE None;alter table myapp_stocks  add if not exists OPEN None;alter table myapp_stocks  add if not exists HIGH None;alter table myapp_stocks  add if not exists LOW None;alter table myapp_stocks  add if not exists CLOSE None;alter table myapp_stocks  add if not exists LAST None;alter table myapp_stocks  add if not exists PREVCLOSE None;alter table myapp_stocks  add if not exists NO_TRADES None;alter table myapp_stocks  add if not exists NO_OF_SHRS None;alter table myapp_stocks  add if not exists NET_TURNOV None;alter table myapp_stocks  add if not exists TDCLOINDI None
2022-07-14 22:17:42.740 IST [19936] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:18:04.684 IST [4852] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:18:34.901 IST [24456] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:18:41.106 IST [10008] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:18:52.450 IST [18996] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:18:54.932 IST [19512] ERROR:  syntax error at or near "None" at character 456
2022-07-14 22:18:54.932 IST [19512] STATEMENT:  alter table myapp_stocks  add if not exists trade_date date;alter table myapp_stocks  add if not exists name text;alter table myapp_stocks  add if not exists close numeric;alter table myapp_stocks  add if not exists double_close numeric GENERATED ALWAYS AS (double_close(close)) stored;alter table myapp_stocks  add if not exists matplotlib_test text GENERATED ALWAYS AS (matplotlib_test(close)) stored;alter table myapp_stocks  add if not exists SC_CODE None;alter table myapp_stocks  add if not exists SC_NAME None;alter table myapp_stocks  add if not exists SC_GROUP None;alter table myapp_stocks  add if not exists SC_TYPE None;alter table myapp_stocks  add if not exists OPEN None;alter table myapp_stocks  add if not exists HIGH None;alter table myapp_stocks  add if not exists LOW None;alter table myapp_stocks  add if not exists CLOSE None;alter table myapp_stocks  add if not exists LAST None;alter table myapp_stocks  add if not exists PREVCLOSE None;alter table myapp_stocks  add if not exists NO_TRADES None;alter table myapp_stocks  add if not exists NO_OF_SHRS None;alter table myapp_stocks  add if not exists NET_TURNOV None;alter table myapp_stocks  add if not exists TDCLOINDI None
2022-07-14 22:18:57.725 IST [24840] ERROR:  syntax error at or near "None" at character 456
2022-07-14 22:18:57.725 IST [24840] STATEMENT:  alter table myapp_stocks  add if not exists trade_date date;alter table myapp_stocks  add if not exists name text;alter table myapp_stocks  add if not exists close numeric;alter table myapp_stocks  add if not exists double_close numeric GENERATED ALWAYS AS (double_close(close)) stored;alter table myapp_stocks  add if not exists matplotlib_test text GENERATED ALWAYS AS (matplotlib_test(close)) stored;alter table myapp_stocks  add if not exists SC_CODE None;alter table myapp_stocks  add if not exists SC_NAME None;alter table myapp_stocks  add if not exists SC_GROUP None;alter table myapp_stocks  add if not exists SC_TYPE None;alter table myapp_stocks  add if not exists OPEN None;alter table myapp_stocks  add if not exists HIGH None;alter table myapp_stocks  add if not exists LOW None;alter table myapp_stocks  add if not exists CLOSE None;alter table myapp_stocks  add if not exists LAST None;alter table myapp_stocks  add if not exists PREVCLOSE None;alter table myapp_stocks  add if not exists NO_TRADES None;alter table myapp_stocks  add if not exists NO_OF_SHRS None;alter table myapp_stocks  add if not exists NET_TURNOV None;alter table myapp_stocks  add if not exists TDCLOINDI None
2022-07-14 22:19:03.162 IST [2972] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:19:05.953 IST [13500] ERROR:  syntax error at or near "None" at character 456
2022-07-14 22:19:05.953 IST [13500] STATEMENT:  alter table myapp_stocks  add if not exists trade_date date;alter table myapp_stocks  add if not exists name text;alter table myapp_stocks  add if not exists close numeric;alter table myapp_stocks  add if not exists double_close numeric GENERATED ALWAYS AS (double_close(close)) stored;alter table myapp_stocks  add if not exists matplotlib_test text GENERATED ALWAYS AS (matplotlib_test(close)) stored;alter table myapp_stocks  add if not exists SC_CODE None;alter table myapp_stocks  add if not exists SC_NAME None;alter table myapp_stocks  add if not exists SC_GROUP None;alter table myapp_stocks  add if not exists SC_TYPE None;alter table myapp_stocks  add if not exists OPEN None;alter table myapp_stocks  add if not exists HIGH None;alter table myapp_stocks  add if not exists LOW None;alter table myapp_stocks  add if not exists CLOSE None;alter table myapp_stocks  add if not exists LAST None;alter table myapp_stocks  add if not exists PREVCLOSE None;alter table myapp_stocks  add if not exists NO_TRADES None;alter table myapp_stocks  add if not exists NO_OF_SHRS None;alter table myapp_stocks  add if not exists NET_TURNOV None;alter table myapp_stocks  add if not exists TDCLOINDI None
2022-07-14 22:19:57.569 IST [13176] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:20:41.682 IST [14432] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:21:51.868 IST [460] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:22:33.897 IST [19204] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:44:51.157 IST [21896] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:46:20.701 IST [1184] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:46:35.179 IST [16016] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:46:39.641 IST [9912] ERROR:  update or delete on table "octopgpyapp_document" violates foreign key constraint "octopgpyapp_field_document_id_c18b3796_fk_octopgpya" on table "octopgpyapp_field"
2022-07-14 22:46:39.641 IST [9912] DETAIL:  Key (id)=(1) is still referenced from table "octopgpyapp_field".
2022-07-14 22:46:39.641 IST [9912] STATEMENT:  COMMIT
2022-07-14 22:46:47.814 IST [26612] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:48:41.572 IST [10480] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:49:03.070 IST [904] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:49:29.232 IST [20492] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:49:59.465 IST [12552] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:51:15.863 IST [1664] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:51:38.744 IST [11504] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:53:18.085 IST [11704] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:54:32.172 IST [10660] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:57:50.624 IST [24036] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 22:58:05.162 IST [12444] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:00:06.079 IST [26720] ERROR:  canceling statement due to user request
2022-07-14 23:00:06.080 IST [17808] LOG:  received fast shutdown request
2022-07-14 23:00:06.085 IST [17808] LOG:  aborting any active transactions
2022-07-14 23:00:06.100 IST [17808] LOG:  background worker "logical replication launcher" (PID 26720) exited with exit code 1
2022-07-14 23:00:06.117 IST [25688] LOG:  shutting down
2022-07-14 23:00:06.183 IST [17808] LOG:  database system is shut down
2022-07-14 23:00:07.864 IST [2776] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 23:00:07.875 IST [2776] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 23:00:07.880 IST [2776] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 23:00:07.934 IST [26360] LOG:  database system was shut down at 2022-07-14 23:00:06 IST
2022-07-14 23:00:08.065 IST [2776] LOG:  database system is ready to accept connections
2022-07-14 23:01:31.348 IST [16032] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:01:42.792 IST [23916] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:01:56.372 IST [9540] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:03:13.224 IST [1196] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:04:39.742 IST [12064] ERROR:  canceling statement due to user request
2022-07-14 23:04:39.743 IST [2776] LOG:  received fast shutdown request
2022-07-14 23:04:39.755 IST [2776] LOG:  aborting any active transactions
2022-07-14 23:04:39.765 IST [2776] LOG:  background worker "logical replication launcher" (PID 12064) exited with exit code 1
2022-07-14 23:04:39.781 IST [11120] LOG:  shutting down
2022-07-14 23:04:39.847 IST [2776] LOG:  database system is shut down
2022-07-14 23:04:41.570 IST [6116] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-14 23:04:41.583 IST [6116] LOG:  listening on IPv6 address "::1", port 5432
2022-07-14 23:04:41.589 IST [6116] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-14 23:04:41.644 IST [23388] LOG:  database system was shut down at 2022-07-14 23:04:39 IST
2022-07-14 23:04:41.828 IST [6116] LOG:  database system is ready to accept connections
2022-07-14 23:05:18.022 IST [23356] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:10:54.154 IST [26524] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:11:36.913 IST [6884] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:14:34.533 IST [19276] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:16:43.222 IST [16808] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:30:02.345 IST [18336] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:30:10.720 IST [22688] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:30:16.946 IST [11880] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:30:26.190 IST [12688] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:30:30.345 IST [18476] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:30:56.361 IST [24556] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:32:58.614 IST [10100] ERROR:  invalid input syntax for type numeric: "" at character 171
2022-07-14 23:32:58.614 IST [10100] STATEMENT:  insert into myapp_stocks(SC_CODE,SC_NAME,SC_GROUP,SC_TYPE,OPEN,HIGH,LOW,CLOSE,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,TDCLOINDI,TRADE_DATE) values('','','','','','','','','','','','','','')
2022-07-14 23:33:45.651 IST [13972] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:33:52.028 IST [27644] ERROR:  invalid input syntax for type numeric: "" at character 171
2022-07-14 23:33:52.028 IST [27644] STATEMENT:  insert into myapp_stocks(SC_CODE,SC_NAME,SC_GROUP,SC_TYPE,OPEN,HIGH,LOW,CLOSE,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,TDCLOINDI,TRADE_DATE) values('','','','','','','','','','','','','','')
2022-07-14 23:34:23.589 IST [1780] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:34:51.761 IST [15976] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:36:02.800 IST [20216] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:36:52.053 IST [3864] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:39:08.208 IST [18844] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:39:15.475 IST [21324] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:44:24.240 IST [17684] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:45:46.866 IST [21844] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:46:10.265 IST [10820] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:46:15.276 IST [19952] ERROR:  TypeError: unsupported operand type(s) for *: 'int' and 'NoneType'
2022-07-14 23:46:15.276 IST [19952] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "double_close", line 2, in <module>
	    return 2 * close
	PL/Python function "double_close"
2022-07-14 23:46:15.276 IST [19952] STATEMENT:  insert into myapp_stocks(SC_CODE) values(934844)
2022-07-14 23:48:14.962 IST [23992] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:48:30.687 IST [22500] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:50:23.403 IST [23812] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-14 23:51:22.057 IST [13488] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:00:29.877 IST [22780] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:00:33.987 IST [12016] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:02:35.757 IST [6488] ERROR:  column "open" specified more than once at character 136
2022-07-15 00:02:35.757 IST [6488] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE,OPEN) values(1099.00,1100.11,1099.00,1100.11,1100.11,1100.00,'3','46',50570.00,'0MFL17      ','F ','D','','934844',1099.00)
2022-07-15 00:04:18.633 IST [172] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:04:48.218 IST [12756] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:04:58.476 IST [26836] ERROR:  syntax error at or near "S" at character 224
2022-07-15 00:04:58.476 IST [26836] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE) values(1111.05,1118.75,1095.00,1098.70,1098.70,1103.90,'696','12058',13338331.00,'DIVI'S LAB. ','A ','Q','','532488')
2022-07-15 00:05:34.435 IST [17412] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:05:40.666 IST [13016] ERROR:  syntax error at or near "S" at character 224
2022-07-15 00:05:40.666 IST [13016] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE) values(1111.05,1118.75,1095.00,1098.70,1098.70,1103.90,'696','12058',13338331.00,'DIVI'S LAB. ','A ','Q','','532488')
2022-07-15 00:07:51.125 IST [1004] ERROR:  syntax error at or near "S" at character 230
2022-07-15 00:07:51.125 IST [1004] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE) values(4360.00,4418.00,4340.10,4351.05,4348.45,4371.95,'2612','30706',134803456.00,'DR.REDDY'S  ','A ','Q','','500124')
2022-07-15 00:08:41.486 IST [11452] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:08:49.779 IST [15536] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:09:49.415 IST [24220] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:10:09.641 IST [18348] ERROR:  syntax error at or near "S" at character 228
2022-07-15 00:10:09.641 IST [18348] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE) values(2621.10,2633.00,2604.05,2610.80,2610.00,2617.00,'885','16782',43907724.00,'DR.REDDY'S  ','A ','Q','','500124')
2022-07-15 00:10:31.457 IST [2088] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:10:47.126 IST [23224] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:10:54.373 IST [13844] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:11:33.567 IST [8140] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:11:44.006 IST [26336] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:13:06.784 IST [17276] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:49:21.690 IST [10656] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 00:49:30.313 IST [6320] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 01:15:41.795 IST [11704] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:19:05.876 IST [3972] ERROR:  syntax error at or near "EXTRACT_TRADE_DATE" at character 10
2022-07-15 03:19:05.876 IST [3972] STATEMENT:  select * EXTRACT_TRADE_DATE('EQ010122')
2022-07-15 03:19:31.503 IST [3972] ERROR:  NameError: name 'FILE_NAME' is not defined
2022-07-15 03:19:31.503 IST [3972] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    dtobj = datetime.strptime(FILE_NAME[2:],'%d%m%y') 
	PL/Python function "extract_trade_date"
2022-07-15 03:19:31.503 IST [3972] STATEMENT:  select * from EXTRACT_TRADE_DATE('EQ010122')
2022-07-15 03:20:11.261 IST [3972] ERROR:  NameError: name 'FILE_NAME' is not defined
2022-07-15 03:20:11.261 IST [3972] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    dtobj = datetime.strptime(FILE_NAME[2:],'%d%m%y') 
	PL/Python function "extract_trade_date"
2022-07-15 03:20:11.261 IST [3972] STATEMENT:  
	select * from EXTRACT_TRADE_DATE('EQ010122')
2022-07-15 03:20:53.787 IST [3972] ERROR:  NameError: name 'FILE_NAME' is not defined
2022-07-15 03:20:53.787 IST [3972] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    dtobj = datetime.strptime(FILE_NAME[2:],'%d%m%y') 
	PL/Python function "extract_trade_date"
2022-07-15 03:20:53.787 IST [3972] STATEMENT:  
	
	select * from EXTRACT_TRADE_DATE('EQ010122')
2022-07-15 03:21:04.658 IST [3972] ERROR:  NameError: name 'FILE_NAME' is not defined
2022-07-15 03:21:04.658 IST [3972] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    dtobj = datetime.strptime(FILE_NAME[2:],'%d%m%y') 
	PL/Python function "extract_trade_date"
2022-07-15 03:21:04.658 IST [3972] STATEMENT:  select * from EXTRACT_TRADE_DATE('EQ010122')
2022-07-15 03:21:41.228 IST [3972] ERROR:  NameError: name 'F' is not defined
2022-07-15 03:21:41.228 IST [3972] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    dtobj = datetime.strptime(F[2:],'%d%m%y') 
	PL/Python function "extract_trade_date"
2022-07-15 03:21:41.228 IST [3972] STATEMENT:  
	
	select * from EXTRACT_TRADE_DATE('EQ010122')
2022-07-15 03:24:24.961 IST [8912] ERROR:  TypeError: 'NoneType' object is not subscriptable
2022-07-15 03:24:24.961 IST [8912] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    dtobj = datetime.strptime(f[2:],'%d%m%y') 
	PL/Python function "extract_trade_date"
2022-07-15 03:24:24.961 IST [8912] STATEMENT:  alter table myapp_stocks  add if not exists OPEN numeric;alter table myapp_stocks  add if not exists HIGH numeric;alter table myapp_stocks  add if not exists LOW numeric;alter table myapp_stocks  add if not exists CLOSE numeric;alter table myapp_stocks  add if not exists LAST numeric;alter table myapp_stocks  add if not exists PREVCLOSE numeric;alter table myapp_stocks  add if not exists NO_TRADES int;alter table myapp_stocks  add if not exists NO_OF_SHRS int;alter table myapp_stocks  add if not exists NET_TURNOV numeric;alter table myapp_stocks  add if not exists FILE_NAME text;alter table myapp_stocks  add if not exists TRADE_DATE timestamp GENERATED ALWAYS AS (EXTRACT_TRADE_DATE(FILE_NAME)) stored;alter table myapp_stocks  add if not exists SC_NAME text;alter table myapp_stocks  add if not exists SC_GROUP text;alter table myapp_stocks  add if not exists SC_TYPE text;alter table myapp_stocks  add if not exists TDCLOINDI text;alter table myapp_stocks  add if not exists SC_CODE int
2022-07-15 03:24:48.736 IST [3972] ERROR:  cannot change name of input parameter "f"
2022-07-15 03:24:48.736 IST [3972] HINT:  Use DROP FUNCTION extract_trade_date(text) first.
2022-07-15 03:24:48.736 IST [3972] STATEMENT:  
	create or replace FUNCTION EXTRACT_TRADE_DATE (file_name text)
	  RETURNS timestamp
	AS $$
	from datetime import datetime
	dtobj = datetime.strptime(file_name[2:],'%d%m%y') 
	dt = datetime.strftime(dtobj,'%Y-%m-%d')
	return dt
	$$ LANGUAGE plpython3u immutable
2022-07-15 03:24:54.169 IST [3972] ERROR:  cannot change name of input parameter "f"
2022-07-15 03:24:54.169 IST [3972] HINT:  Use DROP FUNCTION extract_trade_date(text) first.
2022-07-15 03:24:54.169 IST [3972] STATEMENT:  
	
	create or replace FUNCTION EXTRACT_TRADE_DATE (file_name text)
	  RETURNS timestamp
	AS $$
	from datetime import datetime
	dtobj = datetime.strptime(file_name[2:],'%d%m%y') 
	dt = datetime.strftime(dtobj,'%Y-%m-%d')
	return dt
	$$ LANGUAGE plpython3u immutable
2022-07-15 03:25:25.210 IST [3972] ERROR:  cannot change name of input parameter "f"
2022-07-15 03:25:25.210 IST [3972] HINT:  Use DROP FUNCTION extract_trade_date(text) first.
2022-07-15 03:25:25.210 IST [3972] STATEMENT:  
	create or replace FUNCTION EXTRACT_TRADE_DATE (FILE_NAME text)
	  RETURNS timestamp
	AS $$
	from datetime import datetime
	f = FILE_NAME[2:]
	dtobj = datetime.strptime(f,'%d%m%y') 
	dt = datetime.strftime(dtobj,'%Y-%m-%d')
	return dt
	$$ LANGUAGE plpython3u immutable
2022-07-15 03:25:48.475 IST [3972] ERROR:  NameError: name 'FILE_NAME' is not defined
2022-07-15 03:25:48.475 IST [3972] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    f = FILE_NAME[2:]
	PL/Python function "extract_trade_date"
2022-07-15 03:25:48.475 IST [3972] STATEMENT:  
	select * from EXTRACT_TRADE_DATE('EQ010122')
2022-07-15 03:26:06.027 IST [5292] ERROR:  TypeError: 'NoneType' object is not subscriptable
2022-07-15 03:26:06.027 IST [5292] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    f = file_name[2:]
	PL/Python function "extract_trade_date"
2022-07-15 03:26:06.027 IST [5292] STATEMENT:  alter table myapp_stocks  add if not exists OPEN numeric;alter table myapp_stocks  add if not exists HIGH numeric;alter table myapp_stocks  add if not exists LOW numeric;alter table myapp_stocks  add if not exists CLOSE numeric;alter table myapp_stocks  add if not exists LAST numeric;alter table myapp_stocks  add if not exists PREVCLOSE numeric;alter table myapp_stocks  add if not exists NO_TRADES int;alter table myapp_stocks  add if not exists NO_OF_SHRS int;alter table myapp_stocks  add if not exists NET_TURNOV numeric;alter table myapp_stocks  add if not exists FILE_NAME text;alter table myapp_stocks  add if not exists TRADE_DATE timestamp GENERATED ALWAYS AS (EXTRACT_TRADE_DATE(FILE_NAME)) stored;alter table myapp_stocks  add if not exists SC_NAME text;alter table myapp_stocks  add if not exists SC_GROUP text;alter table myapp_stocks  add if not exists SC_TYPE text;alter table myapp_stocks  add if not exists TDCLOINDI text;alter table myapp_stocks  add if not exists SC_CODE int
2022-07-15 03:27:36.591 IST [5284] ERROR:  canceling statement due to user request
2022-07-15 03:27:36.592 IST [6116] LOG:  received fast shutdown request
2022-07-15 03:27:36.596 IST [6116] LOG:  aborting any active transactions
2022-07-15 03:27:36.597 IST [3972] FATAL:  terminating connection due to administrator command
2022-07-15 03:27:36.597 IST [8244] FATAL:  terminating connection due to administrator command
2022-07-15 03:27:36.621 IST [6116] LOG:  background worker "logical replication launcher" (PID 5284) exited with exit code 1
2022-07-15 03:27:36.652 IST [22944] LOG:  shutting down
2022-07-15 03:27:36.791 IST [6116] LOG:  database system is shut down
2022-07-15 03:27:39.340 IST [13164] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-15 03:27:39.350 IST [13164] LOG:  listening on IPv6 address "::1", port 5432
2022-07-15 03:27:39.357 IST [13164] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-15 03:27:39.417 IST [11900] LOG:  database system was shut down at 2022-07-15 03:27:36 IST
2022-07-15 03:27:39.500 IST [13164] LOG:  database system is ready to accept connections
2022-07-15 03:27:51.609 IST [24220] ERROR:  TypeError: 'NoneType' object is not subscriptable
2022-07-15 03:27:51.609 IST [24220] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 3, in <module>
	    f = file_name[2:]
	PL/Python function "extract_trade_date"
2022-07-15 03:27:51.609 IST [24220] STATEMENT:  alter table myapp_stocks  add if not exists OPEN numeric;alter table myapp_stocks  add if not exists HIGH numeric;alter table myapp_stocks  add if not exists LOW numeric;alter table myapp_stocks  add if not exists CLOSE numeric;alter table myapp_stocks  add if not exists LAST numeric;alter table myapp_stocks  add if not exists PREVCLOSE numeric;alter table myapp_stocks  add if not exists NO_TRADES int;alter table myapp_stocks  add if not exists NO_OF_SHRS int;alter table myapp_stocks  add if not exists NET_TURNOV numeric;alter table myapp_stocks  add if not exists FILE_NAME text;alter table myapp_stocks  add if not exists TRADE_DATE timestamp GENERATED ALWAYS AS (EXTRACT_TRADE_DATE(FILE_NAME)) stored;alter table myapp_stocks  add if not exists SC_NAME text;alter table myapp_stocks  add if not exists SC_GROUP text;alter table myapp_stocks  add if not exists SC_TYPE text;alter table myapp_stocks  add if not exists TDCLOINDI text;alter table myapp_stocks  add if not exists SC_CODE int
2022-07-15 03:28:40.203 IST [12972] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:33:17.577 IST [18580] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:36:04.002 IST [14376] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:36:31.214 IST [11800] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:37:04.685 IST [9944] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:38:04.662 IST [13056] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:38:12.010 IST [14804] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:38:21.378 IST [25368] ERROR:  column "file_name" of relation "myapp_stocks" does not exist at character 136
2022-07-15 03:38:21.378 IST [25368] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE,file_name) values(193.55,198.90,193.50,196.05,196.05,193.50,'339','21825',4282753.00,'4282753.00','4282753.00','AEGIS LOGIS ','A ','Q','','500003',EQ010120.CSV)
2022-07-15 03:39:39.375 IST [26604] ERROR:  column "file_name" of relation "myapp_stocks" does not exist at character 136
2022-07-15 03:39:39.375 IST [26604] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE,file_name) values(252.00,258.00,249.85,255.05,255.45,251.80,'729','10250',2606022.00,'2606022.00','2606022.00','AEGIS LOGIS ','A ','Q','','500003',EQ010121.CSV)
2022-07-15 03:40:15.350 IST [21200] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:42:24.799 IST [10820] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:42:50.871 IST [20780] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:43:00.211 IST [19132] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:45:27.667 IST [21648] ERROR:  missing FROM-clause entry for table "eq010114" at character 282
2022-07-15 03:45:27.667 IST [21648] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE,file_name) values(180.25,185.00,178.10,179.65,179.65,181.30,'753','8165',1479322.00,'1479322.00','1479322.00','AEGIS LOGIS ','B ','Q','','500003',EQ010114.CSV)
2022-07-15 03:47:17.930 IST [16764] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:47:26.843 IST [16584] ERROR:  INSERT has more expressions than target columns at character 274
2022-07-15 03:47:26.843 IST [16584] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE,file_name) values(252.00,258.00,249.85,255.05,255.45,251.80,'729','10250',2606022.00,'2606022.00','2606022.00','AEGIS LOGIS ','A ','Q','','500003','EQ010121.CSV')
2022-07-15 03:51:06.534 IST [26196] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:51:30.627 IST [24536] ERROR:  INSERT has more expressions than target columns at character 288
2022-07-15 03:51:30.627 IST [24536] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE,file_name) values('288.00','294.35','282.35','289.10','288.25','286.35','401','15731','4549579.00','4549579.00','4549579.00','AEGIS LOGIS ','A ','Q','','500003','EQ010118.CSV')
2022-07-15 03:59:00.776 IST [19080] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 03:59:15.446 IST [19856] ERROR:  column "file_name" specified more than once at character 46
2022-07-15 03:59:15.446 IST [19856] STATEMENT:  insert into myapp_stocks(OPEN,file_name,HIGH,file_name,LOW,file_name,CLOSE,file_name,LAST,file_name,PREVCLOSE,file_name,NO_TRADES,file_name,NO_OF_SHRS,file_name,NET_TURNOV,file_name,file_name,file_name,SC_NAME,file_name,SC_GROUP,file_name,SC_TYPE,file_name,TDCLOINDI,file_name,SC_CODE,file_name) values('204.75','EQ010119.CSV','205.70','EQ010119.CSV','200.60','EQ010119.CSV','203.90','EQ010119.CSV','203.90','EQ010119.CSV','204.20','EQ010119.CSV','294','EQ010119.CSV','5672','EQ010119.CSV','1150504.00','EQ010119.CSV','1150504.00','EQ010119.CSV','1150504.00','EQ010119.CSV','AEGIS LOGIS ','EQ010119.CSV','A ','EQ010119.CSV','Q','EQ010119.CSV','','EQ010119.CSV','500003','EQ010119.CSV')
2022-07-15 03:59:31.353 IST [22992] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:00:34.032 IST [3316] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:00:43.374 IST [24496] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:04:21.533 IST [11612] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:05:02.138 IST [24536] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:05:21.905 IST [19684] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:07:00.818 IST [14848] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:07:13.407 IST [22652] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:07:19.558 IST [2616] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:08:28.128 IST [8880] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:09:10.108 IST [16560] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:09:33.011 IST [27320] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:09:39.297 IST [2724] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:10:17.007 IST [5560] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:10:36.959 IST [18156] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:11:03.149 IST [23224] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:11:24.970 IST [23308] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:11:36.407 IST [8896] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:12:06.830 IST [10924] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:12:12.398 IST [8800] ERROR:  column "file_name" specified more than once at character 157
2022-07-15 04:12:12.398 IST [8800] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,file_name,TRADE_DATE,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE,file_name) values(252.00,258.00,249.85,255.05,255.45,251.80,729,10250,2606022.00,'AEGIS LOGIS ','A ','Q','',500003,'EQ010121.CSV')
2022-07-15 04:13:13.100 IST [16236] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:13:21.531 IST [616] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 04:13:25.482 IST [14000] ERROR:  ValueError: unconverted data remains: .CSV
2022-07-15 04:13:25.482 IST [14000] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "extract_trade_date", line 4, in <module>
	    dtobj = datetime.strptime(f,'%d%m%y') 
	  PL/Python function "extract_trade_date", line 567, in _strptime_datetime
	  PL/Python function "extract_trade_date", line 351, in _strptime
	PL/Python function "extract_trade_date"
2022-07-15 04:13:25.482 IST [14000] STATEMENT:  insert into myapp_stocks(OPEN,HIGH,LOW,CLOSE,LAST,PREVCLOSE,NO_TRADES,NO_OF_SHRS,NET_TURNOV,SC_NAME,SC_GROUP,SC_TYPE,TDCLOINDI,SC_CODE,file_name) values(252.00,258.00,249.85,255.05,255.45,251.80,729,10250,2606022.00,'AEGIS LOGIS ','A ','Q','',500003,'EQ010121.CSV')
2022-07-15 10:54:52.740 IST [16528] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 10:55:02.261 IST [25956] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 11:01:11.830 IST [17376] ERROR:  relation "myapp_index" does not exist at character 15
2022-07-15 11:01:11.830 IST [17376] STATEMENT:  select * from myapp_index limit 10
2022-07-15 11:01:20.486 IST [16320] ERROR:  syntax error at or near "int" at character 339
2022-07-15 11:01:20.486 IST [16320] STATEMENT:  alter table myapp_index  add if not exists file_name text;alter table myapp_index  add if not exists index text GENERATED ALWAYS AS (EXTRACT_INDEX_NAME(file_name)) stored;alter table myapp_index  add if not exists COMPANY text;alter table myapp_index  add if not exists ISIN No. text;alter table myapp_index  add if not exists Scrip Code int;alter table myapp_index  add if not exists Close Price numeric
2022-07-15 12:36:40.015 IST [6088] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 12:37:39.787 IST [17604] ERROR:  syntax error at or near "numeric" at character 340
2022-07-15 12:37:39.787 IST [17604] STATEMENT:  alter table myapp_index  add if not exists file_name text;alter table myapp_index  add if not exists index text GENERATED ALWAYS AS (EXTRACT_INDEX_NAME(file_name)) stored;alter table myapp_index  add if not exists COMPANY text;alter table myapp_index  add if not exists ISIN No. text;alter table myapp_index  add if not exists Close Price numeric;alter table myapp_index  add if not exists Scrip Code integer
2022-07-15 13:05:38.552 IST [19772] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:05:50.095 IST [18492] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:07:14.938 IST [11032] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:07:24.162 IST [24752] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:08:21.234 IST [10740] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:09:44.508 IST [13860] ERROR:  column x.trade_date does not exist at character 45
2022-07-15 13:09:44.508 IST [13860] STATEMENT:  SELECT x.* FROM public.myapp_stocks x
	WHERE x.trade_date = '2013-01-01 00:00:00'
2022-07-15 13:11:37.051 IST [27048] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:11:54.458 IST [19856] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:14:30.578 IST [2856] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:14:57.559 IST [15848] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:15:18.185 IST [25456] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:16:27.476 IST [25996] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:16:30.538 IST [3868] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:16:35.618 IST [14708] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:17:05.572 IST [3728] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:17:24.151 IST [20612] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:17:57.505 IST [3200] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:18:47.550 IST [9316] ERROR:  canceling statement due to user request
2022-07-15 13:18:47.551 IST [13164] LOG:  received fast shutdown request
2022-07-15 13:18:47.555 IST [13164] LOG:  aborting any active transactions
2022-07-15 13:18:47.555 IST [13860] FATAL:  terminating connection due to administrator command
2022-07-15 13:18:47.578 IST [13164] LOG:  background worker "logical replication launcher" (PID 9316) exited with exit code 1
2022-07-15 13:18:47.609 IST [20812] LOG:  shutting down
2022-07-15 13:18:47.698 IST [13164] LOG:  database system is shut down
2022-07-15 13:18:49.829 IST [25284] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-15 13:18:49.840 IST [25284] LOG:  listening on IPv6 address "::1", port 5432
2022-07-15 13:18:49.846 IST [25284] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-15 13:18:49.904 IST [16020] LOG:  database system was shut down at 2022-07-15 13:18:47 IST
2022-07-15 13:18:49.999 IST [25284] LOG:  database system is ready to accept connections
2022-07-15 13:19:18.449 IST [26080] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:19:56.798 IST [13276] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:19:59.829 IST [21460] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:20:10.343 IST [22980] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:20:39.391 IST [14912] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:29:31.136 IST [26772] ERROR:  column "scrip_code" of relation "myapp_index" does not exist at character 25
2022-07-15 13:29:31.136 IST [26772] STATEMENT:  insert into myapp_index(scrip_code,company,isin_no,close_price,file_name) values('532215','Axis Bank Ltd','INE238A01034','798.05','BSESENSEX.csv')
2022-07-15 13:30:04.142 IST [17944] ERROR:  column "file_name" of relation "myapp_index" does not exist at character 64
2022-07-15 13:30:04.142 IST [17944] STATEMENT:  insert into myapp_index(scrip_code,company,isin_no,close_price,file_name) values('532215','Axis Bank Ltd','INE238A01034','798.05','BSESENSEX.csv')
2022-07-15 13:31:29.576 IST [4520] ERROR:  column "file_name" does not exist
2022-07-15 13:31:29.576 IST [4520] HINT:  Perhaps you meant to reference the column "myapp_index.filename".
2022-07-15 13:31:29.576 IST [4520] STATEMENT:  alter table myapp_index  add if not exists scrip_code text;alter table myapp_index  add if not exists company text;alter table myapp_index  add if not exists isin_no text;alter table myapp_index  add if not exists close_price text;alter table myapp_index  add if not exists filename text;alter table myapp_index  add if not exists indexname text GENERATED ALWAYS AS (extract_index_name(file_name)) stored
2022-07-15 13:33:32.616 IST [7912] ERROR:  column "file_name" does not exist
2022-07-15 13:33:32.616 IST [7912] STATEMENT:  alter table myapp_index  add if not exists scrip_code text;alter table myapp_index  add if not exists company text;alter table myapp_index  add if not exists isin_no text;alter table myapp_index  add if not exists close_price text;alter table myapp_index  add if not exists indexname text GENERATED ALWAYS AS (extract_index_name(file_name)) stored;alter table myapp_index  add if not exists filename text
2022-07-15 13:34:50.467 IST [19908] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:35:00.548 IST [22732] ERROR:  column "file_name" does not exist
2022-07-15 13:35:00.548 IST [22732] STATEMENT:  alter table myapp_index  add if not exists scrip_code text;alter table myapp_index  add if not exists company text;alter table myapp_index  add if not exists isin_no text;alter table myapp_index  add if not exists close_price text;alter table myapp_index  add if not exists indexname text GENERATED ALWAYS AS (extract_index_name(file_name)) stored;alter table myapp_index  add if not exists file_name text
2022-07-15 13:36:44.781 IST [13616] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:36:48.999 IST [11068] ERROR:  invalid input syntax for type timestamp: "BSESENSEX"
2022-07-15 13:36:48.999 IST [11068] CONTEXT:  while creating return value
	PL/Python function "extract_index_name"
2022-07-15 13:36:48.999 IST [11068] STATEMENT:  insert into myapp_index(scrip_code,company,isin_no,close_price,file_name) values('532215','Axis Bank Ltd','INE238A01034','798.05','BSESENSEX.csv')
2022-07-15 13:37:15.778 IST [22420] ERROR:  cannot change return type of existing function
2022-07-15 13:37:15.778 IST [22420] HINT:  Use DROP FUNCTION extract_index_name(text) first.
2022-07-15 13:37:15.778 IST [22420] STATEMENT:  create or replace FUNCTION extract_index_name (file_name text)
	  RETURNS text
	AS $$
	return file_name[:-4]
	$$ LANGUAGE plpython3u immutable
2022-07-15 13:38:05.027 IST [22420] ERROR:  column x.trade_date does not exist at character 45
2022-07-15 13:38:05.027 IST [22420] STATEMENT:  SELECT x.* FROM public.myapp_stocks x
	WHERE x.trade_date = '2013-01-01 00:00:00'
2022-07-15 13:41:42.713 IST [22420] ERROR:  syntax error at or near "sma_cte" at character 53
2022-07-15 13:41:42.713 IST [22420] STATEMENT:  
	with index_cte as (
		select * from myapp_index
	)sma_cte as (
		select * from myapp_stocks where scrip_code = sc_code
	)select * from sma_cte
2022-07-15 13:42:38.231 IST [22420] ERROR:  column "scrip_code" does not exist at character 104
2022-07-15 13:42:38.231 IST [22420] HINT:  Perhaps you meant to reference the column "myapp_stocks.sc_code".
2022-07-15 13:42:38.231 IST [22420] STATEMENT:  
	
	with index_cte as (
		select * from myapp_index
	),sma_cte as (
		select * from myapp_stocks where scrip_code = sc_code
	)select * from sma_cte
	
2022-07-15 13:42:51.436 IST [22420] ERROR:  missing FROM-clause entry for table "myapp_index" at character 102
2022-07-15 13:42:51.436 IST [22420] STATEMENT:  
	with index_cte as (
		select * from myapp_index
	),sma_cte as (
		select * from myapp_stocks where myapp_index.scrip_code = sc_code
	)select * from sma_cte
	
2022-07-15 13:43:11.254 IST [22420] ERROR:  missing FROM-clause entry for table "myapp_index" at character 112
2022-07-15 13:43:11.254 IST [22420] STATEMENT:  
	with index_cte as (
		select * from myapp_index
	),sma_cte as (
		select * from myapp_stocks,index_cte where myapp_index.scrip_code = sc_code
	)select * from sma_cte
2022-07-15 13:43:35.828 IST [22420] ERROR:  missing FROM-clause entry for table "index_cte" at character 102
2022-07-15 13:43:35.828 IST [22420] STATEMENT:  
	with index_cte as (
		select * from myapp_index
	),sma_cte as (
		select * from myapp_stocks where index_cte.scrip_code = sc_code
	)select * from sma_cte
	
2022-07-15 13:43:50.050 IST [22420] ERROR:  operator does not exist: text = integer at character 135
2022-07-15 13:43:50.050 IST [22420] HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2022-07-15 13:43:50.050 IST [22420] STATEMENT:  
	
	with index_cte as (
		select * from myapp_index
	),sma_cte as (
		select * from myapp_stocks,index_cte where index_cte.scrip_code = sc_code
	)select * from sma_cte
	
2022-07-15 13:45:56.532 IST [10016] ERROR:  canceling statement due to user request
2022-07-15 13:45:56.534 IST [25284] LOG:  received fast shutdown request
2022-07-15 13:45:56.539 IST [25284] LOG:  aborting any active transactions
2022-07-15 13:45:56.539 IST [22420] FATAL:  terminating connection due to administrator command
2022-07-15 13:45:56.540 IST [8748] FATAL:  terminating connection due to administrator command
2022-07-15 13:45:56.557 IST [25284] LOG:  background worker "logical replication launcher" (PID 10016) exited with exit code 1
2022-07-15 13:45:56.588 IST [5016] LOG:  shutting down
2022-07-15 13:45:56.669 IST [25284] LOG:  database system is shut down
2022-07-15 13:45:58.841 IST [14492] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-15 13:45:58.852 IST [14492] LOG:  listening on IPv6 address "::1", port 5432
2022-07-15 13:45:58.858 IST [14492] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-15 13:45:58.915 IST [11144] LOG:  database system was shut down at 2022-07-15 13:45:56 IST
2022-07-15 13:45:58.973 IST [14492] LOG:  database system is ready to accept connections
2022-07-15 13:48:12.547 IST [3416] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 13:53:13.768 IST [2716] ERROR:  function high(numeric) does not exist at character 79
2022-07-15 13:53:13.768 IST [2716] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-07-15 13:53:13.768 IST [2716] STATEMENT:  
	with index_cte as (
		select * from myapp_index
	),sma_cte as (
		select 
		high(close)
		from myapp_stocks,index_cte where index_cte.scrip_code = sc_code
	)select * from sma_cte
2022-07-15 14:01:16.900 IST [2716] ERROR:  relation "index_cte" does not exist at character 94
2022-07-15 14:01:16.900 IST [2716] STATEMENT:  
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks,index_cte where index_cte.scrip_code = sc_code
	)select * from sma_cte
2022-07-15 14:01:25.760 IST [2716] ERROR:  relation "index_cte" does not exist at character 94
2022-07-15 14:01:25.760 IST [2716] STATEMENT:  
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks,index_cte
	)select * from sma_cte
2022-07-15 14:02:41.166 IST [2716] ERROR:  syntax error at or near "fom" at character 186
2022-07-15 14:02:41.166 IST [2716] STATEMENT:  
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index where sma_cte.sc_code = scrip_code
	)select * fom index_cte
2022-07-15 14:02:51.228 IST [2716] ERROR:  missing FROM-clause entry for table "sma_cte" at character 144
2022-07-15 14:02:51.228 IST [2716] STATEMENT:  with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index where sma_cte.sc_code = scrip_code
	)select * from index_cte
	
2022-07-15 14:02:58.668 IST [2716] ERROR:  missing FROM-clause entry for table "sma_cte" at character 144
2022-07-15 14:02:58.668 IST [2716] STATEMENT:  with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index where sma_cte.sc_code = scrip_code
	)select * from index_cte
2022-07-15 14:04:07.085 IST [2716] ERROR:  syntax error at or near "distinct" at character 194
2022-07-15 14:04:07.085 IST [2716] STATEMENT:  
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select *,distinct(scrip_code) from index_cte 
	
	
	
2022-07-15 14:04:23.416 IST [2716] ERROR:  syntax error at or near "distinct" at character 194
2022-07-15 14:04:23.416 IST [2716] STATEMENT:  
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select *,distinct(scrip_code) from index_cte 
	
2022-07-15 14:04:29.398 IST [2716] ERROR:  syntax error at or near "distinct" at character 198
2022-07-15 14:04:29.398 IST [2716] STATEMENT:  
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select close,distinct(scrip_code) from index_cte 
	
	
	
2022-07-15 14:22:26.880 IST [2716] ERROR:  syntax error at or near "trade_date" at character 235
2022-07-15 14:22:26.880 IST [2716] STATEMENT:  
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code,* from index_cte order trade_date desc
2022-07-15 14:23:32.020 IST [2716] ERROR:  syntax error at or near "relace" at character 13
2022-07-15 14:23:32.020 IST [2716] STATEMENT:  
	create or relace view test_view as 
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code,* from index_cte order by trade_date desc
	
	
	
2022-07-15 14:23:39.346 IST [2716] ERROR:  column "scrip_code" specified more than once
2022-07-15 14:23:39.346 IST [2716] STATEMENT:  
	create or replace view test_view as 
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code,* from index_cte order by trade_date desc
	
	
	
2022-07-15 14:24:03.308 IST [2716] ERROR:  column "scrip_code" specified more than once
2022-07-15 14:24:03.308 IST [2716] STATEMENT:  
	create or replace view test_view as 
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code,* from index_cte order by trade_date desc
	
	
	
2022-07-15 14:24:42.897 IST [2716] ERROR:  column "file_name" specified more than once
2022-07-15 14:24:42.897 IST [2716] STATEMENT:  
	
	create or replace view test_view as 
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code as d_scrip_code,* from index_cte order by trade_date desc
	
2022-07-15 14:25:01.284 IST [2716] ERROR:  column "scrip_code" specified more than once
2022-07-15 14:25:01.284 IST [2716] STATEMENT:  
	create or replace view test_view as 
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code,index_cte.* from index_cte order by trade_date desc
	
2022-07-15 14:25:15.815 IST [2716] ERROR:  column "file_name" specified more than once
2022-07-15 14:25:15.815 IST [2716] STATEMENT:  
	create or replace view test_view as 
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code as dist,index_cte.* from index_cte order by trade_date desc
	
2022-07-15 14:25:49.424 IST [2716] ERROR:  column "trade_date" does not exist at character 319
2022-07-15 14:25:49.424 IST [2716] STATEMENT:  
	create or replace view test_view as 
	with sma_cte as (
		select 
		myapp_stocks.*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select myapp_index.* from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code as dist,index_cte.* from index_cte order by trade_date desc
	
	
	
2022-07-15 14:26:00.758 IST [2716] ERROR:  column "trade_date" does not exist at character 279
2022-07-15 14:26:00.758 IST [2716] STATEMENT:  with sma_cte as (
		select 
		myapp_stocks.*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select myapp_index.* from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code as dist,index_cte.* from index_cte order by trade_date desc
2022-07-15 14:26:27.276 IST [21236] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 14:30:37.251 IST [2716] ERROR:  column "scrip_code" specified more than once
2022-07-15 14:30:37.251 IST [2716] STATEMENT:  
	
	create or replace view test_view as 
	with sma_cte as (
		select 
		*,avg(close) over (partition by sc_code)
		from myapp_stocks
	),index_cte as (
		select * from myapp_index,sma_cte where sma_cte.sc_code = scrip_code
	)select distinct scrip_code,index_cte.* from index_cte order by trade_date desc
	
	
2022-07-15 21:33:44.066 IST [28208] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-15 22:00:05.127 IST [14492] LOG:  server process (PID 16004) was terminated by exception 0xC000013A
2022-07-15 22:00:05.127 IST [14492] DETAIL:  Failed process was running: SELECT "django_migrations"."id", "django_migrations"."app", "django_migrations"."name", "django_migrations"."applied" FROM "django_migrations"
2022-07-15 22:00:05.127 IST [14492] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-07-15 22:00:05.127 IST [14492] LOG:  terminating any other active server processes
2022-07-15 22:00:05.228 IST [14492] LOG:  received fast shutdown request
^C2022-07-28 14:49:18.051 IST [18080] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-28 14:49:18.063 IST [18080] LOG:  listening on IPv6 address "::1", port 5432
2022-07-28 14:49:18.070 IST [18080] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-28 14:49:18.143 IST [15544] LOG:  database system was interrupted; last known up at 2022-07-15 21:56:39 IST
2022-07-28 14:49:18.682 IST [15544] LOG:  database system was not properly shut down; automatic recovery in progress
2022-07-28 14:49:18.687 IST [15544] LOG:  redo starts at 0/2B4AB228
2022-07-28 14:49:18.687 IST [15544] LOG:  invalid record length at 0/2B4AB310: wanted 24, got 0
2022-07-28 14:49:18.687 IST [15544] LOG:  redo done at 0/2B4AB2D8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-07-28 14:49:18.810 IST [18080] LOG:  database system is ready to accept connections
2022-07-28 14:49:25.215 IST [18080] LOG:  received fast shutdown request
2022-07-28 14:49:25.219 IST [18080] LOG:  aborting any active transactions
2022-07-28 14:49:25.242 IST [18080] LOG:  background worker "logical replication launcher" (PID 11788) exited with exit code 1
2022-07-28 14:49:25.245 IST [492] LOG:  shutting down
2022-07-28 14:49:25.319 IST [18080] LOG:  database system is shut down
2022-07-28 14:49:25.740 IST [14848] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-07-28 14:49:25.751 IST [14848] LOG:  listening on IPv6 address "::1", port 5432
2022-07-28 14:49:25.757 IST [14848] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-07-28 14:49:25.819 IST [15604] LOG:  database system was shut down at 2022-07-28 14:49:25 IST
2022-07-28 14:49:25.897 IST [14848] LOG:  database system is ready to accept connections
2022-07-28 14:50:45.539 IST [7032] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-28 14:52:49.557 IST [17644] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-28 16:22:46.092 IST [18192] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-28 16:23:19.649 IST [19236] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-28 16:24:03.479 IST [9944] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-28 16:24:06.779 IST [7036] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-28 16:24:33.755 IST [488] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-28 16:25:17.576 IST [8328] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-07-28 16:25:30.114 IST [16696] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-08-04 10:33:25.566 IST [21652] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-08-04 10:33:25.593 IST [21652] LOG:  listening on IPv6 address "::1", port 5432
2022-08-04 10:33:25.627 IST [21652] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-08-04 10:33:25.785 IST [28080] LOG:  database system was interrupted; last known up at 2022-07-28 14:59:31 IST
2022-08-04 10:33:26.918 IST [28080] LOG:  database system was not properly shut down; automatic recovery in progress
2022-08-04 10:33:26.924 IST [28080] LOG:  redo starts at 0/2B4F9EC8
2022-08-04 10:33:26.924 IST [28080] LOG:  invalid record length at 0/2B4F9FB0: wanted 24, got 0
2022-08-04 10:33:26.924 IST [28080] LOG:  redo done at 0/2B4F9F78 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-08-04 10:33:27.061 IST [21652] LOG:  database system is ready to accept connections
2022-08-04 10:35:39.543 IST [11252] ERROR:  syntax error at or near "as" at character 43
2022-08-04 10:35:39.543 IST [11252] STATEMENT:  alter TABLE myapp_stocks add column sma20 as numeric GENERATED ALWAYS AS (10 / 2.54) STORED
2022-08-04 10:41:45.520 IST [11252] ERROR:  syntax error at or near "select" at character 94
2022-08-04 10:41:45.520 IST [11252] STATEMENT:  
	CREATE FUNCTION sma20(tbl text,col text,dt timestamp) RETURNS real AS $$
	BEGIN
	   RETURN select AVG(close) OVER(ORDER BY trade_date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS sma20    from tbl    order by dt desc   limit 1
	END;
	$$ LANGUAGE plpgsql immutable
2022-08-04 10:42:11.171 IST [26360] ERROR:  canceling statement due to user request
2022-08-04 10:42:11.173 IST [21652] LOG:  received fast shutdown request
2022-08-04 10:42:11.185 IST [21652] LOG:  aborting any active transactions
2022-08-04 10:42:11.186 IST [9056] FATAL:  terminating connection due to administrator command
2022-08-04 10:42:11.206 IST [21652] LOG:  background worker "logical replication launcher" (PID 26360) exited with exit code 1
2022-08-04 10:42:11.238 IST [19880] LOG:  shutting down
2022-08-04 10:42:11.347 IST [21652] LOG:  database system is shut down
2022-08-18 00:58:01.167 IST [15072] LOG:  starting PostgreSQL 14.2, compiled by Visual C++ build 1914, 64-bit
2022-08-18 00:58:01.179 IST [15072] LOG:  listening on IPv6 address "::1", port 5432
2022-08-18 00:58:01.185 IST [15072] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-08-18 00:58:01.254 IST [10948] LOG:  database system was shut down at 2022-08-04 10:42:11 IST
2022-08-18 00:58:01.343 IST [15072] LOG:  database system is ready to accept connections
2022-08-18 01:12:17.299 IST [15072] LOG:  server process (PID 23756) was terminated by exception 0xC000013A
2022-08-18 01:12:17.299 IST [15072] DETAIL:  Failed process was running: SELECT "django_migrations"."id", "django_migrations"."app", "django_migrations"."name", "django_migrations"."applied" FROM "django_migrations"
2022-08-18 01:12:17.299 IST [15072] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-08-18 01:12:17.301 IST [15072] LOG:  terminating any other active server processes
2022-08-18 01:12:17.375 IST [15072] LOG:  all server processes terminated; reinitializing
2022-08-18 01:12:17.418 IST [15072] LOG:  startup process (PID 556) was terminated by exception 0xC0000142
2022-08-18 01:12:17.418 IST [15072] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-08-18 01:12:17.418 IST [15072] LOG:  aborting startup due to startup process failure
2022-08-18 01:12:17.421 IST [15072] LOG:  database system is shut down
2022-11-05 00:07:47.554 IST [10860] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-05 00:07:47.565 IST [10860] LOG:  listening on IPv6 address "::1", port 5432
2022-11-05 00:07:47.571 IST [10860] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-05 00:07:47.665 IST [22088] LOG:  database system was shut down at 2022-11-05 00:07:34 IST
2022-11-05 00:07:47.737 IST [10860] LOG:  database system is ready to accept connections
2022-11-05 00:08:26.111 IST [10860] LOG:  received fast shutdown request
2022-11-05 00:08:26.114 IST [10860] LOG:  aborting any active transactions
2022-11-05 00:08:26.136 IST [10860] LOG:  background worker "logical replication launcher" (PID 19076) exited with exit code 1
2022-11-05 00:08:26.137 IST [18144] LOG:  shutting down
2022-11-05 00:08:26.139 IST [18144] LOG:  checkpoint starting: shutdown immediate
2022-11-05 00:08:26.156 IST [18144] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.004 s, sync=0.004 s, total=0.020 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-05 00:08:26.189 IST [10860] LOG:  database system is shut down
2022-11-05 00:08:26.735 IST [21964] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-05 00:08:26.746 IST [21964] LOG:  listening on IPv6 address "::1", port 5432
2022-11-05 00:08:26.752 IST [21964] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-05 00:08:26.837 IST [12428] LOG:  database system was shut down at 2022-11-05 00:08:26 IST
2022-11-05 00:08:26.901 IST [21964] LOG:  database system is ready to accept connections
2022-11-05 00:08:37.169 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.169 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app"
2022-11-05 00:08:37.332 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.332 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.332 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.332 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.333 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.333 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.333 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.333 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.333 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.333 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.334 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.334 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.334 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.334 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.335 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.335 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.335 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.335 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.335 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.335 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.336 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.336 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.336 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.336 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.337 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.337 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.337 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.337 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.337 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.337 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.338 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.338 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.338 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.338 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.339 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.339 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.339 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.339 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.340 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.340 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.340 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.340 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.341 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.341 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.341 IST [8736] ERROR:  relation "octopgpyapp_app" does not exist at character 62
2022-11-05 00:08:37.341 IST [8736] STATEMENT:  SELECT "octopgpyapp_app"."id", "octopgpyapp_app"."name" FROM "octopgpyapp_app" LIMIT 21
2022-11-05 00:08:37.343 IST [8736] ERROR:  relation "django_session" does not exist at character 109
2022-11-05 00:08:37.343 IST [8736] STATEMENT:  SELECT "django_session"."session_key", "django_session"."session_data", "django_session"."expire_date" FROM "django_session" WHERE ("django_session"."expire_date" > '2022-11-04T18:38:37.341796+00:00'::timestamptz AND "django_session"."session_key" = 'GJuz9ACflu1pW3CLzMH7tV1iVIqm') LIMIT 21
2022-11-05 00:11:33.272 IST [13752] ERROR:  could not compile PL/Python function "pima"
2022-11-05 00:11:33.272 IST [13752] DETAIL:  SyntaxError: invalid syntax (<string>, line 3)
2022-11-05 00:11:33.272 IST [13752] STATEMENT:  
	CREATE FUNCTION pima(a INTEGER, b INTEGER)
	RETURNS INTEGER AS
	$$
	IF a > b:
	  RETURN a
	RETURN b
	$$ LANGUAGE plpython3u
2022-11-05 00:11:43.216 IST [13752] ERROR:  could not compile PL/Python function "pima"
2022-11-05 00:11:43.216 IST [13752] DETAIL:  SyntaxError: invalid syntax (<string>, line 3)
2022-11-05 00:11:43.216 IST [13752] STATEMENT:  CREATE FUNCTION pima(a INTEGER, b INTEGER)
	RETURNS INTEGER AS
	$$
	IF a > b:
	  RETURN a
	RETURN b
	$$ LANGUAGE plpython3u
2022-11-05 00:13:26.907 IST [16368] LOG:  checkpoint starting: time
2022-11-05 00:13:52.143 IST [13752] ERROR:  syntax error at or near "CREATE" at character 41
2022-11-05 00:13:52.143 IST [13752] STATEMENT:  
	drop function pymax(integer,integer)
	CREATE FUNCTION pymax (a integer, b integer)
	  RETURNS integer
	AS $$
	  if a > b:
	    return a
	  return b
	$$ LANGUAGE plpython3u
	
	
	
2022-11-05 00:13:52.949 IST [16368] LOG:  checkpoint complete: wrote 238 buffers (1.5%); 0 WAL file(s) added, 0 removed, 0 recycled; write=25.825 s, sync=0.178 s, total=26.043 s; sync files=105, longest=0.005 s, average=0.002 s; distance=1215 kB, estimate=1215 kB
2022-11-05 00:16:02.037 IST [13752] ERROR:  ModuleNotFoundError: No module named 'flask'
2022-11-05 00:16:02.037 IST [13752] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 5, in <module>
	    from flask import Flask
	PL/Python function "pymax"
2022-11-05 00:16:02.037 IST [13752] STATEMENT:  select pymax(1,3)
2022-11-05 00:16:16.040 IST [13752] ERROR:  ModuleNotFoundError: No module named 'matplotlib'
2022-11-05 00:16:16.040 IST [13752] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 4, in <module>
	    from matplotlib.figure import Figure
	PL/Python function "pymax"
2022-11-05 00:16:16.040 IST [13752] STATEMENT:  
	
	select pymax(1,3)
	
2022-11-05 00:16:59.095 IST [13752] ERROR:  ModuleNotFoundError: No module named 'flask'
2022-11-05 00:16:59.095 IST [13752] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 5, in <module>
	    from flask import Flask
	PL/Python function "pymax"
2022-11-05 00:16:59.095 IST [13752] STATEMENT:  
	select pymax(1,3)
	
2022-11-05 00:17:03.038 IST [13752] ERROR:  ModuleNotFoundError: No module named 'matplotlib'
2022-11-05 00:17:03.038 IST [13752] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 4, in <module>
	    from matplotlib.figure import Figure
	PL/Python function "pymax"
2022-11-05 00:17:03.038 IST [13752] STATEMENT:  
	
	select pymax(1,3)
	
	
2022-11-05 00:17:46.654 IST [19216] ERROR:  ModuleNotFoundError: No module named 'matplotlib'
2022-11-05 00:17:46.654 IST [19216] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 4, in <module>
	    from matplotlib.figure import Figure
	PL/Python function "pymax"
2022-11-05 00:17:46.654 IST [19216] STATEMENT:  
	select pymax(1,3)
	
	
2022-11-05 00:17:57.014 IST [2588] ERROR:  canceling statement due to user request
2022-11-05 00:17:57.015 IST [21964] LOG:  received fast shutdown request
2022-11-05 00:17:57.026 IST [21964] LOG:  aborting any active transactions
2022-11-05 00:17:57.027 IST [19216] FATAL:  terminating connection due to administrator command
2022-11-05 00:17:57.028 IST [14904] FATAL:  terminating connection due to administrator command
2022-11-05 00:17:57.045 IST [21964] LOG:  background worker "logical replication launcher" (PID 2588) exited with exit code 1
2022-11-05 00:17:57.063 IST [16368] LOG:  shutting down
2022-11-05 00:17:57.066 IST [16368] LOG:  checkpoint starting: shutdown immediate
2022-11-05 00:17:57.098 IST [16368] LOG:  checkpoint complete: wrote 11 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.004 s, sync=0.014 s, total=0.035 s; sync files=9, longest=0.003 s, average=0.002 s; distance=50 kB, estimate=1098 kB
2022-11-05 00:17:57.129 IST [21964] LOG:  database system is shut down
2022-11-05 00:17:59.704 IST [14380] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-05 00:17:59.715 IST [14380] LOG:  listening on IPv6 address "::1", port 5432
2022-11-05 00:17:59.721 IST [14380] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-05 00:17:59.813 IST [7528] LOG:  database system was shut down at 2022-11-05 00:17:57 IST
2022-11-05 00:17:59.870 IST [14380] LOG:  database system is ready to accept connections
2022-11-05 00:18:04.904 IST [23668] ERROR:  ModuleNotFoundError: No module named 'matplotlib'
2022-11-05 00:18:04.904 IST [23668] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 4, in <module>
	    from matplotlib.figure import Figure
	PL/Python function "pymax"
2022-11-05 00:18:04.904 IST [23668] STATEMENT:  
	
	select pymax(1,3)
	
2022-11-05 00:19:13.350 IST [23668] ERROR:  ModuleNotFoundError: No module named 'matplotlib'
2022-11-05 00:19:13.350 IST [23668] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 4, in <module>
	    from matplotlib.figure import Figure
	PL/Python function "pymax"
2022-11-05 00:19:13.350 IST [23668] STATEMENT:  
	select pymax(1,3)
	
2022-11-05 00:20:21.545 IST [23668] ERROR:  language "plpythonu" does not exist
2022-11-05 00:20:21.545 IST [23668] STATEMENT:  CREATE OR REPLACE FUNCTION blah(varchar) RETURNS integer AS $$
	    import sys
	    plpy.notice("python exec = '%s'" % sys.executable)
	    plpy.notice("python version = '%s'" % sys.version)
	    plpy.notice("python path = '%s'" % sys.path)
	    return 1
	$$ LANGUAGE plpythonu
2022-11-05 00:20:39.158 IST [23668] ERROR:  column "ha" does not exist at character 13
2022-11-05 00:20:39.158 IST [23668] STATEMENT:  select blah("ha")
2022-11-05 00:20:48.632 IST [23668] ERROR:  function blah() does not exist at character 8
2022-11-05 00:20:48.632 IST [23668] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-11-05 00:20:48.632 IST [23668] STATEMENT:  select blah()
2022-11-05 00:21:38.573 IST [23668] ERROR:  cannot change return type of existing function
2022-11-05 00:21:38.573 IST [23668] HINT:  Use DROP FUNCTION blah(character varying) first.
2022-11-05 00:21:38.573 IST [23668] STATEMENT:  
	CREATE OR REPLACE FUNCTION blah(varchar) RETURNS text AS $$
	    import sys
	    
	    plpy.notice("python exec = '%s'" % sys.executable)
	    plpy.notice("python version = '%s'" % sys.version)
	    plpy.notice("python path = '%s'" % sys.path)
	    return sys.path
	$$ LANGUAGE plpython3u
2022-11-05 00:21:56.133 IST [23668] ERROR:  function blah(character varying) does not exist
2022-11-05 00:21:56.133 IST [23668] STATEMENT:  drop function blah(varchar)
2022-11-05 00:22:59.886 IST [13216] LOG:  checkpoint starting: time
2022-11-05 00:23:01.264 IST [13216] LOG:  checkpoint complete: wrote 15 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.318 s, sync=0.020 s, total=1.380 s; sync files=10, longest=0.007 s, average=0.002 s; distance=72 kB, estimate=72 kB
2022-11-05 00:25:25.583 IST [23668] ERROR:  ModuleNotFoundError: No module named 'matplotlib'
2022-11-05 00:25:25.583 IST [23668] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 4, in <module>
	    from matplotlib.figure import Figure
	PL/Python function "pymax"
2022-11-05 00:25:25.583 IST [23668] STATEMENT:  select pymax(1,3)
2022-11-05 00:25:58.850 IST [23668] ERROR:  could not create bytes representation of Python object
2022-11-05 00:25:58.850 IST [23668] DETAIL:  TypeError: cannot convert 'str' object to bytes
2022-11-05 00:25:58.850 IST [23668] CONTEXT:  while creating return value
	PL/Python function "pymax"
2022-11-05 00:25:58.850 IST [23668] STATEMENT:  
	
	select pymax(1,3)
2022-11-05 00:27:59.281 IST [13216] LOG:  checkpoint starting: time
2022-11-05 00:28:00.516 IST [13216] LOG:  checkpoint complete: wrote 12 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.202 s, sync=0.013 s, total=1.236 s; sync files=9, longest=0.003 s, average=0.002 s; distance=63 kB, estimate=71 kB
2022-11-05 00:29:30.860 IST [23668] ERROR:  NameError: name 'buf' is not defined
2022-11-05 00:29:30.860 IST [23668] CONTEXT:  Traceback (most recent call last):
	  PL/Python function "pymax", line 25, in <module>
	    fig.savefig(buf, format="png")
	PL/Python function "pymax"
2022-11-05 00:29:30.860 IST [23668] STATEMENT:  
	
	select pymax(1,3)
2022-11-05 00:32:59.520 IST [13216] LOG:  checkpoint starting: time
2022-11-05 00:33:00.686 IST [13216] LOG:  checkpoint complete: wrote 11 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.117 s, sync=0.021 s, total=1.166 s; sync files=9, longest=0.010 s, average=0.003 s; distance=53 kB, estimate=70 kB
2022-11-05 00:39:57.131 IST [21672] ERROR:  function test(text) does not exist
2022-11-05 00:39:57.131 IST [21672] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2022-11-05 00:39:57.131 IST [21672] STATEMENT:  alter table StockUP_BSE  add if not exists test text GENERATED ALWAYS AS (test(test)) stored
2022-11-05 00:42:59.707 IST [13216] LOG:  checkpoint starting: time
2022-11-05 00:43:04.228 IST [13216] LOG:  checkpoint complete: wrote 42 buffers (0.3%); 0 WAL file(s) added, 0 removed, 0 recycled; write=4.478 s, sync=0.033 s, total=4.521 s; sync files=31, longest=0.002 s, average=0.002 s; distance=96 kB, estimate=96 kB
2022-11-05 00:52:59.262 IST [13216] LOG:  checkpoint starting: time
2022-11-05 00:52:59.592 IST [13216] LOG:  checkpoint complete: wrote 4 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.315 s, sync=0.006 s, total=0.330 s; sync files=4, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=86 kB
2022-11-05 01:33:27.713 IST [23668] FATAL:  terminating connection due to unexpected postmaster exit
2022-11-05 15:44:09.577 IST [13992] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-05 15:44:09.588 IST [13992] LOG:  listening on IPv6 address "::1", port 5432
2022-11-05 15:44:09.594 IST [13992] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-05 15:44:09.699 IST [12268] LOG:  database system was interrupted; last known up at 2022-11-05 00:52:59 IST
2022-11-05 15:44:10.208 IST [12268] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-05 15:44:10.216 IST [12268] LOG:  redo starts at 0/1681318
2022-11-05 15:44:10.216 IST [12268] LOG:  invalid record length at 0/1681400: wanted 24, got 0
2022-11-05 15:44:10.216 IST [12268] LOG:  redo done at 0/16813C8 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-05 15:44:10.222 IST [2436] LOG:  checkpoint starting: end-of-recovery immediate wait
2022-11-05 15:44:10.239 IST [2436] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.004 s, total=0.020 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-05 15:44:10.299 IST [13992] LOG:  database system is ready to accept connections
2022-11-05 15:45:13.814 IST [16564] FATAL:  role "pranjan24" does not exist
2022-11-05 15:46:36.354 IST [15252] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-05 15:46:49.127 IST [17104] FATAL:  database "data" does not exist
2022-11-05 15:47:02.883 IST [3840] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-05 15:48:07.106 IST [21996] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-05 15:48:29.880 IST [18128] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-05 15:49:10.238 IST [2436] LOG:  checkpoint starting: time
2022-11-05 15:49:12.605 IST [2436] LOG:  checkpoint complete: wrote 21 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.326 s, sync=0.025 s, total=2.368 s; sync files=15, longest=0.004 s, average=0.002 s; distance=17 kB, estimate=17 kB
2022-11-05 15:49:24.774 IST [23068] FATAL:  role "pranjan24" does not exist
2022-11-05 15:53:51.029 IST [13992] LOG:  server process (PID 9308) was terminated by exception 0xC000013A
2022-11-05 15:53:51.029 IST [13992] DETAIL:  Failed process was running: SELECT c.oid,c.*,d.description,pg_catalog.pg_get_expr(c.relpartbound, c.oid) as partition_expr,  pg_catalog.pg_get_partkeydef(c.oid) as partition_key 
	FROM pg_catalog.pg_class c
	LEFT OUTER JOIN pg_catalog.pg_description d ON d.objoid=c.oid AND d.objsubid=0 AND d.classoid='pg_class'::regclass
	WHERE c.relnamespace=$1 AND c.relkind not in ('i','c')
2022-11-05 15:53:51.029 IST [13992] HINT:  See C include file "ntstatus.h" for a description of the hexadecimal value.
2022-11-05 15:53:51.030 IST [13992] LOG:  terminating any other active server processes
2022-11-05 15:53:51.073 IST [13992] LOG:  all server processes terminated; reinitializing
^C2022-11-05 15:55:20.022 IST [12488] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-05 15:55:20.034 IST [12488] LOG:  listening on IPv6 address "::1", port 5432
2022-11-05 15:55:20.040 IST [12488] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-05 15:55:20.150 IST [21796] LOG:  database system was interrupted; last known up at 2022-11-05 15:49:12 IST
2022-11-05 15:55:20.570 IST [21796] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-05 15:55:20.576 IST [21796] LOG:  redo starts at 0/1685BB8
2022-11-05 15:55:20.576 IST [21796] LOG:  invalid record length at 0/1685CA0: wanted 24, got 0
2022-11-05 15:55:20.576 IST [21796] LOG:  redo done at 0/1685C68 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-05 15:55:20.581 IST [21968] LOG:  checkpoint starting: end-of-recovery immediate wait
2022-11-05 15:55:20.598 IST [21968] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.004 s, total=0.019 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-05 15:55:20.667 IST [12488] LOG:  database system is ready to accept connections
2022-11-05 15:55:26.067 IST [12488] LOG:  received fast shutdown request
2022-11-05 15:55:26.072 IST [12488] LOG:  aborting any active transactions
2022-11-05 15:55:26.097 IST [12488] LOG:  background worker "logical replication launcher" (PID 17052) exited with exit code 1
2022-11-05 15:55:26.098 IST [21968] LOG:  shutting down
2022-11-05 15:55:26.101 IST [21968] LOG:  checkpoint starting: shutdown immediate
2022-11-05 15:55:26.117 IST [21968] LOG:  checkpoint complete: wrote 0 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.020 s; sync files=0, longest=0.000 s, average=0.000 s; distance=0 kB, estimate=0 kB
2022-11-05 15:55:26.146 IST [12488] LOG:  database system is shut down
2022-11-05 15:55:26.665 IST [23056] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-05 15:55:26.676 IST [23056] LOG:  listening on IPv6 address "::1", port 5432
2022-11-05 15:55:26.682 IST [23056] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-05 15:55:26.774 IST [14768] LOG:  database system was shut down at 2022-11-05 15:55:26 IST
2022-11-05 15:55:26.836 IST [23056] LOG:  database system is ready to accept connections
2022-11-05 16:00:26.775 IST [20612] LOG:  checkpoint starting: time
2022-11-05 16:00:26.807 IST [20612] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.004 s, total=0.032 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-10 11:57:30.124 IST [9636] LOG:  starting PostgreSQL 15.0, compiled by Visual C++ build 1914, 64-bit
2022-11-10 11:57:30.135 IST [9636] LOG:  listening on IPv6 address "::1", port 5432
2022-11-10 11:57:30.141 IST [9636] LOG:  listening on IPv4 address "127.0.0.1", port 5432
2022-11-10 11:57:30.246 IST [20688] LOG:  database system was interrupted; last known up at 2022-11-05 16:00:26 IST
2022-11-10 11:57:30.797 IST [20688] LOG:  database system was not properly shut down; automatic recovery in progress
2022-11-10 11:57:30.804 IST [20688] LOG:  redo starts at 0/1685DC8
2022-11-10 11:57:30.804 IST [20688] LOG:  invalid record length at 0/1685EB0: wanted 24, got 0
2022-11-10 11:57:30.804 IST [20688] LOG:  redo done at 0/1685E78 system usage: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s
2022-11-10 11:57:30.810 IST [24560] LOG:  checkpoint starting: end-of-recovery immediate wait
2022-11-10 11:57:30.829 IST [24560] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.003 s, sync=0.004 s, total=0.021 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
2022-11-10 11:57:30.899 IST [9636] LOG:  database system is ready to accept connections
2022-11-10 11:57:34.176 IST [18924] LOG:  could not receive data from client: An existing connection was forcibly closed by the remote host.
	
2022-11-10 12:01:09.118 IST [12320] ERROR:  canceling statement due to user request
2022-11-10 12:01:09.118 IST [24676] ERROR:  canceling statement due to user request
2022-11-10 12:01:09.120 IST [9636] LOG:  received fast shutdown request
2022-11-10 12:01:09.134 IST [9636] LOG:  aborting any active transactions
2022-11-10 12:01:09.146 IST [9636] LOG:  background worker "logical replication launcher" (PID 12320) exited with exit code 1
2022-11-10 12:01:09.174 IST [24560] LOG:  shutting down
2022-11-10 12:01:09.177 IST [24560] LOG:  checkpoint starting: shutdown immediate
2022-11-10 12:01:09.189 IST [24560] LOG:  checkpoint complete: wrote 0 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.015 s; sync files=0, longest=0.000 s, average=0.000 s; distance=0 kB, estimate=0 kB
2022-11-10 12:01:09.223 IST [9636] LOG:  database system is shut down
